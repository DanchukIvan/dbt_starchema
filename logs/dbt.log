

============================== 2022-06-09 11:24:10.144236 | c4789002-8f47-49e8-a2f6-4f3e2f7a33fe ==============================
11:24:10.144251 [info ] [MainThread]: Running with dbt=1.1.0
11:24:10.144630 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
11:24:10.144767 [debug] [MainThread]: Tracking: tracking
11:24:10.153852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769aa4790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769aa4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769aa43a0>]}
11:24:10.154280 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/ivan-ds/.dbt
11:24:10.154600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769aa4370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769aa43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6769aa4310>]}


============================== 2022-06-09 11:27:07.099552 | fcb4e7b6-56b3-4d9e-a250-e93f46727b4d ==============================
11:27:07.099570 [info ] [MainThread]: Running with dbt=1.1.0
11:27:07.099974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
11:27:07.100088 [debug] [MainThread]: Tracking: tracking
11:27:07.109572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190082b4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190082b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190082b340>]}
11:27:07.110061 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/ivan-ds/.dbt
11:27:07.110391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190082b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190082b340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f190082b2b0>]}


============================== 2022-06-09 11:28:18.174065 | a5d50985-127f-44e1-9bfb-48f4373d400d ==============================
11:28:18.174082 [info ] [MainThread]: Running with dbt=1.1.0
11:28:18.174529 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
11:28:18.174657 [debug] [MainThread]: Tracking: tracking
11:28:18.184006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70906b0490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70906b0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70906b0430>]}
11:28:18.184415 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/ivan-ds/.dbt
11:28:18.184719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70906b0400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70906b0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f70906b0250>]}


============================== 2022-06-09 11:29:37.561938 | be5b7843-9af9-4cc0-8374-a49e4019d1c1 ==============================
11:29:37.561957 [info ] [MainThread]: Running with dbt=1.1.0
11:29:37.562402 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
11:29:37.562541 [debug] [MainThread]: Tracking: tracking
11:29:37.571951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d518460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5183d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d518400>]}
11:29:37.572432 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/ivan-ds/.dbt
11:29:37.572748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d5183d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d518400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f429d518220>]}


============================== 2022-06-09 11:49:28.562172 | 394c286e-1061-40ab-9b90-d3b60c7fb851 ==============================
11:49:28.562187 [info ] [MainThread]: Running with dbt=1.1.0
11:49:28.562663 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
11:49:28.562795 [debug] [MainThread]: Tracking: tracking
11:49:28.571757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9e18e7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9e18e7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9e18e7340>]}
11:49:28.593887 [debug] [MainThread]: Executing "git --help"
11:49:28.598328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9e1927e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9e18e71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9e18dcb20>]}


============================== 2022-06-09 11:50:24.284280 | 150af4e1-8a98-4171-9394-e8e4bb6d4f82 ==============================
11:50:24.284298 [info ] [MainThread]: Running with dbt=1.1.0
11:50:24.284710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
11:50:24.284848 [debug] [MainThread]: Tracking: tracking
11:50:24.293869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f7309eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f7309df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f7309e20>]}
11:50:24.294330 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2
11:50:24.294657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f7309df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f7309e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8f7309d90>]}


============================== 2022-06-09 11:50:34.590989 | dac0b29e-8898-48a8-8b0c-e0cf66b8b503 ==============================
11:50:34.591005 [info ] [MainThread]: Running with dbt=1.1.0
11:50:34.591382 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
11:50:34.591509 [debug] [MainThread]: Tracking: tracking
11:50:34.600558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cf7c7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cf7c7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cf7c7eb0>]}
11:50:34.661956 [debug] [MainThread]: Executing "git --help"
11:50:34.669485 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
11:50:34.669957 [debug] [MainThread]: Opening a new connection, currently in state init
11:50:37.714250 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
11:50:37.714681 [debug] [MainThread]: On debug: No close available on handle
11:50:37.715780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cf7c7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cf7c7af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14cf6e3ca0>]}
11:50:38.197509 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 12:02:39.111607 | 43cc4ee3-cb4d-429b-bd27-584449d651f3 ==============================
12:02:39.111623 [info ] [MainThread]: Running with dbt=1.1.0
12:02:39.112047 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
12:02:39.112184 [debug] [MainThread]: Tracking: tracking
12:02:39.121960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe08e174f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe08e174e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe08e174eb0>]}
12:02:39.183606 [debug] [MainThread]: Executing "git --help"
12:02:39.188925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe08e0f14f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe08e097a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe08e097610>]}


============================== 2022-06-09 12:05:05.832829 | 857b1dae-4e07-4b26-98cf-5d78fadd9c11 ==============================
12:05:05.832845 [info ] [MainThread]: Running with dbt=1.1.0
12:05:05.833280 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
12:05:05.833417 [debug] [MainThread]: Tracking: tracking
12:05:05.842708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d0ae9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d0ae9ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d0ae9dc0>]}
12:05:05.907254 [debug] [MainThread]: Executing "git --help"
12:05:05.914905 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
12:05:05.915451 [debug] [MainThread]: Opening a new connection, currently in state init
12:05:08.969116 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
12:05:08.969625 [debug] [MainThread]: On debug: No close available on handle
12:05:08.970765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d0ae9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d0ae9c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f09d0a03d30>]}
12:05:09.468076 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 12:07:10.159433 | d93c8875-0a4c-4059-aeae-f0a17c2c975e ==============================
12:07:10.159460 [info ] [MainThread]: Running with dbt=1.1.0
12:07:10.160033 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
12:07:10.160204 [debug] [MainThread]: Tracking: tracking
12:07:10.170065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00fd77d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00fd77d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00fd77d760>]}
12:07:10.170668 [info ] [MainThread]: Start parsing.
12:07:10.171473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00fd77d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00fd77d790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00fd77d850>]}


============================== 2022-06-09 12:07:26.801245 | 11816e36-5c76-4ce7-b761-86e3f87cbf94 ==============================
12:07:26.801265 [info ] [MainThread]: Running with dbt=1.1.0
12:07:26.801711 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
12:07:26.801866 [debug] [MainThread]: Tracking: tracking
12:07:26.811570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4baccca490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4baccca5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4baccca670>]}
12:07:26.812564 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w_ao8uo1'
12:07:26.812973 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
12:07:26.993775 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
12:07:26.994529 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
12:07:27.098839 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
12:07:27.102498 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
12:07:27.212576 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
12:07:27.277102 [info ] [MainThread]: Installing dbt-labs/codegen
12:07:27.512236 [info ] [MainThread]:   Installed from version 0.6.0
12:07:27.512615 [info ] [MainThread]:   Up to date!
12:07:27.512912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '11816e36-5c76-4ce7-b761-86e3f87cbf94', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bacc9cd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bacc68f70>]}
12:07:27.513269 [info ] [MainThread]: Installing dbt-labs/dbt_utils
12:07:27.906211 [info ] [MainThread]:   Installed from version 0.8.5
12:07:27.906631 [info ] [MainThread]:   Up to date!
12:07:27.906980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '11816e36-5c76-4ce7-b761-86e3f87cbf94', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bacc6b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bacc6b340>]}
12:07:27.907711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4baccd41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bacc9c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4bacc68d30>]}


============================== 2022-06-09 12:07:33.765292 | e6b8f4fb-126b-4b11-8d05-369a1b4a104d ==============================
12:07:33.765318 [info ] [MainThread]: Running with dbt=1.1.0
12:07:33.765927 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
12:07:33.766098 [debug] [MainThread]: Tracking: tracking
12:07:33.775957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f631735b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f631735b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f631735b730>]}
12:07:33.776588 [info ] [MainThread]: Start parsing.
12:07:33.805639 [info ] [MainThread]: Dependencies loaded
12:07:33.807105 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:07:33.807477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e6b8f4fb-126b-4b11-8d05-369a1b4a104d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f631730de50>]}
12:07:33.807789 [info ] [MainThread]: ManifestLoader created
12:07:33.826712 [debug] [MainThread]: Parsing macros/init_s3_source.sql
12:07:33.829466 [debug] [MainThread]: Parsing macros/catalog.sql
12:07:33.831355 [debug] [MainThread]: Parsing macros/adapters.sql
12:07:33.867178 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
12:07:33.868307 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:07:33.894258 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:07:33.898289 [debug] [MainThread]: Parsing macros/materializations/test.sql
12:07:33.899636 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:07:33.927015 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:07:33.929764 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:07:33.931385 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:07:33.933020 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:07:33.934428 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:07:33.935145 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:07:33.935965 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:07:33.936800 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:07:33.945203 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:07:33.949733 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:07:33.954159 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:07:33.957182 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:07:33.964479 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:07:33.967274 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:07:33.976907 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:07:33.986625 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:07:33.989084 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:07:33.993400 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:07:33.995975 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:07:34.013072 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:07:34.019490 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:07:34.021075 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:07:34.028288 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:07:34.031219 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:07:34.033648 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:07:34.036545 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:07:34.044173 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:07:34.045842 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:07:34.056027 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:07:34.072560 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:07:34.088058 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:07:34.092729 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:07:34.105150 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:07:34.115787 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:07:34.117593 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:07:34.133634 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:07:34.135568 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:07:34.140037 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:07:34.141955 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:07:34.144907 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
12:07:34.148192 [debug] [MainThread]: Parsing macros/generate_source.sql
12:07:34.155111 [debug] [MainThread]: Parsing macros/generate_base_model.sql
12:07:34.158145 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:07:34.159559 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:07:34.160990 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:07:34.166720 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:07:34.170074 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:07:34.179794 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:07:34.184890 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:07:34.186225 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:07:34.187877 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:07:34.189287 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:07:34.190329 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:07:34.191796 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:07:34.193648 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:07:34.195658 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:07:34.197178 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:07:34.198117 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:07:34.199210 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:07:34.200256 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:07:34.203672 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:07:34.205228 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:07:34.208027 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:07:34.209051 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:07:34.211268 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:07:34.217114 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:07:34.218529 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:07:34.227362 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:07:34.229293 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:07:34.230592 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:07:34.231984 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:07:34.233249 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:07:34.236069 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:07:34.238240 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:07:34.240631 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:07:34.244680 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:07:34.246741 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:07:34.248424 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:07:34.250596 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:07:34.252302 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:07:34.261172 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:07:34.263534 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:07:34.265077 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:07:34.267996 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:07:34.269829 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:07:34.271664 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:07:34.273019 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:07:34.274226 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:07:34.275407 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:07:34.276613 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:07:34.278942 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:07:34.280541 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:07:34.288643 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:07:34.294435 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:07:34.301634 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:07:34.303490 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:07:34.307067 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:07:34.308779 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:07:34.313190 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:07:34.319175 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:07:34.320676 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:07:34.327023 [debug] [MainThread]: Parsing macros/sql/star.sql
12:07:34.330448 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:07:34.333929 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:07:34.336793 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:07:34.341305 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:07:34.343027 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:07:34.347201 [debug] [MainThread]: Parsing macros/sql/union.sql
12:07:34.358187 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:07:34.361900 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:07:34.363748 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:07:34.388193 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:07:34.390506 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:07:34.392209 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:07:34.771855 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:07:34.818779 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:07:34.938389 [info ] [MainThread]: Manifest loaded
12:07:34.938987 [info ] [MainThread]: Manifest checked
12:07:34.939502 [info ] [MainThread]: Flat graph built
12:07:34.939760 [info ] [MainThread]: Manifest loaded
12:07:34.940437 [info ] [MainThread]: Performance info: target/perf_info.json
12:07:34.940646 [info ] [MainThread]: Done.
12:07:34.940977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63173eddc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63173eddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f63173edeb0>]}


============================== 2022-06-09 12:12:32.441728 | 743fe4e8-42f0-4ba0-b669-ef6d34222980 ==============================
12:12:32.441747 [info ] [MainThread]: Running with dbt=1.1.0
12:12:32.442173 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
12:12:32.442385 [debug] [MainThread]: Tracking: tracking
12:12:32.451987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81900acf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81900ace80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f81900aceb0>]}
12:12:32.518637 [debug] [MainThread]: Executing "git --help"
12:12:32.527481 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
12:12:32.528057 [debug] [MainThread]: Opening a new connection, currently in state init
12:12:35.586530 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
12:12:35.586940 [debug] [MainThread]: On debug: No close available on handle
12:12:35.588019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818ffc1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818ffc1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f818ffc8dc0>]}
12:12:36.085000 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 12:13:35.508570 | e899afd6-e94c-42c3-85ca-4d4cf6cb96ca ==============================
12:13:35.508585 [info ] [MainThread]: Running with dbt=1.1.0
12:13:35.508972 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
12:13:35.509101 [debug] [MainThread]: Tracking: tracking
12:13:35.518203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c4e8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c4e8ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c4e8dc0>]}
12:13:35.579638 [debug] [MainThread]: Executing "git --help"
12:13:35.584323 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:13:35.584794 [debug] [MainThread]: STDERR: "b''"
12:13:35.588518 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
12:13:35.589041 [debug] [MainThread]: Opening a new connection, currently in state init
12:13:38.640906 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
12:13:38.641309 [debug] [MainThread]: On debug: No close available on handle
12:13:38.642408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c4e8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c3f6040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c402e20>]}
12:13:39.138117 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 12:41:35.139452 | ddf81c01-5b6b-40af-9614-5f76791fcddc ==============================
12:41:35.139468 [info ] [MainThread]: Running with dbt=1.1.0
12:41:35.139893 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
12:41:35.140032 [debug] [MainThread]: Tracking: tracking
12:41:35.149318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1132b1f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1132b1e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1132b1e80>]}
12:41:35.214002 [debug] [MainThread]: Executing "git --help"
12:41:35.218914 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:41:35.219389 [debug] [MainThread]: STDERR: "b''"
12:41:35.223361 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
12:41:35.223885 [debug] [MainThread]: Opening a new connection, currently in state init
12:41:38.270004 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
12:41:38.270437 [debug] [MainThread]: On debug: No close available on handle
12:41:38.271612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1131c7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1131d0e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1131d0eb0>]}
12:41:38.754049 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 12:41:58.406654 | 08c41f64-abe5-4b00-a50a-58bd2966ecac ==============================
12:41:58.406672 [info ] [MainThread]: Running with dbt=1.1.0
12:41:58.407097 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
12:41:58.407251 [debug] [MainThread]: Tracking: tracking
12:41:58.416801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b9c72eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b9c72df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b9c72e20>]}
12:41:58.482932 [debug] [MainThread]: Executing "git --help"
12:41:58.487876 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:41:58.488340 [debug] [MainThread]: STDERR: "b''"
12:41:58.492239 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
12:41:58.492753 [debug] [MainThread]: Opening a new connection, currently in state init
12:42:01.547015 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
12:42:01.547470 [debug] [MainThread]: On debug: No close available on handle
12:42:01.548633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b9c72ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b9b8fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc9b9b8fe80>]}
12:42:02.066403 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 12:42:31.740012 | 6834a790-c67c-4d9a-8f45-b4d190dd4477 ==============================
12:42:31.740029 [info ] [MainThread]: Running with dbt=1.1.0
12:42:31.740507 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
12:42:31.740652 [debug] [MainThread]: Tracking: tracking
12:42:31.750201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffb77ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffb77fee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffb77fdc0>]}
12:42:31.815559 [debug] [MainThread]: Executing "git --help"
12:42:31.820873 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:42:31.821366 [debug] [MainThread]: STDERR: "b''"
12:42:31.825512 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
12:42:31.826059 [debug] [MainThread]: Opening a new connection, currently in state init
12:42:34.874910 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
12:42:34.875376 [debug] [MainThread]: On debug: No close available on handle
12:42:34.876619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffb77fdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffb684040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ffb69ce20>]}
12:42:35.388186 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 13:04:24.465668 | ccab54e5-6177-4561-8804-e78ca0b482df ==============================
13:04:24.465683 [info ] [MainThread]: Running with dbt=1.1.0
13:04:24.466188 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:04:24.466428 [debug] [MainThread]: Tracking: tracking
13:04:24.476023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ef525460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ef5253d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ef525400>]}
13:04:24.499794 [debug] [MainThread]: Executing "git --help"
13:04:24.504829 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:04:24.505287 [debug] [MainThread]: STDERR: "b''"
13:04:24.505818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ef5253a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ef51a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15ef51ab20>]}


============================== 2022-06-09 13:05:21.011284 | 03feb4ee-03dd-4399-96d8-39411101656c ==============================
13:05:21.011302 [info ] [MainThread]: Running with dbt=1.1.0
13:05:21.011747 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:05:21.011873 [debug] [MainThread]: Tracking: tracking
13:05:21.021240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963f813550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963f813370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963f8133a0>]}
13:05:21.044636 [debug] [MainThread]: Executing "git --help"
13:05:21.049951 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:05:21.050487 [debug] [MainThread]: STDERR: "b''"
13:05:21.051015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963f813490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963f808d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f963f808a60>]}


============================== 2022-06-09 13:05:36.926404 | 4ac87b05-0510-4755-a0ab-c8ca9f2b8a01 ==============================
13:05:36.926420 [info ] [MainThread]: Running with dbt=1.1.0
13:05:36.926832 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:05:36.927028 [debug] [MainThread]: Tracking: tracking
13:05:36.936646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76039d3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76039d3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76039d3eb0>]}
13:05:37.002040 [debug] [MainThread]: Executing "git --help"
13:05:37.007044 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:05:37.007493 [debug] [MainThread]: STDERR: "b''"
13:05:37.011706 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
13:05:37.012280 [debug] [MainThread]: Opening a new connection, currently in state init
13:05:40.064053 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
13:05:40.064629 [debug] [MainThread]: On debug: No close available on handle
13:05:40.065833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76038e8bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76038efe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76038efee0>]}
13:05:40.549788 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 13:08:48.737527 | 0208c949-3175-44cc-a8e7-c24c27b2def1 ==============================
13:08:48.737544 [info ] [MainThread]: Running with dbt=1.1.0
13:08:48.738024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:08:48.738215 [debug] [MainThread]: Tracking: tracking
13:08:48.747679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698e21ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698e21fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698e21fe80>]}
13:08:48.813272 [debug] [MainThread]: Executing "git --help"
13:08:48.818064 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:08:48.818516 [debug] [MainThread]: STDERR: "b''"
13:08:48.822402 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
13:08:48.822931 [debug] [MainThread]: Opening a new connection, currently in state init
13:08:51.873642 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
13:08:51.874217 [debug] [MainThread]: On debug: No close available on handle
13:08:51.875614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698e133730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698e145fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f698e145f70>]}
13:08:52.363630 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 13:11:15.154515 | e86b4086-2bc8-436c-b7b1-e4edcc6f7cb3 ==============================
13:11:15.154542 [info ] [MainThread]: Running with dbt=1.1.0
13:11:15.155144 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
13:11:15.155319 [debug] [MainThread]: Tracking: tracking
13:11:15.166514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e988957c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e98895940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e98895970>]}
13:11:15.167316 [info ] [MainThread]: Start parsing.
13:11:15.197703 [info ] [MainThread]: Dependencies loaded
13:11:15.209951 [info ] [MainThread]: Unable to do partial parsing because profile has changed
13:11:15.210499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e86b4086-2bc8-436c-b7b1-e4edcc6f7cb3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e988379d0>]}
13:11:15.211423 [info ] [MainThread]: ManifestLoader created
13:11:15.229255 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:11:15.232105 [debug] [MainThread]: Parsing macros/catalog.sql
13:11:15.233877 [debug] [MainThread]: Parsing macros/adapters.sql
13:11:15.268519 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:11:15.269758 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:11:15.295176 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:11:15.299263 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:11:15.300720 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:11:15.327052 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:11:15.329800 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:11:15.331457 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:11:15.333112 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:11:15.334606 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:11:15.335421 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:11:15.336293 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:11:15.337190 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:11:15.345697 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:11:15.350205 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:11:15.354656 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:11:15.357716 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:11:15.365061 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:11:15.367945 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:11:15.377274 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:11:15.387139 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:11:15.389610 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:11:15.393656 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:11:15.396220 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:11:15.412872 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:11:15.419062 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:11:15.420608 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:11:15.427495 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:11:15.430429 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:11:15.432825 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:11:15.435710 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:11:15.443486 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:11:15.445243 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:11:15.455478 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:11:15.471342 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:11:15.487229 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:11:15.492030 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:11:15.504889 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:11:15.516104 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:11:15.518156 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:11:15.534819 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:11:15.536922 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:11:15.541539 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:11:15.543589 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:11:15.546689 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:11:15.549979 [debug] [MainThread]: Parsing macros/generate_source.sql
13:11:15.557066 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:11:15.560188 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:11:15.561618 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:11:15.563091 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:11:15.568832 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:11:15.572563 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:11:15.582501 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:11:15.587556 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:11:15.589004 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:11:15.590742 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:11:15.592350 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:11:15.593451 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:11:15.594997 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:11:15.596922 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:11:15.599007 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:11:15.600584 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:11:15.601660 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:11:15.602863 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:11:15.603971 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:11:15.607312 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:11:15.608902 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:11:15.611682 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:11:15.612689 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:11:15.614871 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:11:15.620694 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:11:15.622207 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:11:15.631152 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:11:15.633171 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:11:15.634553 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:11:15.636136 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:11:15.637482 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:11:15.640404 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:11:15.642686 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:11:15.645233 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:11:15.649493 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:11:15.651644 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:11:15.653412 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:11:15.655609 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:11:15.657388 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:11:15.666122 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:11:15.668547 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:11:15.670136 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:11:15.673011 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:11:15.674903 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:11:15.676784 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:11:15.678218 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:11:15.679542 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:11:15.680728 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:11:15.682014 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:11:15.684418 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:11:15.686085 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:11:15.694222 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:11:15.700638 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:11:15.708052 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:11:15.710058 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:11:15.713745 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:11:15.715634 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:11:15.720132 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:11:15.726177 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:11:15.727820 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:11:15.734157 [debug] [MainThread]: Parsing macros/sql/star.sql
13:11:15.737699 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:11:15.741264 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:11:15.744198 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:11:15.748718 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:11:15.750541 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:11:15.754804 [debug] [MainThread]: Parsing macros/sql/union.sql
13:11:15.765738 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:11:15.769491 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:11:15.771438 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:11:15.795890 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:11:15.798358 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:11:15.800194 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:11:16.177817 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
13:11:16.226826 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
13:11:16.347153 [info ] [MainThread]: Manifest loaded
13:11:16.347956 [info ] [MainThread]: Manifest checked
13:11:16.348385 [info ] [MainThread]: Flat graph built
13:11:16.348637 [info ] [MainThread]: Manifest loaded
13:11:16.349316 [info ] [MainThread]: Performance info: target/perf_info.json
13:11:16.349661 [info ] [MainThread]: Done.
13:11:16.350066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9879e610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9879e730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e9879e820>]}


============================== 2022-06-09 13:16:32.976076 | 47594bff-35b7-4c8a-9412-9f95f0b37155 ==============================
13:16:32.976093 [info ] [MainThread]: Running with dbt=1.1.0
13:16:32.976520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:16:32.976688 [debug] [MainThread]: Tracking: tracking
13:16:32.986080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1422304fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1422304ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1422304dc0>]}
13:16:33.050486 [debug] [MainThread]: Executing "git --help"
13:16:33.055159 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:16:33.055609 [debug] [MainThread]: STDERR: "b''"
13:16:33.059467 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
13:16:33.060008 [debug] [MainThread]: Opening a new connection, currently in state init
13:16:36.111715 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
13:16:36.112130 [debug] [MainThread]: On debug: No close available on handle
13:16:36.113211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f142220ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1422229f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1422229fd0>]}
13:16:36.589816 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 13:17:17.023425 | aa7ce984-1c8b-455f-b12e-3a1659675d44 ==============================
13:17:17.023440 [info ] [MainThread]: Running with dbt=1.1.0
13:17:17.023849 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:17:17.023998 [debug] [MainThread]: Tracking: tracking
13:17:17.033005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7674bbcf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7674bbce50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7674bbce80>]}
13:17:17.096985 [debug] [MainThread]: Executing "git --help"
13:17:17.101279 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:17:17.101737 [debug] [MainThread]: STDERR: "b''"
13:17:17.105385 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
13:17:17.105894 [debug] [MainThread]: Opening a new connection, currently in state init
13:17:20.153867 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
13:17:20.154274 [debug] [MainThread]: On debug: No close available on handle
13:17:20.155397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7674ac7b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7674adcfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7674adcf70>]}
13:17:20.642680 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 13:33:32.021743 | c585ee25-8679-4f96-bbce-18b566cb0869 ==============================
13:33:32.021764 [info ] [MainThread]: Running with dbt=1.1.0
13:33:32.022323 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
13:33:32.022556 [debug] [MainThread]: Tracking: tracking
13:33:32.032714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0583de700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0583de880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0583de8b0>]}
13:33:32.033244 [info ] [MainThread]: Start parsing.
13:33:32.060015 [info ] [MainThread]: Dependencies loaded
13:33:32.071708 [info ] [MainThread]: Unable to do partial parsing because profile has changed
13:33:32.072141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c585ee25-8679-4f96-bbce-18b566cb0869', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb05838d850>]}
13:33:32.072926 [info ] [MainThread]: ManifestLoader created
13:33:32.090526 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:33:32.093162 [debug] [MainThread]: Parsing macros/catalog.sql
13:33:32.094866 [debug] [MainThread]: Parsing macros/adapters.sql
13:33:32.129651 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:33:32.130863 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:33:32.155497 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:33:32.159368 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:33:32.160686 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:33:32.187161 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:33:32.189862 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:33:32.191489 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:33:32.193158 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:33:32.194602 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:33:32.195384 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:33:32.196272 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:33:32.197164 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:33:32.205299 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:33:32.209701 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:33:32.214041 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:33:32.217010 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:33:32.224212 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:33:32.227000 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:33:32.236232 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:33:32.245504 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:33:32.247769 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:33:32.251572 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:33:32.253980 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:33:32.270847 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:33:32.277063 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:33:32.278589 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:33:32.285403 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:33:32.288188 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:33:32.290524 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:33:32.293305 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:33:32.300603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:33:32.302196 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:33:32.312078 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:33:32.327749 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:33:32.343130 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:33:32.347718 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:33:32.360116 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:33:32.370928 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:33:32.372846 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:33:32.388920 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:33:32.390924 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:33:32.395329 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:33:32.397258 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:33:32.400182 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:33:32.403296 [debug] [MainThread]: Parsing macros/generate_source.sql
13:33:32.410013 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:33:32.412993 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:33:32.414390 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:33:32.415861 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:33:32.421555 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:33:32.425077 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:33:32.434832 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:33:32.439938 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:33:32.441357 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:33:32.443044 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:33:32.444560 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:33:32.445667 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:33:32.447252 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:33:32.449232 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:33:32.451344 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:33:32.452931 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:33:32.453963 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:33:32.455175 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:33:32.456254 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:33:32.459560 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:33:32.461199 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:33:32.464032 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:33:32.465026 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:33:32.467277 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:33:32.473150 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:33:32.474604 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:33:32.483158 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:33:32.485128 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:33:32.486446 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:33:32.487926 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:33:32.489198 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:33:32.491984 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:33:32.494214 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:33:32.496739 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:33:32.500836 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:33:32.502871 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:33:32.504541 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:33:32.506625 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:33:32.508336 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:33:32.517024 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:33:32.519256 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:33:32.520733 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:33:32.523612 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:33:32.525408 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:33:32.527277 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:33:32.528619 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:33:32.529885 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:33:32.531034 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:33:32.532262 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:33:32.534594 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:33:32.536176 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:33:32.543907 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:33:32.549530 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:33:32.556374 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:33:32.558123 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:33:32.561593 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:33:32.563343 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:33:32.567555 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:33:32.573248 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:33:32.574772 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:33:32.581011 [debug] [MainThread]: Parsing macros/sql/star.sql
13:33:32.584413 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:33:32.587772 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:33:32.590499 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:33:32.594863 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:33:32.596591 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:33:32.600620 [debug] [MainThread]: Parsing macros/sql/union.sql
13:33:32.611165 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:33:32.614643 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:33:32.616392 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:33:32.639664 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:33:32.641889 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:33:32.643586 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:33:33.008513 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
13:33:33.051617 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
13:33:33.166756 [info ] [MainThread]: Manifest loaded
13:33:33.167437 [info ] [MainThread]: Manifest checked
13:33:33.167920 [info ] [MainThread]: Flat graph built
13:33:33.168266 [info ] [MainThread]: Manifest loaded
13:33:33.169075 [info ] [MainThread]: Performance info: target/perf_info.json
13:33:33.169377 [info ] [MainThread]: Done.
13:33:33.169783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0582d68b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0582d6e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0582d6730>]}


============================== 2022-06-09 13:33:54.098628 | 209d13e8-ea61-4e76-8583-8e80c5591234 ==============================
13:33:54.098643 [info ] [MainThread]: Running with dbt=1.1.0
13:33:54.099069 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:33:54.099235 [debug] [MainThread]: Tracking: tracking
13:33:54.109130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc106481c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1064b3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1064b3eb0>]}
13:33:54.173914 [debug] [MainThread]: Executing "git --help"
13:33:54.179133 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:33:54.179623 [debug] [MainThread]: STDERR: "b''"
13:33:54.183803 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
13:33:54.184284 [debug] [MainThread]: Opening a new connection, currently in state init
13:33:57.232201 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
13:33:57.232642 [debug] [MainThread]: On debug: No close available on handle
13:33:57.234261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10635cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc106358fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc10630e040>]}
13:33:57.713930 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 14:02:35.831030 | a391772e-dd66-4581-8009-4ec1444c14ce ==============================
14:02:35.831044 [info ] [MainThread]: Running with dbt=1.1.0
14:02:35.831462 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
14:02:35.831601 [debug] [MainThread]: Tracking: tracking
14:02:35.842465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491fb17c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491fb49e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491fb49eb0>]}
14:02:35.905659 [debug] [MainThread]: Executing "git --help"
14:02:35.911644 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
14:02:35.912116 [debug] [MainThread]: STDERR: "b''"
14:02:35.916147 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
14:02:35.916672 [debug] [MainThread]: Opening a new connection, currently in state init
14:04:09.025551 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
14:04:09.026003 [debug] [MainThread]: On debug: No close available on handle
14:04:09.026556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491f9debe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491f9d64c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f491f99f130>]}
14:04:09.533432 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 16:32:52.406365 | cf92eab9-101e-4391-87f7-44fb53984511 ==============================
16:32:52.406381 [info ] [MainThread]: Running with dbt=1.1.0
16:32:52.406784 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
16:32:52.406969 [debug] [MainThread]: Tracking: tracking
16:32:52.416298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f4392460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f43923d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f4392400>]}
16:32:52.438689 [debug] [MainThread]: Executing "git --help"
16:32:52.443275 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:32:52.443727 [debug] [MainThread]: STDERR: "b''"
16:32:52.444221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f4392460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f4387820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8f4387400>]}


============================== 2022-06-09 16:34:09.835856 | 6611bdca-60d3-4096-8c04-05cfe2115c14 ==============================
16:34:09.835870 [info ] [MainThread]: Running with dbt=1.1.0
16:34:09.836307 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
16:34:09.836483 [debug] [MainThread]: Tracking: tracking
16:34:09.845357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56603f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56603eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56603ee0>]}
16:34:09.907170 [debug] [MainThread]: Executing "git --help"
16:34:09.911598 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:34:09.912073 [debug] [MainThread]: STDERR: "b''"
16:34:09.916052 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
16:34:09.916547 [debug] [MainThread]: Opening a new connection, currently in state init
16:34:09.931979 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: ':HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440 returned response code 400)
 b'Port 9000 is for clickhouse-client program\r\nYou must use port 8123 for HTTP.\r\n''
16:34:09.932441 [debug] [MainThread]: On debug: No close available on handle
16:34:09.932956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a5648fe80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a564571f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a56457280>]}
16:34:10.432386 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 16:35:31.780362 | 1c8d5f1a-d191-47cf-abb4-eac328355b74 ==============================
16:35:31.780377 [info ] [MainThread]: Running with dbt=1.1.0
16:35:31.780810 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
16:35:31.780930 [debug] [MainThread]: Tracking: tracking
16:35:31.790184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3209751f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3209751e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3209751e80>]}
16:35:31.818111 [debug] [MainThread]: Executing "git --help"
16:35:31.823086 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:35:31.823537 [debug] [MainThread]: STDERR: "b''"
16:35:31.824031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32097c13a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32097289a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32097282b0>]}


============================== 2022-06-09 16:35:48.228406 | 38a37dd2-e92b-4f53-9d1d-f5da4ac4bde4 ==============================
16:35:48.228423 [info ] [MainThread]: Running with dbt=1.1.0
16:35:48.228846 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
16:35:48.229005 [debug] [MainThread]: Tracking: tracking
16:35:48.237834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfa00aeb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfa00adf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dfa00ae20>]}
16:35:48.300371 [debug] [MainThread]: Executing "git --help"
16:35:48.304918 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:35:48.305345 [debug] [MainThread]: STDERR: "b''"
16:35:48.308921 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
16:35:48.309401 [debug] [MainThread]: Opening a new connection, currently in state init
16:35:51.359233 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
16:35:51.359664 [debug] [MainThread]: On debug: No close available on handle
16:35:51.360908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df9f2bfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df9f28f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3df9f28b20>]}
16:35:51.849540 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 16:37:04.221492 | 9ee30c25-e228-474e-ab27-2ff20a0b9b83 ==============================
16:37:04.221509 [info ] [MainThread]: Running with dbt=1.1.0
16:37:04.221931 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
16:37:04.222117 [debug] [MainThread]: Tracking: tracking
16:37:04.231493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67fef7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67fef7e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67fef7e80>]}
16:37:04.295730 [debug] [MainThread]: Executing "git --help"
16:37:04.300061 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:37:04.300500 [debug] [MainThread]: STDERR: "b''"
16:37:04.304063 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
16:37:04.304570 [debug] [MainThread]: Opening a new connection, currently in state init
16:37:07.355563 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
16:37:07.356058 [debug] [MainThread]: On debug: No close available on handle
16:37:07.357096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67fe0aa00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67fe1cee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff67fe1cf70>]}
16:37:07.843572 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 16:42:30.972595 | 513dd936-4a84-43a9-b685-9aa25602dd8d ==============================
16:42:30.972609 [info ] [MainThread]: Running with dbt=1.1.0
16:42:30.973028 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
16:42:30.973157 [debug] [MainThread]: Tracking: tracking
16:42:30.982464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde48e38f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde48e38e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde48e38e80>]}
16:42:31.044242 [debug] [MainThread]: Executing "git --help"
16:42:31.048827 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:42:31.049236 [debug] [MainThread]: STDERR: "b''"
16:42:31.052665 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
16:42:31.053101 [debug] [MainThread]: Opening a new connection, currently in state init
16:42:34.101990 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: 'Error executing HTTP request https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440'
16:42:34.102407 [debug] [MainThread]: On debug: No close available on handle
16:42:34.103638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde48d3a790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde48d5eee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde48d5ef70>]}
16:42:34.584126 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 16:45:18.562795 | 5c5c4938-4eb6-48d1-b287-13cdec9b0256 ==============================
16:45:18.562810 [info ] [MainThread]: Running with dbt=1.1.0
16:45:18.563240 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
16:45:18.563376 [debug] [MainThread]: Tracking: tracking
16:45:18.572383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe278485fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe278485ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe278485dc0>]}
16:45:18.632145 [debug] [MainThread]: Executing "git --help"
16:45:18.636339 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
16:45:18.636754 [debug] [MainThread]: STDERR: "b''"
16:45:18.640437 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
16:45:18.640965 [debug] [MainThread]: Opening a new connection, currently in state init
16:45:18.655977 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: ':HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440 returned response code 400)
 b'Port 9000 is for clickhouse-client program\r\nYou must use port 8123 for HTTP.\r\n''
16:45:18.656301 [debug] [MainThread]: On debug: No close available on handle
16:45:18.656657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2783aab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe278364070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe278364100>]}
16:45:19.164719 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 17:01:15.840102 | 121e77e4-a31f-4bd2-9e65-7fc719b670f0 ==============================
17:01:15.840117 [info ] [MainThread]: Running with dbt=1.1.0
17:01:15.873192 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:01:15.873424 [debug] [MainThread]: Tracking: tracking
17:01:15.882613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257c7deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257c7ddf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257c7de20>]}
17:01:16.079010 [debug] [MainThread]: Executing "git --help"
17:01:16.083914 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:01:16.084351 [debug] [MainThread]: STDERR: "b''"
17:01:16.087915 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
17:01:16.088411 [debug] [MainThread]: Opening a new connection, currently in state init
17:01:16.102064 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: ':HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440 returned response code 400)
 b'Port 9000 is for clickhouse-client program\r\nYou must use port 8123 for HTTP.\r\n''
17:01:16.102476 [debug] [MainThread]: On debug: No close available on handle
17:01:16.102908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257bac730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257b5e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc257b5e130>]}
17:01:16.595737 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 17:05:06.076566 | f97ad9a3-f4d9-466c-a90f-265b4b0fbc90 ==============================
17:05:06.076582 [info ] [MainThread]: Running with dbt=1.1.0
17:05:06.076990 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:05:06.077128 [debug] [MainThread]: Tracking: tracking
17:05:06.086358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5d9b7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5d9b7e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5d9b7eb0>]}
17:05:06.149030 [debug] [MainThread]: Executing "git --help"
17:05:06.154101 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:05:06.154555 [debug] [MainThread]: STDERR: "b''"
17:05:06.158480 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
17:05:06.159015 [debug] [MainThread]: Opening a new connection, currently in state init
17:05:06.179109 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: ':HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440 returned response code 400)
 b'Port 9000 is for clickhouse-client program\r\nYou must use port 8123 for HTTP.\r\n''
17:05:06.179506 [debug] [MainThread]: On debug: No close available on handle
17:05:06.180008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5d8e5820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5d894100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e5d894190>]}
17:05:06.684130 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 17:10:19.147587 | 5be41f55-c0a0-4249-b29f-00b867d681e6 ==============================
17:10:19.147601 [info ] [MainThread]: Running with dbt=1.1.0
17:10:19.147996 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:10:19.148135 [debug] [MainThread]: Tracking: tracking
17:10:19.156822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2708afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2708aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f2708adc0>]}
17:10:19.218569 [debug] [MainThread]: Executing "git --help"
17:10:19.223325 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:10:19.223738 [debug] [MainThread]: STDERR: "b''"
17:10:19.227292 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
17:10:19.227767 [debug] [MainThread]: Opening a new connection, currently in state init
17:10:19.269928 [debug] [MainThread]: clickhouse adapter: On debug: select 1 as id...
17:10:19.273879 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
17:10:19.275258 [debug] [MainThread]: On debug: Close
17:10:19.275663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f26f8ba60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f26f6b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6f26f6b850>]}
17:10:19.763559 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 17:12:24.362168 | 2a012288-8c37-4e63-a9be-85861a7b9a04 ==============================
17:12:24.362190 [info ] [MainThread]: Running with dbt=1.1.0
17:12:24.362743 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:12:24.362891 [debug] [MainThread]: Tracking: tracking
17:12:24.372348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95500b97c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95500b9940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95500b9970>]}
17:12:24.417263 [info ] [MainThread]: Unable to do partial parsing because profile has changed
17:12:24.417701 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
17:12:24.417944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a012288-8c37-4e63-a9be-85861a7b9a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9550066d90>]}
17:12:24.567345 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:12:24.569786 [debug] [MainThread]: Parsing macros/catalog.sql
17:12:24.571360 [debug] [MainThread]: Parsing macros/adapters.sql
17:12:24.604772 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
17:12:24.605869 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
17:12:24.630129 [debug] [MainThread]: Parsing macros/materializations/seed.sql
17:12:24.633933 [debug] [MainThread]: Parsing macros/materializations/test.sql
17:12:24.635185 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
17:12:24.659561 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
17:12:24.662184 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
17:12:24.663713 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
17:12:24.665244 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
17:12:24.666573 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
17:12:24.667263 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
17:12:24.668078 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
17:12:24.668906 [debug] [MainThread]: Parsing macros/etc/datetime.sql
17:12:24.676996 [debug] [MainThread]: Parsing macros/etc/statement.sql
17:12:24.681310 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
17:12:24.685421 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
17:12:24.688207 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
17:12:24.695001 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
17:12:24.697593 [debug] [MainThread]: Parsing macros/adapters/columns.sql
17:12:24.706581 [debug] [MainThread]: Parsing macros/adapters/relation.sql
17:12:24.715553 [debug] [MainThread]: Parsing macros/adapters/schema.sql
17:12:24.717748 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
17:12:24.721362 [debug] [MainThread]: Parsing macros/materializations/configs.sql
17:12:24.723643 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
17:12:24.739161 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
17:12:24.744966 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
17:12:24.746379 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
17:12:24.752958 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
17:12:24.755541 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
17:12:24.757754 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
17:12:24.760312 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
17:12:24.767244 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
17:12:24.768718 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
17:12:24.777979 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
17:12:24.793217 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
17:12:24.807939 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
17:12:24.812383 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
17:12:24.824174 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
17:12:24.834548 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
17:12:24.836394 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
17:12:24.852314 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
17:12:24.854203 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
17:12:24.858457 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
17:12:24.860257 [debug] [MainThread]: Parsing tests/generic/builtin.sql
17:12:24.863111 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
17:12:24.866204 [debug] [MainThread]: Parsing macros/generate_source.sql
17:12:24.872888 [debug] [MainThread]: Parsing macros/generate_base_model.sql
17:12:24.875784 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
17:12:24.877116 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
17:12:24.878561 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
17:12:24.884267 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
17:12:24.887749 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
17:12:24.897196 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
17:12:24.902273 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
17:12:24.903668 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
17:12:24.905349 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
17:12:24.906908 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
17:12:24.908029 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
17:12:24.909585 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
17:12:24.911473 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
17:12:24.913407 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
17:12:24.914906 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
17:12:24.915891 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
17:12:24.916986 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
17:12:24.917982 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
17:12:24.921064 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
17:12:24.922546 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
17:12:24.925160 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
17:12:24.926080 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
17:12:24.928153 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
17:12:24.933515 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
17:12:24.934850 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
17:12:24.943246 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
17:12:24.945080 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
17:12:24.946349 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
17:12:24.947736 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
17:12:24.948987 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
17:12:24.951699 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
17:12:24.953767 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
17:12:24.956114 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
17:12:24.959950 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
17:12:24.961828 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
17:12:24.963410 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
17:12:24.965408 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
17:12:24.967002 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
17:12:24.975464 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
17:12:24.977689 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
17:12:24.979154 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
17:12:24.981817 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
17:12:24.983557 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
17:12:24.985310 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
17:12:24.986649 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
17:12:24.987856 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
17:12:24.988950 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
17:12:24.990150 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
17:12:24.992426 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
17:12:24.994080 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
17:12:25.002055 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
17:12:25.007579 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
17:12:25.014543 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
17:12:25.016373 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
17:12:25.019753 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
17:12:25.021332 [debug] [MainThread]: Parsing macros/sql/pivot.sql
17:12:25.025384 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
17:12:25.030960 [debug] [MainThread]: Parsing macros/sql/groupby.sql
17:12:25.032413 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
17:12:25.038418 [debug] [MainThread]: Parsing macros/sql/star.sql
17:12:25.041634 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
17:12:25.044925 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
17:12:25.047645 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
17:12:25.051867 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
17:12:25.053525 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
17:12:25.057409 [debug] [MainThread]: Parsing macros/sql/union.sql
17:12:25.067739 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
17:12:25.071264 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
17:12:25.072996 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
17:12:25.096201 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
17:12:25.098415 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
17:12:25.100060 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
17:12:25.455495 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
17:12:25.506280 [info ] [MainThread]: Macro is OK
17:12:25.506823 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
17:12:25.631543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a012288-8c37-4e63-a9be-85861a7b9a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954ff2c1f0>]}
17:12:25.672894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a012288-8c37-4e63-a9be-85861a7b9a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f954ff25a00>]}
17:12:25.673609 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:12:25.675429 [debug] [MainThread]: Opening a new connection, currently in state init
17:12:25.697801 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
17:12:25.714547 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n           
17:12:25.714783 [debug] [MainThread]: On macro_init_s3_sources: Close
17:12:25.715042 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:12:25.715153 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:12:25.715488 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n
17:12:25.715773 [debug] [MainThread]: 
17:12:25.716065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9550091c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f955010c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f955010c4f0>]}
17:12:26.199611 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:12:56.623613 | 60490b15-e972-413d-88c8-75835f2169cb ==============================
17:12:56.623633 [info ] [MainThread]: Running with dbt=1.1.0
17:12:56.624150 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
17:12:56.624351 [debug] [MainThread]: Tracking: tracking
17:12:56.633366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e86d9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e86d9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e86d9940>]}
17:12:56.633894 [info ] [MainThread]: Start parsing.
17:12:56.659062 [info ] [MainThread]: Dependencies loaded
17:12:56.670543 [info ] [MainThread]: ManifestLoader created
17:12:56.687496 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:12:56.687762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:12:56.687920 [info ] [MainThread]: Manifest loaded
17:12:56.688493 [info ] [MainThread]: Manifest checked
17:12:56.689114 [info ] [MainThread]: Flat graph built
17:12:56.689383 [info ] [MainThread]: Manifest loaded
17:12:56.690082 [info ] [MainThread]: Performance info: target/perf_info.json
17:12:56.690349 [info ] [MainThread]: Done.
17:12:56.690724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e8509400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e8509520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29e8509490>]}


============================== 2022-06-09 17:18:59.569822 | d127affc-b08f-4896-87a7-58ae03a93d84 ==============================
17:18:59.569844 [info ] [MainThread]: Running with dbt=1.1.0
17:18:59.570380 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:18:59.570596 [debug] [MainThread]: Tracking: tracking
17:18:59.579403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff34de730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff34de8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff34de8e0>]}
17:18:59.630611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:18:59.630911 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:18:59.637307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd127affc-b08f-4896-87a7-58ae03a93d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff331ceb0>]}
17:18:59.645106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd127affc-b08f-4896-87a7-58ae03a93d84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff33beb50>]}
17:18:59.645756 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:18:59.655059 [debug] [MainThread]: Opening a new connection, currently in state init
17:18:59.674693 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
17:18:59.678159 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n           
17:18:59.678409 [debug] [MainThread]: On macro_init_s3_sources: Close
17:18:59.678679 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:18:59.678781 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:18:59.679134 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n
17:18:59.679404 [debug] [MainThread]: 
17:18:59.679774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff32d50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff32d5580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ff32d5550>]}
17:19:00.200911 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:31:13.960097 | 63b97cad-a105-431f-a300-5752aa0bbb10 ==============================
17:31:13.960121 [info ] [MainThread]: Running with dbt=1.1.0
17:31:13.960724 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:31:13.960906 [debug] [MainThread]: Tracking: tracking
17:31:13.971365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169fde27c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169fde2940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169fde2970>]}
17:31:14.029068 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:31:14.029866 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
17:31:14.030147 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:31:14.047748 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
17:31:14.104480 [info ] [MainThread]: Macro is OK
17:31:14.104941 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
17:31:14.117193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63b97cad-a105-431f-a300-5752aa0bbb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169fb99520>]}
17:31:14.126076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63b97cad-a105-431f-a300-5752aa0bbb10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169fbdeca0>]}
17:31:14.126864 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:31:14.128796 [debug] [MainThread]: Opening a new connection, currently in state init
17:31:14.152164 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
17:31:14.156074 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n           
17:31:14.156300 [debug] [MainThread]: On macro_init_s3_sources: Close
17:31:14.156629 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:31:14.156776 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:31:14.157131 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n
17:31:14.157404 [debug] [MainThread]: 
17:31:14.157777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169fcea760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169fcea7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f169fcea9a0>]}
17:31:14.649163 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:32:25.160919 | b1c05cba-2d35-4cff-a380-fb15ad8ed708 ==============================
17:32:25.160941 [info ] [MainThread]: Running with dbt=1.1.0
17:32:25.161546 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:32:25.161714 [debug] [MainThread]: Tracking: tracking
17:32:25.171340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1776714730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17767148b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17767148e0>]}
17:32:25.227471 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:32:25.227777 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:32:25.234598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1c05cba-2d35-4cff-a380-fb15ad8ed708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1776551eb0>]}
17:32:25.243161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1c05cba-2d35-4cff-a380-fb15ad8ed708', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17765f2b50>]}
17:32:25.243952 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:32:25.256006 [debug] [MainThread]: Opening a new connection, currently in state init
17:32:25.277205 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
17:32:25.281069 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n           
17:32:25.281269 [debug] [MainThread]: On macro_init_s3_sources: Close
17:32:25.281518 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:32:25.281622 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:32:25.281998 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n
17:32:25.282304 [debug] [MainThread]: 
17:32:25.282643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1776505130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17765052b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17765055b0>]}
17:32:25.772543 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:35:27.197444 | 50bb5c2b-4670-4ad1-bdca-9adcc8b0321a ==============================
17:35:27.197468 [info ] [MainThread]: Running with dbt=1.1.0
17:35:27.198067 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:35:27.198295 [debug] [MainThread]: Tracking: tracking
17:35:27.207805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7645f46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7645f4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7645f4850>]}
17:35:27.262904 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:35:27.263548 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
17:35:27.263761 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:35:27.280961 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
17:35:27.336308 [info ] [MainThread]: Macro is OK
17:35:27.336792 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
17:35:27.348971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50bb5c2b-4670-4ad1-bdca-9adcc8b0321a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7643b5220>]}
17:35:27.357361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50bb5c2b-4670-4ad1-bdca-9adcc8b0321a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7643a4f40>]}
17:35:27.358028 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:35:27.359689 [debug] [MainThread]: Opening a new connection, currently in state init
17:35:27.381419 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
17:35:27.385108 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n           
17:35:27.385368 [debug] [MainThread]: On macro_init_s3_sources: Close
17:35:27.385651 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:35:27.385755 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:35:27.386121 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n
17:35:27.386430 [debug] [MainThread]: 
17:35:27.386815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76432a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76432ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd76432a520>]}
17:35:27.903848 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:36:03.925964 | f39f4a9c-f61b-401d-936d-ef4aa3d07185 ==============================
17:36:03.925985 [info ] [MainThread]: Running with dbt=1.1.0
17:36:03.926612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:36:03.926781 [debug] [MainThread]: Tracking: tracking
17:36:03.936355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95a58b790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95a58b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95a58b940>]}
17:36:03.992113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:36:03.992402 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:36:03.998999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f39f4a9c-f61b-401d-936d-ef4aa3d07185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95a3c9fd0>]}
17:36:04.007635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f39f4a9c-f61b-401d-936d-ef4aa3d07185', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95a469b80>]}
17:36:04.008415 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:36:04.021101 [debug] [MainThread]: Opening a new connection, currently in state init
17:36:04.042463 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
17:36:04.046912 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n           
17:36:04.047188 [debug] [MainThread]: On macro_init_s3_sources: Close
17:36:04.047536 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:36:04.047667 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:36:04.047983 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n
17:36:04.048255 [debug] [MainThread]: 
17:36:04.048660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95a37e1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95a37e6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa95a37e670>]}
17:36:04.535198 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:37:44.891106 | 0697f05e-76cb-43e1-8cf6-48cd3b144ad4 ==============================
17:37:44.891128 [info ] [MainThread]: Running with dbt=1.1.0
17:37:44.891695 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:37:44.891915 [debug] [MainThread]: Tracking: tracking
17:37:44.901037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64760626a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6476062820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6476062850>]}
17:37:44.955660 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:37:44.955945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:37:44.962519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0697f05e-76cb-43e1-8cf6-48cd3b144ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6475e9de20>]}
17:37:44.970861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0697f05e-76cb-43e1-8cf6-48cd3b144ad4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6475f47a90>]}
17:37:44.971564 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:37:44.982702 [debug] [MainThread]: Opening a new connection, currently in state init
17:37:45.005755 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
17:37:45.010441 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n           
17:37:45.010707 [debug] [MainThread]: On macro_init_s3_sources: Close
17:37:45.011005 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:37:45.011122 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:37:45.011498 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n
17:37:45.011815 [debug] [MainThread]: 
17:37:45.012151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6475e5d0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6475e5d550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6475e5d520>]}
17:37:45.507553 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:39:03.519795 | 3a13e0c1-2778-4bcd-9957-3511ee3404f6 ==============================
17:39:03.519817 [info ] [MainThread]: Running with dbt=1.1.0
17:39:03.520442 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:39:03.520626 [debug] [MainThread]: Tracking: tracking
17:39:03.530364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae0bfc730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae0bfc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae0bfc8e0>]}
17:39:03.586707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:39:03.587388 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
17:39:03.587623 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:39:03.605249 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
17:39:03.662595 [info ] [MainThread]: Macro is OK
17:39:03.663079 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
17:39:03.675023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a13e0c1-2778-4bcd-9957-3511ee3404f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae09bf490>]}
17:39:03.683902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a13e0c1-2778-4bcd-9957-3511ee3404f6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae09a7fa0>]}
17:39:03.684663 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:39:03.686475 [debug] [MainThread]: Opening a new connection, currently in state init
17:39:03.707843 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
17:39:03.711461 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n           
17:39:03.711722 [debug] [MainThread]: On macro_init_s3_sources: Close
17:39:03.712022 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:39:03.712137 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:39:03.712488 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n
17:39:03.712786 [debug] [MainThread]: 
17:39:03.713166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae0b0bca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae0b0b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faae0b0b730>]}
17:39:04.200923 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:39:41.618812 | 4bfea314-2ef5-4cb3-8d61-4cf721efe0c3 ==============================
17:39:41.618834 [info ] [MainThread]: Running with dbt=1.1.0
17:39:41.619365 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:39:41.619532 [debug] [MainThread]: Tracking: tracking
17:39:41.628752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b347d07c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b347d0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b347d0970>]}
17:39:41.682949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:39:41.683213 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:39:41.689506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4bfea314-2ef5-4cb3-8d61-4cf721efe0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b3460bf10>]}
17:39:41.697409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4bfea314-2ef5-4cb3-8d61-4cf721efe0c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b346abbb0>]}
17:39:41.698126 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:39:41.709587 [debug] [MainThread]: Opening a new connection, currently in state init
17:39:41.731610 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
17:39:41.735172 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n           
17:39:41.735387 [debug] [MainThread]: On macro_init_s3_sources: Close
17:39:41.735710 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:39:41.735860 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:39:41.736185 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 695 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n
17:39:41.736448 [debug] [MainThread]: 
17:39:41.736793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b345bf1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b345bf370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b345bf670>]}
17:39:42.220951 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:40:46.108271 | 7f80a203-bc0a-4f7c-a9ba-c96e76ccebf4 ==============================
17:40:46.108295 [info ] [MainThread]: Running with dbt=1.1.0
17:40:46.108902 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:40:46.109146 [debug] [MainThread]: Tracking: tracking
17:40:46.118851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7480f9d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7480f9d880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7480f9d8b0>]}
17:40:46.175162 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:40:46.175862 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
17:40:46.176102 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:40:46.177116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7480e1b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7480dc79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7480dc7a30>]}


============================== 2022-06-09 17:43:11.652720 | e6133ac4-3aea-44fa-82a1-b08470133516 ==============================
17:43:11.652744 [info ] [MainThread]: Running with dbt=1.1.0
17:43:11.653283 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:43:11.653503 [debug] [MainThread]: Tracking: tracking
17:43:11.663107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe02b66700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe02b66880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe02b668b0>]}
17:43:11.716568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:43:11.717211 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
17:43:11.717422 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:43:11.753193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe029e2880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe0298fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe0298fc40>]}


============================== 2022-06-09 17:43:32.013220 | fa01da4e-d504-4d35-b857-064ee246245a ==============================
17:43:32.013244 [info ] [MainThread]: Running with dbt=1.1.0
17:43:32.013817 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:43:32.014041 [debug] [MainThread]: Tracking: tracking
17:43:32.023525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f848fd70700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f848fd70880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f848fd708b0>]}
17:43:32.080214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:43:32.080901 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
17:43:32.081136 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:43:32.098595 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
17:43:32.147287 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.147781 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.148035 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.148307 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.148580 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.148823 [info ] [MainThread]: Macro is OK
17:43:32.149080 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
17:43:32.162087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa01da4e-d504-4d35-b857-064ee246245a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f848fb3dfa0>]}
17:43:32.170392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa01da4e-d504-4d35-b857-064ee246245a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f848fb79fa0>]}
17:43:32.171153 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:43:32.172817 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.173186 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.173500 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.173805 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.174141 [info ] [MainThread]: query list["\n\n        CREATE TABLE src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n                C_ADDRESS       String,\n                C_CITY          LowCardinality(String),\n                C_NATION        LowCardinality(String),\n                C_REGION        LowCardinality(String),\n                C_PHONE         String,\n                C_MKTSEGMENT    LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_lineorder\n        (\n            LO_ORDERKEY             UInt32,\n            LO_LINENUMBER           UInt8,\n            LO_CUSTKEY              UInt32,\n            LO_PARTKEY              UInt32,\n            LO_SUPPKEY              UInt32,\n            LO_ORDERDATE            Date,\n            LO_ORDERPRIORITY        LowCardinality(String),\n            LO_SHIPPRIORITY         UInt8,\n            LO_QUANTITY             UInt8,\n            LO_EXTENDEDPRICE        UInt32,\n            LO_ORDTOTALPRICE        UInt32,\n            LO_DISCOUNT             UInt8,\n            LO_REVENUE              UInt32,\n            LO_SUPPLYCOST           UInt32,\n            LO_TAX                  UInt8,\n            LO_COMMITDATE           Date,\n            LO_SHIPMODE             LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_part\n        (\n                P_PARTKEY       UInt32,\n                P_NAME          String,\n                P_MFGR          LowCardinality(String),\n                P_CATEGORY      LowCardinality(String),\n                P_BRAND         LowCardinality(String),\n                P_COLOR         LowCardinality(String),\n                P_TYPE          LowCardinality(String),\n                P_SIZE          UInt8,\n                P_CONTAINER     LowCardinality(String)\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')\n        ", "\n\n        CREATE TABLE src_supplier\n        (\n                S_SUPPKEY       UInt32,\n                S_NAME          String,\n                S_ADDRESS       String,\n                S_CITY          LowCardinality(String),\n                S_NATION        LowCardinality(String),\n                S_REGION        LowCardinality(String),\n                S_PHONE         String\n        )\n        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')\n        ", '\n\n    ']
17:43:32.174484 [info ] [MainThread]: Macro is OK
17:43:32.177553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f848fd70700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f848fcd46a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f848fcd4700>]}
17:43:32.670894 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:44:58.937707 | 4a764965-d404-4463-9f5c-62b207710315 ==============================
17:44:58.937728 [info ] [MainThread]: Running with dbt=1.1.0
17:44:58.938321 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:44:58.938553 [debug] [MainThread]: Tracking: tracking
17:44:58.947780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba66b6700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba66b6880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba66b68b0>]}
17:44:59.000832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:44:59.001429 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
17:44:59.001634 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:44:59.004437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba6536880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba64e2be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdba64e2c40>]}


============================== 2022-06-09 17:45:17.778468 | 7d2f8787-abe3-498a-bb44-077d3754d7ca ==============================
17:45:17.778493 [info ] [MainThread]: Running with dbt=1.1.0
17:45:17.779061 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:45:17.779241 [debug] [MainThread]: Tracking: tracking
17:45:17.788844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1486d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1486d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde1486d910>]}
17:45:17.843623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:45:17.844264 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
17:45:17.844482 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:45:17.861352 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
17:45:17.911040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde146ec9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde14658250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fde146220d0>]}


============================== 2022-06-09 17:46:39.504540 | d97dd4a9-854e-4c5e-9fc3-40e01dbc76b8 ==============================
17:46:39.504560 [info ] [MainThread]: Running with dbt=1.1.0
17:46:39.505096 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:46:39.505329 [debug] [MainThread]: Tracking: tracking
17:46:39.514837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea6a01820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea6a019a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea6a019d0>]}
17:46:39.569411 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:46:39.570053 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
17:46:39.570277 [debug] [MainThread]: Parsing macros/init_s3_source.sql
17:46:39.587385 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
17:46:39.641012 [info ] [MainThread]: Macro is OK
17:46:39.641477 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
17:46:39.653132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd97dd4a9-854e-4c5e-9fc3-40e01dbc76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea67bc550>]}
17:46:39.661144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd97dd4a9-854e-4c5e-9fc3-40e01dbc76b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea67adb20>]}
17:46:39.661844 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:46:39.663556 [debug] [MainThread]: Opening a new connection, currently in state init
17:46:39.689724 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
17:46:39.705188 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
17:46:39.705546 [debug] [MainThread]: On macro_init_s3_sources: Close
17:46:39.705827 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:46:39.705934 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:46:39.706287 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
17:46:39.706640 [debug] [MainThread]: 
17:46:39.707051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea6911670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea69118b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0ea69118e0>]}
17:46:40.195922 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:56:23.454249 | 56e3cfb2-4750-42e3-b6ea-f0fcbb1ff560 ==============================
17:56:23.454268 [info ] [MainThread]: Running with dbt=1.1.0
17:56:23.454818 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
17:56:23.454972 [debug] [MainThread]: Tracking: tracking
17:56:23.463726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd032f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd032f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd032f910>]}
17:56:23.514862 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:56:23.515144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:56:23.521330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '56e3cfb2-4750-42e3-b6ea-f0fcbb1ff560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd016bee0>]}
17:56:23.529340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '56e3cfb2-4750-42e3-b6ea-f0fcbb1ff560', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd0215b50>]}
17:56:23.530027 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
17:56:23.540921 [debug] [MainThread]: Opening a new connection, currently in state init
17:56:23.561967 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
17:56:23.565510 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
17:56:23.565705 [debug] [MainThread]: On macro_init_s3_sources: Close
17:56:23.565943 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
17:56:23.566041 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
17:56:23.566436 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
17:56:23.566736 [debug] [MainThread]: 
17:56:23.567018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd0121160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd01213d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8cd0121610>]}
17:56:24.049236 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 17:56:50.346687 | 07499cfe-1d12-4165-b63f-2271e21301b1 ==============================
17:56:50.346701 [info ] [MainThread]: Running with dbt=1.1.0
17:56:50.347073 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
17:56:50.347182 [debug] [MainThread]: Tracking: tracking
17:56:50.355775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d901abfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d901abee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d901abdc0>]}
17:56:50.414219 [debug] [MainThread]: Executing "git --help"
17:56:50.418662 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
17:56:50.419068 [debug] [MainThread]: STDERR: "b''"
17:56:50.422184 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
17:56:50.422638 [debug] [MainThread]: Opening a new connection, currently in state init
17:56:50.443592 [debug] [MainThread]: clickhouse adapter: On debug: select 1 as id...
17:56:50.447584 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
17:56:50.448828 [debug] [MainThread]: On debug: Close
17:56:50.449197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d900b5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9008d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d9008d850>]}
17:56:50.937629 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 17:57:03.559968 | 2633f1e7-2e2a-4243-aa82-e43bbcefcf98 ==============================
17:57:03.559990 [info ] [MainThread]: Running with dbt=1.1.0
17:57:03.560594 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
17:57:03.560827 [debug] [MainThread]: Tracking: tracking
17:57:03.570421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f241776d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f24177850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f24177880>]}
17:57:03.570976 [info ] [MainThread]: Start parsing.
17:57:03.598347 [info ] [MainThread]: Dependencies loaded
17:57:03.610139 [info ] [MainThread]: ManifestLoader created
17:57:03.628495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:57:03.628797 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:57:03.628980 [info ] [MainThread]: Manifest loaded
17:57:03.629563 [info ] [MainThread]: Manifest checked
17:57:03.630226 [info ] [MainThread]: Flat graph built
17:57:03.630568 [info ] [MainThread]: Manifest loaded
17:57:03.631309 [info ] [MainThread]: Performance info: target/perf_info.json
17:57:03.631557 [info ] [MainThread]: Done.
17:57:03.631905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f23fa7340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f23fa7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f23fa73d0>]}


============================== 2022-06-09 18:00:55.089093 | fa060f7b-9103-4c12-8559-ba26e21e9bba ==============================
18:00:55.089117 [info ] [MainThread]: Running with dbt=1.1.0
18:00:55.089711 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
18:00:55.089948 [debug] [MainThread]: Tracking: tracking
18:00:55.099527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab52cd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab52cd970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab52cd9a0>]}
18:00:55.154518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:00:55.154832 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:00:55.161524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa060f7b-9103-4c12-8559-ba26e21e9bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab510cf40>]}
18:00:55.169854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa060f7b-9103-4c12-8559-ba26e21e9bba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab51acbe0>]}
18:00:55.170706 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
18:00:55.182537 [debug] [MainThread]: Opening a new connection, currently in state init
18:00:55.204438 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
18:00:55.208123 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
18:00:55.208418 [debug] [MainThread]: On macro_init_s3_sources: Close
18:00:55.208685 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
18:00:55.208792 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
18:00:55.209134 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
18:00:55.209423 [debug] [MainThread]: 
18:00:55.209818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab50c00a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab50c0460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faab50c0730>]}
18:00:55.700205 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-09 18:04:11.711484 | 0160410d-3a41-4dc8-bb06-c3f5fc4d68ad ==============================
18:04:11.711497 [info ] [MainThread]: Running with dbt=1.1.0
18:04:11.711896 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
18:04:11.712022 [debug] [MainThread]: Tracking: tracking
18:04:11.720996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3ebe3f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3ebe3e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3ebe3e50>]}
18:04:11.784337 [debug] [MainThread]: Executing "git --help"
18:04:11.789370 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
18:04:11.789855 [debug] [MainThread]: STDERR: "b''"
18:04:11.793816 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
18:04:11.794404 [debug] [MainThread]: Opening a new connection, currently in state init
18:04:11.816431 [debug] [MainThread]: clickhouse adapter: On debug: select 1 as id...
18:04:11.820025 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
18:04:11.821299 [debug] [MainThread]: On debug: Close
18:04:11.821751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3eb003d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3eaff400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3eaff2b0>]}
18:04:12.307251 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-09 18:04:17.728414 | 7940a1b8-8a41-4da7-b70e-cf5a900661aa ==============================
18:04:17.728440 [info ] [MainThread]: Running with dbt=1.1.0
18:04:17.729015 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
18:04:17.729236 [debug] [MainThread]: Tracking: tracking
18:04:17.738767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb3e60790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb3e60850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb3e60880>]}
18:04:17.776501 [info ] [MainThread]: Unable to do partial parsing because profile has changed
18:04:17.776966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7940a1b8-8a41-4da7-b70e-cf5a900661aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb3e1f9a0>]}
18:04:17.794845 [debug] [MainThread]: Parsing macros/init_s3_source.sql
18:04:17.797830 [debug] [MainThread]: Parsing macros/catalog.sql
18:04:17.799413 [debug] [MainThread]: Parsing macros/adapters.sql
18:04:17.833663 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
18:04:17.834780 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
18:04:17.859655 [debug] [MainThread]: Parsing macros/materializations/seed.sql
18:04:17.863408 [debug] [MainThread]: Parsing macros/materializations/test.sql
18:04:17.864639 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
18:04:17.890692 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
18:04:17.893346 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
18:04:17.894925 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
18:04:17.896558 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
18:04:17.898053 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
18:04:17.898800 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
18:04:17.899588 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
18:04:17.900400 [debug] [MainThread]: Parsing macros/etc/datetime.sql
18:04:17.908801 [debug] [MainThread]: Parsing macros/etc/statement.sql
18:04:17.913413 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
18:04:17.917901 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
18:04:17.920849 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
18:04:17.927997 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
18:04:17.930772 [debug] [MainThread]: Parsing macros/adapters/columns.sql
18:04:17.939980 [debug] [MainThread]: Parsing macros/adapters/relation.sql
18:04:17.949539 [debug] [MainThread]: Parsing macros/adapters/schema.sql
18:04:17.951800 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
18:04:17.955654 [debug] [MainThread]: Parsing macros/materializations/configs.sql
18:04:17.957991 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
18:04:17.973750 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
18:04:17.979787 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
18:04:17.981259 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
18:04:17.988212 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
18:04:17.991003 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
18:04:17.993373 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
18:04:17.996217 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
18:04:18.003709 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
18:04:18.005331 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
18:04:18.015247 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
18:04:18.030376 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
18:04:18.045057 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
18:04:18.049563 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
18:04:18.061691 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
18:04:18.072196 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
18:04:18.073996 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
18:04:18.089653 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
18:04:18.091609 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
18:04:18.095952 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
18:04:18.097838 [debug] [MainThread]: Parsing tests/generic/builtin.sql
18:04:18.100735 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
18:04:18.103855 [debug] [MainThread]: Parsing macros/generate_source.sql
18:04:18.110814 [debug] [MainThread]: Parsing macros/generate_base_model.sql
18:04:18.113996 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
18:04:18.115492 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
18:04:18.116964 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
18:04:18.122741 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
18:04:18.126173 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
18:04:18.135886 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
18:04:18.140889 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
18:04:18.142211 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
18:04:18.143832 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
18:04:18.145261 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
18:04:18.146357 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
18:04:18.147880 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
18:04:18.149803 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
18:04:18.151876 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
18:04:18.153451 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
18:04:18.154444 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
18:04:18.155554 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
18:04:18.156547 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
18:04:18.159707 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
18:04:18.161194 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
18:04:18.163894 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
18:04:18.164803 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
18:04:18.166926 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
18:04:18.172469 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
18:04:18.173799 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
18:04:18.182071 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
18:04:18.183958 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
18:04:18.185199 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
18:04:18.186630 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
18:04:18.187845 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
18:04:18.190577 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
18:04:18.192684 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
18:04:18.195077 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
18:04:18.199028 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
18:04:18.200998 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
18:04:18.202651 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
18:04:18.204679 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
18:04:18.206284 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
18:04:18.214995 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
18:04:18.217254 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
18:04:18.218689 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
18:04:18.221405 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
18:04:18.223113 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
18:04:18.224789 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
18:04:18.226005 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
18:04:18.227174 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
18:04:18.228211 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
18:04:18.229341 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
18:04:18.231579 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
18:04:18.233092 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
18:04:18.240993 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
18:04:18.246454 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
18:04:18.253232 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
18:04:18.255005 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
18:04:18.258349 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
18:04:18.259927 [debug] [MainThread]: Parsing macros/sql/pivot.sql
18:04:18.263925 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
18:04:18.269583 [debug] [MainThread]: Parsing macros/sql/groupby.sql
18:04:18.271045 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
18:04:18.277046 [debug] [MainThread]: Parsing macros/sql/star.sql
18:04:18.280317 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
18:04:18.283570 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
18:04:18.286232 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
18:04:18.290497 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
18:04:18.292120 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
18:04:18.296109 [debug] [MainThread]: Parsing macros/sql/union.sql
18:04:18.306080 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
18:04:18.309340 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
18:04:18.311019 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
18:04:18.334241 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
18:04:18.336466 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
18:04:18.338084 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
18:04:18.705071 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
18:04:18.759435 [info ] [MainThread]: Macro is OK
18:04:18.759863 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
18:04:18.873611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7940a1b8-8a41-4da7-b70e-cf5a900661aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb3cd92b0>]}
18:04:18.881488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7940a1b8-8a41-4da7-b70e-cf5a900661aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb3e180d0>]}
18:04:18.882168 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
18:04:18.883856 [debug] [MainThread]: Opening a new connection, currently in state init
18:04:18.902194 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
18:04:18.906147 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
18:04:18.906376 [debug] [MainThread]: On macro_init_s3_sources: Close
18:04:18.906627 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
18:04:18.906740 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
18:04:18.907111 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
18:04:18.907399 [debug] [MainThread]: 
18:04:18.907704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb3ec8370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb3ec8490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2cb3ec8f40>]}
18:04:19.386849 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 06:25:52.644970 | ebc3606f-9e8e-47af-a38d-b477ac44786e ==============================
06:25:52.644985 [info ] [MainThread]: Running with dbt=1.1.0
06:25:52.667791 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': True, 'which': 'debug', 'indirect_selection': 'eager'}
06:25:52.667955 [debug] [MainThread]: Tracking: tracking
06:25:52.677115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87dde0beb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87dde0bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87dde0be20>]}
06:25:52.677517 [info ] [MainThread]: To view your profiles.yml file, run:

xdg-open /home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2
06:25:52.677837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87dde0bdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87dde0be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87dde0bd90>]}


============================== 2022-06-10 06:26:01.596399 | 1cb78b47-d9db-4141-b087-d1b153a83756 ==============================
06:26:01.596419 [info ] [MainThread]: Running with dbt=1.1.0
06:26:01.596950 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
06:26:01.597108 [debug] [MainThread]: Tracking: tracking
06:26:01.606493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f426fc5f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f426fc5f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f426fc5f8b0>]}
06:26:01.606959 [info ] [MainThread]: Start parsing.
06:26:01.655537 [info ] [MainThread]: Dependencies loaded
06:26:01.688103 [info ] [MainThread]: Unable to do partial parsing because profile has changed
06:26:01.688490 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
06:26:01.688768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1cb78b47-d9db-4141-b087-d1b153a83756', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f426fc0ab20>]}
06:26:01.689501 [info ] [MainThread]: ManifestLoader created
06:26:02.387552 [debug] [MainThread]: Parsing macros/init_s3_source.sql
06:26:02.394120 [debug] [MainThread]: Parsing macros/catalog.sql
06:26:02.395616 [debug] [MainThread]: Parsing macros/adapters.sql
06:26:02.429668 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
06:26:02.430702 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
06:26:02.456209 [debug] [MainThread]: Parsing macros/materializations/seed.sql
06:26:02.460071 [debug] [MainThread]: Parsing macros/materializations/test.sql
06:26:02.461295 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
06:26:02.487475 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
06:26:02.489940 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
06:26:02.491382 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
06:26:02.492931 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
06:26:02.494293 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
06:26:02.494969 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
06:26:02.495751 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
06:26:02.496623 [debug] [MainThread]: Parsing macros/etc/datetime.sql
06:26:02.504784 [debug] [MainThread]: Parsing macros/etc/statement.sql
06:26:02.509199 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
06:26:02.513237 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
06:26:02.515950 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
06:26:02.522968 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
06:26:02.525553 [debug] [MainThread]: Parsing macros/adapters/columns.sql
06:26:02.534504 [debug] [MainThread]: Parsing macros/adapters/relation.sql
06:26:02.543735 [debug] [MainThread]: Parsing macros/adapters/schema.sql
06:26:02.545872 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
06:26:02.549657 [debug] [MainThread]: Parsing macros/materializations/configs.sql
06:26:02.552012 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
06:26:02.568441 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
06:26:02.574584 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
06:26:02.575926 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
06:26:02.582764 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
06:26:02.585369 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
06:26:02.587546 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
06:26:02.590315 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
06:26:02.597554 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
06:26:02.598954 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
06:26:02.608971 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
06:26:02.624548 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
06:26:02.638941 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
06:26:02.643317 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
06:26:02.655746 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
06:26:02.666550 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
06:26:02.668239 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
06:26:02.684853 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
06:26:02.686677 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
06:26:02.691774 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
06:26:02.693749 [debug] [MainThread]: Parsing tests/generic/builtin.sql
06:26:02.697025 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
06:26:02.701064 [debug] [MainThread]: Parsing macros/generate_source.sql
06:26:02.708419 [debug] [MainThread]: Parsing macros/generate_base_model.sql
06:26:02.711400 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
06:26:02.712745 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
06:26:02.714167 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
06:26:02.720056 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
06:26:02.723610 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
06:26:02.733096 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
06:26:02.737825 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
06:26:02.738993 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
06:26:02.740474 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
06:26:02.741845 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
06:26:02.742847 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
06:26:02.744284 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
06:26:02.746124 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
06:26:02.748034 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
06:26:02.749594 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
06:26:02.750561 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
06:26:02.751663 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
06:26:02.752744 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
06:26:02.755947 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
06:26:02.757467 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
06:26:02.760212 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
06:26:02.761156 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
06:26:02.763324 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
06:26:02.769050 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
06:26:02.770347 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
06:26:02.778683 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
06:26:02.780367 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
06:26:02.781522 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
06:26:02.782850 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
06:26:02.783997 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
06:26:02.786590 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
06:26:02.788615 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
06:26:02.790865 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
06:26:02.794616 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
06:26:02.796484 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
06:26:02.798027 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
06:26:02.799958 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
06:26:02.801564 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
06:26:02.810191 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
06:26:02.812378 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
06:26:02.813812 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
06:26:02.816654 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
06:26:02.818356 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
06:26:02.820143 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
06:26:02.821387 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
06:26:02.822570 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
06:26:02.823607 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
06:26:02.824751 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
06:26:02.826927 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
06:26:02.828399 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
06:26:02.835844 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
06:26:02.841177 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
06:26:02.848095 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
06:26:02.849865 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
06:26:02.853290 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
06:26:02.854875 [debug] [MainThread]: Parsing macros/sql/pivot.sql
06:26:02.859114 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
06:26:02.864840 [debug] [MainThread]: Parsing macros/sql/groupby.sql
06:26:02.866177 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
06:26:02.872295 [debug] [MainThread]: Parsing macros/sql/star.sql
06:26:02.875588 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
06:26:02.878909 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
06:26:02.881612 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
06:26:02.885914 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
06:26:02.887508 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
06:26:02.891435 [debug] [MainThread]: Parsing macros/sql/union.sql
06:26:02.901525 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
06:26:02.904805 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
06:26:02.906356 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
06:26:02.929906 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
06:26:02.931843 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
06:26:02.933359 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
06:26:03.301280 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
06:26:03.366446 [info ] [MainThread]: Macro is OK
06:26:03.366822 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
06:26:03.464446 [info ] [MainThread]: Manifest loaded
06:26:03.465121 [info ] [MainThread]: Manifest checked
06:26:03.465610 [info ] [MainThread]: Flat graph built
06:26:03.465845 [info ] [MainThread]: Manifest loaded
06:26:03.479676 [info ] [MainThread]: Performance info: target/perf_info.json
06:26:03.480009 [info ] [MainThread]: Done.
06:26:03.480376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f426fb55b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f426fb550a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f426fb55d60>]}


============================== 2022-06-10 06:26:11.129238 | 6bc9bfea-629b-43b7-8d6f-4392042db81f ==============================
06:26:11.129250 [info ] [MainThread]: Running with dbt=1.1.0
06:26:11.129600 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
06:26:11.129768 [debug] [MainThread]: Tracking: tracking
06:26:11.139042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d656dfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d656dee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d656ddc0>]}
06:26:11.200841 [debug] [MainThread]: Executing "git --help"
06:26:11.269343 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
06:26:11.269791 [debug] [MainThread]: STDERR: "b''"
06:26:11.273094 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
06:26:11.273499 [debug] [MainThread]: Opening a new connection, currently in state init
06:26:11.300285 [debug] [MainThread]: clickhouse adapter: On debug: select 1 as id...
06:26:11.303869 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:26:11.304913 [debug] [MainThread]: On debug: Close
06:26:11.305253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d647a7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d644e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07d644e160>]}
06:26:11.819583 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-10 06:26:51.725340 | 03310d34-3d22-4e06-9732-7791904a8b9c ==============================
06:26:51.725359 [info ] [MainThread]: Running with dbt=1.1.0
06:26:51.725870 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
06:26:51.726084 [debug] [MainThread]: Tracking: tracking
06:26:51.735128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc523ffa700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc523ffa880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc523ffa8b0>]}
06:26:51.785767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
06:26:51.786018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
06:26:51.792013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '03310d34-3d22-4e06-9732-7791904a8b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc523e3ae80>]}
06:26:51.799749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '03310d34-3d22-4e06-9732-7791904a8b9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc523ee6af0>]}
06:26:51.800284 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
06:26:51.810606 [debug] [MainThread]: Opening a new connection, currently in state init
06:26:51.829589 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
06:26:51.845311 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
06:26:51.845573 [debug] [MainThread]: On macro_init_s3_sources: Close
06:26:51.845865 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
06:26:51.845976 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
06:26:51.846290 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE TABLE ON default.src_customer. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
06:26:51.846578 [debug] [MainThread]: 
06:26:51.846962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc523dfb100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc523dfb310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc523dfb5b0>]}
06:26:52.353765 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 06:38:44.717959 | 0fbedd67-fe81-447f-b305-bdf554d4c8b2 ==============================
06:38:44.717976 [info ] [MainThread]: Running with dbt=1.1.0
06:38:44.718501 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
06:38:44.718714 [debug] [MainThread]: Tracking: tracking
06:38:44.728065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab8e38610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab8e38790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab8e387c0>]}
06:38:44.728489 [info ] [MainThread]: Start parsing.
06:38:44.752424 [info ] [MainThread]: Dependencies loaded
06:38:44.762772 [info ] [MainThread]: ManifestLoader created
06:38:44.780385 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
06:38:44.780936 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
06:38:44.781120 [debug] [MainThread]: Parsing macros/init_s3_source.sql
06:38:44.798321 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
06:38:44.851405 [info ] [MainThread]: Macro is OK
06:38:44.851752 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
06:38:44.858541 [info ] [MainThread]: Manifest loaded
06:38:44.859065 [info ] [MainThread]: Manifest checked
06:38:44.859416 [info ] [MainThread]: Flat graph built
06:38:44.859650 [info ] [MainThread]: Manifest loaded
06:38:44.860175 [info ] [MainThread]: Performance info: target/perf_info.json
06:38:44.860428 [info ] [MainThread]: Done.
06:38:44.860743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab8be7550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab8be7f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6ab8be7760>]}


============================== 2022-06-10 06:38:50.802031 | 7e56cd08-f758-4664-893e-98d37f68358e ==============================
06:38:50.802048 [info ] [MainThread]: Running with dbt=1.1.0
06:38:50.802562 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
06:38:50.802723 [debug] [MainThread]: Tracking: tracking
06:38:50.811938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4fdde6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4fdde820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4fdde850>]}
06:38:50.861520 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
06:38:50.861752 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
06:38:50.867758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e56cd08-f758-4664-893e-98d37f68358e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4fc22e20>]}
06:38:50.875298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e56cd08-f758-4664-893e-98d37f68358e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4fccda90>]}
06:38:50.875826 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
06:38:50.886965 [debug] [MainThread]: Opening a new connection, currently in state init
06:38:50.908049 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
06:38:50.920152 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:38:50.921533 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
06:38:50.931223 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:38:50.932580 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
06:38:50.941674 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:38:50.942748 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
06:38:50.950470 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:38:50.951515 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

    
  ...
06:38:50.962851 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with 
06:38:50.963021 [debug] [MainThread]: On macro_init_s3_sources: Close
06:38:50.963279 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
06:38:50.963444 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
06:38:50.963768 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
06:38:50.964009 [debug] [MainThread]: 
06:38:50.964338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4fb83610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4fb836a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcd4fb83700>]}
06:38:51.449337 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 06:42:04.155378 | 78cd198f-7834-4ba3-a3a9-9a11998cd6ef ==============================
06:42:04.155396 [info ] [MainThread]: Running with dbt=1.1.0
06:42:04.155922 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
06:42:04.156130 [debug] [MainThread]: Tracking: tracking
06:42:04.165289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9599c066d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9599c06850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9599c06880>]}
06:42:04.216091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
06:42:04.216703 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
06:42:04.216928 [debug] [MainThread]: Parsing macros/init_s3_source.sql
06:42:04.237457 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
06:42:04.290087 [info ] [MainThread]: Macro is OK
06:42:04.290482 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
06:42:04.302336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78cd198f-7834-4ba3-a3a9-9a11998cd6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95999cc250>]}
06:42:04.310042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78cd198f-7834-4ba3-a3a9-9a11998cd6ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9599a0bdf0>]}
06:42:04.310559 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
06:42:04.312092 [debug] [MainThread]: Opening a new connection, currently in state init
06:42:04.331156 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
06:42:04.334351 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:42:04.335706 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
06:42:04.338072 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:42:04.339169 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
06:42:04.341659 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:42:04.342660 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
06:42:04.344888 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:42:04.346154 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

    
  ...
06:42:04.348890 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with 
06:42:04.349098 [debug] [MainThread]: On macro_init_s3_sources: Close
06:42:04.349351 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
06:42:04.349461 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
06:42:04.349747 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
06:42:04.350010 [debug] [MainThread]: 
06:42:04.350333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959994ee20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959994edf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f959994ed00>]}
06:42:04.871994 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 06:42:25.132109 | 63f7d15d-1872-41f3-9fa2-becc9da664d6 ==============================
06:42:25.132126 [info ] [MainThread]: Running with dbt=1.1.0
06:42:25.132622 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
06:42:25.132846 [debug] [MainThread]: Tracking: tracking
06:42:25.141698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517d08700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517d08880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517d088b0>]}
06:42:25.191313 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
06:42:25.191838 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
06:42:25.192037 [debug] [MainThread]: Parsing macros/init_s3_source.sql
06:42:25.208959 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
06:42:25.261651 [info ] [MainThread]: Macro is OK
06:42:25.262045 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
06:42:25.273069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63f7d15d-1872-41f3-9fa2-becc9da664d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517ad3490>]}
06:42:25.280507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '63f7d15d-1872-41f3-9fa2-becc9da664d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517b16fa0>]}
06:42:25.281050 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
06:42:25.282474 [debug] [MainThread]: Opening a new connection, currently in state init
06:42:25.300202 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
06:42:25.302645 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:42:25.303889 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
06:42:25.306334 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:42:25.307386 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
06:42:25.309708 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:42:25.310738 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
06:42:25.312893 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:42:25.314137 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

    
  ...
06:42:25.316628 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with 
06:42:25.316820 [debug] [MainThread]: On macro_init_s3_sources: Close
06:42:25.317086 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
06:42:25.317209 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
06:42:25.317527 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
06:42:25.317804 [debug] [MainThread]: 
06:42:25.318121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517a57d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517a57df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe517a57d60>]}
06:42:25.797250 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 06:43:38.415574 | 4879c342-8d71-4c0b-8246-7091a329e492 ==============================
06:43:38.415592 [info ] [MainThread]: Running with dbt=1.1.0
06:43:38.416081 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
06:43:38.416295 [debug] [MainThread]: Tracking: tracking
06:43:38.425686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1c76b670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1c76b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1c76b820>]}
06:43:38.475914 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
06:43:38.476566 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
06:43:38.476852 [debug] [MainThread]: Parsing macros/init_s3_source.sql
06:43:38.489719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1c5e77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1c594b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac1c594bb0>]}


============================== 2022-06-10 06:43:57.042085 | 4c5ad601-395f-468e-97dc-785b17152d9f ==============================
06:43:57.042102 [info ] [MainThread]: Running with dbt=1.1.0
06:43:57.042578 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
06:43:57.042802 [debug] [MainThread]: Tracking: tracking
06:43:57.051978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc135cc66a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc135cc6820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc135cc6850>]}
06:43:57.102946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
06:43:57.103495 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
06:43:57.103706 [debug] [MainThread]: Parsing macros/init_s3_source.sql
06:43:57.121462 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
06:43:57.168656 [info ] [MainThread]: Schema is: homework_db
06:43:57.175433 [info ] [MainThread]: Macro is OK
06:43:57.175790 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
06:43:57.186210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c5ad601-395f-468e-97dc-785b17152d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc135a8f4f0>]}
06:43:57.193785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c5ad601-395f-468e-97dc-785b17152d9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc135a77dc0>]}
06:43:57.194301 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
06:43:57.195678 [info ] [MainThread]: Schema is: homework_db
06:43:57.196236 [debug] [MainThread]: Opening a new connection, currently in state init
06:43:57.215426 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
06:43:57.217864 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:43:57.219119 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
06:43:57.221931 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:43:57.222947 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
06:43:57.225220 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:43:57.226215 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
06:43:57.228451 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:43:57.229769 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

    
  ...
06:43:57.232333 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with 
06:43:57.232536 [debug] [MainThread]: On macro_init_s3_sources: Close
06:43:57.232836 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
06:43:57.232956 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
06:43:57.233206 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
06:43:57.233430 [debug] [MainThread]: 
06:43:57.233759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc135a12ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc135a12eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc135a12f70>]}
06:43:57.721343 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 06:53:48.290756 | 727e11a1-0dec-4c78-8f5a-f0a4f691406d ==============================
06:53:48.290774 [info ] [MainThread]: Running with dbt=1.1.0
06:53:48.291253 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
06:53:48.291462 [debug] [MainThread]: Tracking: tracking
06:53:48.300339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7900c760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7900c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b7900c910>]}
06:53:48.350191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
06:53:48.350745 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
06:53:48.350948 [debug] [MainThread]: Parsing macros/init_s3_source.sql
06:53:48.369033 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
06:53:48.417524 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTShomework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
06:53:48.423943 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTShomework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
06:53:48.424498 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTShomework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
06:53:48.425036 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTShomework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
06:53:48.425435 [info ] [MainThread]: Query is: 

    
06:53:48.425885 [info ] [MainThread]: Macro is OK
06:53:48.426119 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
06:53:48.438338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '727e11a1-0dec-4c78-8f5a-f0a4f691406d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b78dca730>]}
06:53:48.445980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '727e11a1-0dec-4c78-8f5a-f0a4f691406d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b78db3850>]}
06:53:48.446481 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
06:53:48.447801 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTShomework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
06:53:48.448272 [debug] [MainThread]: Opening a new connection, currently in state init
06:53:48.467396 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTShomework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
06:53:48.470229 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 188 ('EXISTShomework_db') (line 5, col 29): EXISTShomework_db.src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n           
06:53:48.470448 [debug] [MainThread]: On macro_init_s3_sources: Close
06:53:48.470726 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
06:53:48.470837 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
06:53:48.471155 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 188 ('EXISTShomework_db') (line 5, col 29): EXISTShomework_db.src_customer\n        (\n                C_CUSTKEY       UInt32,\n                C_NAME          String,\n
06:53:48.471417 [debug] [MainThread]: 
06:53:48.471749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b78d4c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b78d4c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b78d4c1f0>]}
06:53:48.962198 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 07:05:06.654196 | f406712b-fc66-4cde-9746-ab22390f9e45 ==============================
07:05:06.654214 [info ] [MainThread]: Running with dbt=1.1.0
07:05:06.654717 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
07:05:06.654930 [debug] [MainThread]: Tracking: tracking
07:05:06.664328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ddbb6670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ddbb67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75ddbb6820>]}
07:05:06.715768 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:05:06.716352 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
07:05:06.716610 [debug] [MainThread]: Parsing macros/init_s3_source.sql
07:05:06.719171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75dda317f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75dd9dd940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f75dd9dd9a0>]}


============================== 2022-06-10 07:05:35.079934 | 345e52b6-833c-498f-b827-03225fcc3fdc ==============================
07:05:35.079951 [info ] [MainThread]: Running with dbt=1.1.0
07:05:35.080502 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
07:05:35.080744 [debug] [MainThread]: Tracking: tracking
07:05:35.090114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf88b9760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf88b98e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf88b9910>]}
07:05:35.141429 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:05:35.141989 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
07:05:35.142191 [debug] [MainThread]: Parsing macros/init_s3_source.sql
07:05:35.146258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf87378e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf86e3c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3cf86e3cd0>]}


============================== 2022-06-10 07:07:19.657308 | d204f2ef-afc3-4c2f-9198-5672f80e61f3 ==============================
07:07:19.657326 [info ] [MainThread]: Running with dbt=1.1.0
07:07:19.657816 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
07:07:19.658031 [debug] [MainThread]: Tracking: tracking
07:07:19.667534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0116a495b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0116a49730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0116a49760>]}
07:07:19.718482 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:07:19.719040 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
07:07:19.719252 [debug] [MainThread]: Parsing macros/init_s3_source.sql
07:07:19.737737 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
07:07:19.785680 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
07:07:19.791783 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
07:07:19.792281 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
07:07:19.792788 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
07:07:19.793179 [info ] [MainThread]: Query is: 

    
07:07:19.793599 [info ] [MainThread]: Macro is OK
07:07:19.793824 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
07:07:19.806506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd204f2ef-afc3-4c2f-9198-5672f80e61f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f011680e580>]}
07:07:19.814488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd204f2ef-afc3-4c2f-9198-5672f80e61f3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0116a206d0>]}
07:07:19.815016 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
07:07:19.816368 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
07:07:19.816884 [debug] [MainThread]: Opening a new connection, currently in state init
07:07:19.836961 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
07:07:19.839517 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:07:19.840692 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
07:07:19.841255 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
07:07:19.843738 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:07:19.844694 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
07:07:19.845217 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
07:07:19.848105 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:07:19.849021 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
07:07:19.849552 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
07:07:19.851874 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:07:19.853029 [info ] [MainThread]: Query is: 

    
07:07:19.853512 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

    
  ...
07:07:19.856350 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with 
07:07:19.856579 [debug] [MainThread]: On macro_init_s3_sources: Close
07:07:19.856863 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
07:07:19.857012 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
07:07:19.857330 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
07:07:19.857661 [debug] [MainThread]: 
07:07:19.858002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0116791c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0116791640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0116791220>]}
07:07:20.372878 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 07:18:40.080001 | f54a1a91-e07f-4ef1-8a1f-9b737193b0da ==============================
07:18:40.080018 [info ] [MainThread]: Running with dbt=1.1.0
07:18:40.080532 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
07:18:40.080717 [debug] [MainThread]: Tracking: tracking
07:18:40.089965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb91de730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb91de790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb91de7c0>]}
07:18:40.139667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:18:40.140143 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
07:18:40.152362 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
07:18:40.186898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb90b0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb8f71100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcfb8f90040>]}


============================== 2022-06-10 07:19:06.070071 | e19cfb35-ed91-4ef5-af04-1cbfe048c70c ==============================
07:19:06.070091 [info ] [MainThread]: Running with dbt=1.1.0
07:19:06.070634 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
07:19:06.070848 [debug] [MainThread]: Tracking: tracking
07:19:06.080156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c49e99820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c49e99880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c49e998b0>]}
07:19:06.131174 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:19:06.131727 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
07:19:06.143871 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
07:19:06.193213 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
07:19:06.199756 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
07:19:06.200287 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
07:19:06.200880 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
07:19:06.201287 [info ] [MainThread]: Query is: 

    
07:19:06.201723 [info ] [MainThread]: Macro is OK
07:19:06.201983 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
07:19:06.212959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e19cfb35-ed91-4ef5-af04-1cbfe048c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c49c595e0>]}
07:19:06.229624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e19cfb35-ed91-4ef5-af04-1cbfe048c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c49c94700>]}
07:19:06.229971 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:19:06.230200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e19cfb35-ed91-4ef5-af04-1cbfe048c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c49d158e0>]}
07:19:06.231612 [info ] [MainThread]: 
07:19:06.232162 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:19:06.233116 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db_homework_db"
07:19:06.239548 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:19:06.263432 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db_homework_db'
  ...
07:19:06.266590 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:19:06.267973 [debug] [ThreadPool]: On list_None_homework_db_homework_db: Close
07:19:06.268524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e19cfb35-ed91-4ef5-af04-1cbfe048c70c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c49c9bac0>]}
07:19:06.269051 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:19:06.269327 [info ] [MainThread]: 
07:19:06.282225 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
07:19:06.282671 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
07:19:06.282933 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
07:19:06.283091 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
07:19:06.301845 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:19:06.310406 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
07:19:06.313935 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:19:06.323636 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
07:19:06.327578 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:19:06.333490 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
07:19:06.337145 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:19:06.342855 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
07:19:06.346705 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:19:06.351182 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
07:19:06.351683 [debug] [Thread-1  ]: finished collecting timing info
07:19:06.351874 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
07:19:06.352030 [debug] [Thread-1  ]: finished collecting timing info
07:19:06.352170 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
07:19:06.352650 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
07:19:06.353636 [debug] [MainThread]: Connection 'master' was properly closed.
07:19:06.353784 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
07:19:06.362404 [info ] [MainThread]: Done.
07:19:06.362755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c49d159a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c482e1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c49bbf430>]}


============================== 2022-06-10 07:20:25.620902 | 023b5cf9-aff1-4bef-8abe-9350f72c82b3 ==============================
07:20:25.620919 [info ] [MainThread]: Running with dbt=1.1.0
07:20:25.621427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:20:25.621575 [debug] [MainThread]: Tracking: tracking
07:20:25.630299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90e477f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90e47850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90e47880>]}
07:20:25.679394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:20:25.679627 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:20:25.685502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '023b5cf9-aff1-4bef-8abe-9350f72c82b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90c80e20>]}
07:20:25.693661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '023b5cf9-aff1-4bef-8abe-9350f72c82b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90c65700>]}
07:20:25.693978 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:20:25.694251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '023b5cf9-aff1-4bef-8abe-9350f72c82b3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90c65a90>]}
07:20:25.695760 [info ] [MainThread]: 
07:20:25.696318 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:20:25.697403 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
07:20:25.709841 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:20:25.728509 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
07:20:25.731204 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:20:25.732387 [debug] [ThreadPool]: On list_schemas: Close
07:20:25.732967 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:20:25.733214 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:20:25.733411 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database=None, schema='homework_db_homework_db', identifier=None)"
07:20:25.740037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:20:25.748057 [debug] [ThreadPool]: clickhouse adapter: On create__homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "create__homework_db_homework_db"} */
create database if not exists homework_db_homework_db 
  
  ...
07:20:25.752194 [debug] [ThreadPool]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE DATABASE ON homework_db_homework_db.*. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
07:20:25.752345 [debug] [ThreadPool]: On create__homework_db_homework_db: Close
07:20:25.752638 [debug] [ThreadPool]: clickhouse adapter: Error running SQL: macro create_schema
07:20:25.752805 [debug] [ThreadPool]: clickhouse adapter: Rolling back transaction.
07:20:25.753496 [debug] [MainThread]: Connection 'master' was properly closed.
07:20:25.753660 [debug] [MainThread]: Connection 'create__homework_db_homework_db' was properly closed.
07:20:25.753881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90c65460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c90c65220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c903ba910>]}


============================== 2022-06-10 07:23:07.549792 | 359dc7ed-44fb-4849-9920-500538d52834 ==============================
07:23:07.549810 [info ] [MainThread]: Running with dbt=1.1.0
07:23:07.550317 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
07:23:07.550517 [debug] [MainThread]: Tracking: tracking
07:23:07.559525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679b84b7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679b84b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679b84b850>]}
07:23:07.609554 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:23:07.609794 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:23:07.615813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '359dc7ed-44fb-4849-9920-500538d52834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679b685df0>]}
07:23:07.623600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '359dc7ed-44fb-4849-9920-500538d52834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679b7316d0>]}
07:23:07.623933 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:23:07.624205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '359dc7ed-44fb-4849-9920-500538d52834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679b731a60>]}
07:23:07.625577 [info ] [MainThread]: 
07:23:07.626091 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:23:07.626883 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db_homework_db"
07:23:07.636292 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:23:07.655054 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db_homework_db'
  ...
07:23:07.658070 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:07.659234 [debug] [ThreadPool]: On list_None_homework_db_homework_db: Close
07:23:07.659736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '359dc7ed-44fb-4849-9920-500538d52834', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679b669fa0>]}
07:23:07.660218 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:23:07.660502 [info ] [MainThread]: 
07:23:07.663519 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
07:23:07.663853 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
07:23:07.664069 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
07:23:07.664232 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
07:23:07.707561 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:23:07.716579 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
07:23:07.720008 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:07.729087 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
07:23:07.732747 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:07.738223 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
07:23:07.741783 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:07.747034 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
07:23:07.750345 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:07.754459 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
07:23:07.754800 [debug] [Thread-1  ]: finished collecting timing info
07:23:07.754994 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
07:23:07.755148 [debug] [Thread-1  ]: finished collecting timing info
07:23:07.755278 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
07:23:07.755704 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
07:23:07.756658 [debug] [MainThread]: Connection 'master' was properly closed.
07:23:07.756810 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
07:23:07.765529 [info ] [MainThread]: Done.
07:23:07.765845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679add1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679ad99a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f679ad99b20>]}


============================== 2022-06-10 07:23:16.671545 | d08f5b71-764e-40c9-8613-7fb42ba6cd11 ==============================
07:23:16.671562 [info ] [MainThread]: Running with dbt=1.1.0
07:23:16.672051 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
07:23:16.672281 [debug] [MainThread]: Tracking: tracking
07:23:16.681830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83615f790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83615f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff83615f820>]}
07:23:16.730368 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:23:16.730807 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
07:23:16.743042 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
07:23:16.789234 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
07:23:16.795579 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
07:23:16.796060 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
07:23:16.796423 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
07:23:16.796796 [info ] [MainThread]: Query is: 

    
07:23:16.797134 [info ] [MainThread]: Macro is OK
07:23:16.797394 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
07:23:16.807888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd08f5b71-764e-40c9-8613-7fb42ba6cd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff835f25550>]}
07:23:16.816245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd08f5b71-764e-40c9-8613-7fb42ba6cd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff835f5e880>]}
07:23:16.816576 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:23:16.816834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd08f5b71-764e-40c9-8613-7fb42ba6cd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff835fe2850>]}
07:23:16.818130 [info ] [MainThread]: 
07:23:16.818594 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:23:16.819315 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db_homework_db"
07:23:16.824477 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:23:16.840252 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db_homework_db'
  ...
07:23:16.843207 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:16.844484 [debug] [ThreadPool]: On list_None_homework_db_homework_db: Close
07:23:16.844961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd08f5b71-764e-40c9-8613-7fb42ba6cd11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff835f66610>]}
07:23:16.845362 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:23:16.845592 [info ] [MainThread]: 
07:23:16.848280 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
07:23:16.848651 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
07:23:16.848882 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
07:23:16.849037 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
07:23:16.867071 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:23:16.874605 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
07:23:16.877892 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:16.887171 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
07:23:16.890733 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:16.896500 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
07:23:16.899986 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:16.905458 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
07:23:16.908827 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:16.913069 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
07:23:16.913417 [debug] [Thread-1  ]: finished collecting timing info
07:23:16.913588 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
07:23:16.913743 [debug] [Thread-1  ]: finished collecting timing info
07:23:16.913881 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
07:23:16.914308 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
07:23:16.915187 [debug] [MainThread]: Connection 'master' was properly closed.
07:23:16.915348 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
07:23:16.922640 [info ] [MainThread]: Done.
07:23:16.923004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff835fe2910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff835647d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff835e7f490>]}


============================== 2022-06-10 07:23:33.747393 | f26d8a7a-03a9-4db3-9b26-6a2b5a5f4b5b ==============================
07:23:33.747412 [info ] [MainThread]: Running with dbt=1.1.0
07:23:33.747907 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:23:33.748119 [debug] [MainThread]: Tracking: tracking
07:23:33.757264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383523820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383523880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe3835238b0>]}
07:23:33.806822 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:23:33.807057 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:23:33.813074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f26d8a7a-03a9-4db3-9b26-6a2b5a5f4b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe38335de50>]}
07:23:33.821320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f26d8a7a-03a9-4db3-9b26-6a2b5a5f4b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383342730>]}
07:23:33.821644 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:23:33.821909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f26d8a7a-03a9-4db3-9b26-6a2b5a5f4b5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383342ac0>]}
07:23:33.823313 [info ] [MainThread]: 
07:23:33.823810 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:23:33.824814 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
07:23:33.834503 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:23:33.859153 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
07:23:33.861637 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:23:33.862893 [debug] [ThreadPool]: On list_schemas: Close
07:23:33.863493 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:23:33.863732 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:23:33.863920 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database=None, schema='homework_db_homework_db', identifier=None)"
07:23:33.870741 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:23:33.878601 [debug] [ThreadPool]: clickhouse adapter: On create__homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "create__homework_db_homework_db"} */
create database if not exists homework_db_homework_db 
  
  ...
07:23:33.881573 [debug] [ThreadPool]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE DATABASE ON homework_db_homework_db.*. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
07:23:33.881718 [debug] [ThreadPool]: On create__homework_db_homework_db: Close
07:23:33.881987 [debug] [ThreadPool]: clickhouse adapter: Error running SQL: macro create_schema
07:23:33.882161 [debug] [ThreadPool]: clickhouse adapter: Rolling back transaction.
07:23:33.882890 [debug] [MainThread]: Connection 'master' was properly closed.
07:23:33.883051 [debug] [MainThread]: Connection 'create__homework_db_homework_db' was properly closed.
07:23:33.883240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383342490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe383342250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe382a949a0>]}


============================== 2022-06-10 07:25:44.227559 | a5cc423a-d670-4a95-ac6d-9d91ecc6a405 ==============================
07:25:44.227577 [info ] [MainThread]: Running with dbt=1.1.0
07:25:44.228076 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:25:44.228282 [debug] [MainThread]: Tracking: tracking
07:25:44.237501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d11807f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d1180850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d1180880>]}
07:25:44.287769 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:25:44.288291 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.customer
07:25:44.288447 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.lineorder
07:25:44.288608 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.part
07:25:44.288738 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.supplier
07:25:44.288897 [debug] [MainThread]: Partial parsing: update schema file: dbt_starschema_2://models/sources.yml
07:25:44.301068 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
07:25:44.347955 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
07:25:44.354126 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
07:25:44.354592 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
07:25:44.355082 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
07:25:44.355489 [info ] [MainThread]: Query is: 

    
07:25:44.355940 [info ] [MainThread]: Macro is OK
07:25:44.356171 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
07:25:44.382891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5cc423a-d670-4a95-ac6d-9d91ecc6a405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d0f567c0>]}
07:25:44.390489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5cc423a-d670-4a95-ac6d-9d91ecc6a405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d1127c40>]}
07:25:44.390785 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:25:44.390997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5cc423a-d670-4a95-ac6d-9d91ecc6a405', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d11272e0>]}
07:25:44.392281 [info ] [MainThread]: 
07:25:44.392818 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:25:44.393697 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
07:25:44.398610 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:25:44.416111 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
07:25:44.418555 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:25:44.419754 [debug] [ThreadPool]: On list_schemas: Close
07:25:44.420349 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:25:44.420611 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:25:44.420821 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database=None, schema='homework_db_homework_db', identifier=None)"
07:25:44.427622 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:25:44.435499 [debug] [ThreadPool]: clickhouse adapter: On create__homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "create__homework_db_homework_db"} */
create database if not exists homework_db_homework_db 
  
  ...
07:25:44.438627 [debug] [ThreadPool]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE DATABASE ON homework_db_homework_db.*. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
07:25:44.438815 [debug] [ThreadPool]: On create__homework_db_homework_db: Close
07:25:44.439065 [debug] [ThreadPool]: clickhouse adapter: Error running SQL: macro create_schema
07:25:44.439166 [debug] [ThreadPool]: clickhouse adapter: Rolling back transaction.
07:25:44.439837 [debug] [MainThread]: Connection 'master' was properly closed.
07:25:44.439988 [debug] [MainThread]: Connection 'create__homework_db_homework_db' was properly closed.
07:25:44.440189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d11274c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d11272e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f92d0edb670>]}


============================== 2022-06-10 07:47:53.335322 | 58ed87ec-f549-4deb-a5d4-fdc0d5d6b965 ==============================
07:47:53.335339 [info ] [MainThread]: Running with dbt=1.1.0
07:47:53.335846 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
07:47:53.335996 [debug] [MainThread]: Tracking: tracking
07:47:53.345115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4795536790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47955367f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4795536820>]}
07:47:53.396015 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:47:53.396627 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.customer
07:47:53.396781 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.lineorder
07:47:53.396913 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.part
07:47:53.397031 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.supplier
07:47:53.397193 [debug] [MainThread]: Partial parsing: update schema file: dbt_starschema_2://models/sources.yml
07:47:53.409984 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
07:47:53.458680 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
07:47:53.464859 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
07:47:53.465312 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
07:47:53.465685 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
07:47:53.466027 [info ] [MainThread]: Query is: 

    
07:47:53.466350 [info ] [MainThread]: Macro is OK
07:47:53.466595 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
07:47:53.494719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58ed87ec-f549-4deb-a5d4-fdc0d5d6b965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47952fb820>]}
07:47:53.503165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58ed87ec-f549-4deb-a5d4-fdc0d5d6b965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47954e07f0>]}
07:47:53.503494 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:47:53.503758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ed87ec-f549-4deb-a5d4-fdc0d5d6b965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47954e0ee0>]}
07:47:53.505208 [info ] [MainThread]: 
07:47:53.505760 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:47:53.506500 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db_homework_db"
07:47:53.511826 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:47:53.531897 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db_homework_db'
  ...
07:47:53.535155 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:47:53.536385 [debug] [ThreadPool]: On list_None_homework_db_homework_db: Close
07:47:53.536930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ed87ec-f549-4deb-a5d4-fdc0d5d6b965', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4795358e80>]}
07:47:53.537380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:47:53.537638 [info ] [MainThread]: 
07:47:53.540819 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
07:47:53.541177 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
07:47:53.541415 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
07:47:53.541570 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
07:47:53.560104 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:47:53.568892 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
07:47:53.572285 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:47:53.581090 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
07:47:53.584399 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:47:53.590370 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
07:47:53.593913 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:47:53.599541 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
07:47:53.603513 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:47:53.607801 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
07:47:53.608162 [debug] [Thread-1  ]: finished collecting timing info
07:47:53.608364 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
07:47:53.608522 [debug] [Thread-1  ]: finished collecting timing info
07:47:53.608669 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
07:47:53.609114 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
07:47:53.610027 [debug] [MainThread]: Connection 'master' was properly closed.
07:47:53.610186 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
07:47:53.618940 [info ] [MainThread]: Done.
07:47:53.619340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4794184eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47941840d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47941843d0>]}


============================== 2022-06-10 07:47:59.225247 | 390bc03f-074a-42a2-986f-84eb87eb1261 ==============================
07:47:59.225265 [info ] [MainThread]: Running with dbt=1.1.0
07:47:59.225788 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:47:59.225944 [debug] [MainThread]: Tracking: tracking
07:47:59.235260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12ba6790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12ba67f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff12ba6820>]}
07:47:59.285403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:47:59.285640 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:47:59.292053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '390bc03f-074a-42a2-986f-84eb87eb1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff129dfe20>]}
07:47:59.300389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '390bc03f-074a-42a2-986f-84eb87eb1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff129c4700>]}
07:47:59.300774 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:47:59.301033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '390bc03f-074a-42a2-986f-84eb87eb1261', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff129c4a90>]}
07:47:59.302537 [info ] [MainThread]: 
07:47:59.303197 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:47:59.304206 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
07:47:59.313895 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:47:59.331382 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
07:47:59.333992 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:47:59.335264 [debug] [ThreadPool]: On list_schemas: Close
07:47:59.335911 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:47:59.336177 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:47:59.336381 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database=None, schema='homework_db_homework_db', identifier=None)"
07:47:59.343320 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:47:59.352165 [debug] [ThreadPool]: clickhouse adapter: On create__homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "create__homework_db_homework_db"} */
create database if not exists homework_db_homework_db 
  
  ...
07:47:59.355257 [debug] [ThreadPool]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE DATABASE ON homework_db_homework_db.*. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
07:47:59.355463 [debug] [ThreadPool]: On create__homework_db_homework_db: Close
07:47:59.355723 [debug] [ThreadPool]: clickhouse adapter: Error running SQL: macro create_schema
07:47:59.355830 [debug] [ThreadPool]: clickhouse adapter: Rolling back transaction.
07:47:59.356599 [debug] [MainThread]: Connection 'master' was properly closed.
07:47:59.356759 [debug] [MainThread]: Connection 'create__homework_db_homework_db' was properly closed.
07:47:59.357019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff129c4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff129c4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff1211b8b0>]}


============================== 2022-06-10 07:50:02.462579 | 8cd1b82e-0eff-4de8-b85a-f6c40c422103 ==============================
07:50:02.462600 [info ] [MainThread]: Running with dbt=1.1.0
07:50:02.463143 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
07:50:02.463359 [debug] [MainThread]: Tracking: tracking
07:50:02.472597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36b37ab850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36b37ab8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36b37ab8e0>]}
07:50:02.524747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
07:50:02.525420 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.customer
07:50:02.525571 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.lineorder
07:50:02.525699 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.part
07:50:02.525831 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.supplier
07:50:02.525980 [debug] [MainThread]: Partial parsing: update schema file: dbt_starschema_2://models/sources.yml
07:50:02.538528 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
07:50:02.587173 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
07:50:02.593744 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
07:50:02.594273 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
07:50:02.594801 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
07:50:02.595243 [info ] [MainThread]: Query is: 

    
07:50:02.595663 [info ] [MainThread]: Macro is OK
07:50:02.595916 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
07:50:02.624273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cd1b82e-0eff-4de8-b85a-f6c40c422103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36b356c8e0>]}
07:50:02.632086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cd1b82e-0eff-4de8-b85a-f6c40c422103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36b36a8cd0>]}
07:50:02.632424 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:50:02.632683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cd1b82e-0eff-4de8-b85a-f6c40c422103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36b377eb50>]}
07:50:02.634049 [info ] [MainThread]: 
07:50:02.634564 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:50:02.635569 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
07:50:02.640597 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:50:02.660879 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
07:50:02.664096 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:50:02.665449 [debug] [ThreadPool]: On list_schemas: Close
07:50:02.666110 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:50:02.666537 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
07:50:02.666738 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database=None, schema='homework_db_homework_db', identifier=None)"
07:50:02.673534 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:50:02.681734 [debug] [ThreadPool]: clickhouse adapter: On create__homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "create__homework_db_homework_db"} */
create database if not exists homework_db_homework_db 
  
  ...
07:50:02.684929 [debug] [ThreadPool]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE DATABASE ON homework_db_homework_db.*. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
07:50:02.685071 [debug] [ThreadPool]: On create__homework_db_homework_db: Close
07:50:02.685328 [debug] [ThreadPool]: clickhouse adapter: Error running SQL: macro create_schema
07:50:02.685439 [debug] [ThreadPool]: clickhouse adapter: Rolling back transaction.
07:50:02.686155 [debug] [MainThread]: Connection 'master' was properly closed.
07:50:02.686316 [debug] [MainThread]: Connection 'create__homework_db_homework_db' was properly closed.
07:50:02.686508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36b36a8970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36b36a8a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f36b356ca30>]}


============================== 2022-06-10 07:51:02.230847 | f6aabd86-da21-412b-9bad-462c78fce67d ==============================
07:51:02.230865 [info ] [MainThread]: Running with dbt=1.1.0
07:51:02.231421 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
07:51:02.231632 [debug] [MainThread]: Tracking: tracking
07:51:02.240918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94e0dd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94e0dd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94e0dd8e0>]}
07:51:02.291387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
07:51:02.291638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
07:51:02.297783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6aabd86-da21-412b-9bad-462c78fce67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94df17ee0>]}
07:51:02.306316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6aabd86-da21-412b-9bad-462c78fce67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94defc7c0>]}
07:51:02.306668 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:51:02.306948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6aabd86-da21-412b-9bad-462c78fce67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94defcb50>]}
07:51:02.308403 [info ] [MainThread]: 
07:51:02.309011 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:51:02.309893 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db_homework_db"
07:51:02.320038 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:51:02.338317 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db_homework_db'
  ...
07:51:02.341694 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:51:02.342993 [debug] [ThreadPool]: On list_None_homework_db_homework_db: Close
07:51:02.343583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6aabd86-da21-412b-9bad-462c78fce67d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94dfda4f0>]}
07:51:02.344060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:51:02.344328 [info ] [MainThread]: 
07:51:02.347638 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
07:51:02.347980 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
07:51:02.348172 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
07:51:02.348301 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
07:51:02.392190 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:51:02.401045 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
07:51:02.404602 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:51:02.412577 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
07:51:02.415925 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:51:02.420960 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
07:51:02.424359 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:51:02.429158 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
07:51:02.432682 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:51:02.435958 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
07:51:02.436285 [debug] [Thread-1  ]: finished collecting timing info
07:51:02.436434 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
07:51:02.436585 [debug] [Thread-1  ]: finished collecting timing info
07:51:02.436707 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
07:51:02.437152 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
07:51:02.438172 [debug] [MainThread]: Connection 'master' was properly closed.
07:51:02.438330 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
07:51:02.446032 [info ] [MainThread]: Done.
07:51:02.446400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94d62bb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94d62ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94d62ba00>]}


============================== 2022-06-10 08:04:56.363622 | 46543827-6b58-4330-8189-c5ccace00ad6 ==============================
08:04:56.363641 [info ] [MainThread]: Running with dbt=1.1.0
08:04:56.364156 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:04:56.364363 [debug] [MainThread]: Tracking: tracking
08:04:56.373717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e543c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e543c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e543c7c0>]}
08:04:56.407059 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
08:04:56.407441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '46543827-6b58-4330-8189-c5ccace00ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e53dbb80>]}
08:04:56.424852 [debug] [MainThread]: Parsing macros/init_s3_source.sql
08:04:56.428928 [debug] [MainThread]: Parsing macros/catalog.sql
08:04:56.430436 [debug] [MainThread]: Parsing macros/adapters.sql
08:04:56.465467 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
08:04:56.466478 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
08:04:56.492034 [debug] [MainThread]: Parsing macros/materializations/seed.sql
08:04:56.495815 [debug] [MainThread]: Parsing macros/materializations/test.sql
08:04:56.497030 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
08:04:56.523705 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:04:56.526261 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:04:56.527739 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:04:56.529277 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:04:56.530625 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:04:56.531308 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:04:56.532091 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:04:56.532921 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:04:56.541207 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:04:56.545587 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:04:56.549875 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:04:56.552713 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:04:56.559688 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:04:56.562188 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:04:56.571570 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:04:56.580575 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:04:56.582578 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:04:56.586074 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:04:56.588193 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:04:56.604060 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:04:56.610024 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:04:56.611345 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:04:56.618242 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:04:56.620916 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:04:56.623165 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:04:56.625955 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:04:56.633514 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:04:56.635067 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:04:56.644998 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:04:56.660915 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:04:56.675934 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:04:56.680353 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:04:56.692842 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:04:56.703525 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:04:56.705237 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:04:56.721496 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:04:56.723314 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:04:56.727725 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:04:56.729550 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:04:56.732571 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
08:04:56.735746 [debug] [MainThread]: Parsing macros/generate_source.sql
08:04:56.742576 [debug] [MainThread]: Parsing macros/generate_base_model.sql
08:04:56.745494 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
08:04:56.746723 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
08:04:56.748099 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
08:04:56.753729 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
08:04:56.756975 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
08:04:56.766529 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
08:04:56.771439 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
08:04:56.772689 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
08:04:56.774219 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
08:04:56.775545 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
08:04:56.776512 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
08:04:56.777921 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
08:04:56.779671 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
08:04:56.781517 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
08:04:56.782952 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
08:04:56.783847 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
08:04:56.784892 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
08:04:56.785846 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
08:04:56.788855 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
08:04:56.790302 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
08:04:56.792880 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
08:04:56.793749 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
08:04:56.795689 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
08:04:56.800871 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
08:04:56.802035 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
08:04:56.810316 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
08:04:56.812158 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
08:04:56.813391 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
08:04:56.814798 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
08:04:56.816045 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
08:04:56.818844 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
08:04:56.821011 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
08:04:56.823446 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
08:04:56.827444 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
08:04:56.829455 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
08:04:56.831073 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
08:04:56.833188 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
08:04:56.834815 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
08:04:56.843458 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
08:04:56.845575 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
08:04:56.846952 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
08:04:56.849674 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
08:04:56.851330 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
08:04:56.853117 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
08:04:56.854378 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
08:04:56.855588 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
08:04:56.856684 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
08:04:56.857803 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
08:04:56.860024 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
08:04:56.861576 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
08:04:56.869167 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
08:04:56.874672 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
08:04:56.881549 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
08:04:56.883196 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
08:04:56.886617 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
08:04:56.888214 [debug] [MainThread]: Parsing macros/sql/pivot.sql
08:04:56.892287 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
08:04:56.897766 [debug] [MainThread]: Parsing macros/sql/groupby.sql
08:04:56.899042 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
08:04:56.904822 [debug] [MainThread]: Parsing macros/sql/star.sql
08:04:56.907997 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
08:04:56.911322 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
08:04:56.914056 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
08:04:56.918413 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
08:04:56.920074 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
08:04:56.924147 [debug] [MainThread]: Parsing macros/sql/union.sql
08:04:56.934737 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
08:04:56.938137 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
08:04:56.939805 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
08:04:56.963190 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
08:04:56.965225 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
08:04:56.966771 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
08:04:57.329596 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
08:04:57.376685 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:04:57.382712 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:04:57.383248 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:04:57.383788 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:04:57.384193 [info ] [MainThread]: Query is: 

    
08:04:57.384642 [info ] [MainThread]: Macro is OK
08:04:57.384970 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
08:04:57.480482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46543827-6b58-4330-8189-c5ccace00ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e53bb670>]}
08:04:57.487781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46543827-6b58-4330-8189-c5ccace00ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e5464c70>]}
08:04:57.488100 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:04:57.488339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46543827-6b58-4330-8189-c5ccace00ad6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e54662e0>]}
08:04:57.489582 [info ] [MainThread]: 
08:04:57.490064 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:04:57.490955 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
08:04:57.495819 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:04:57.515464 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
08:04:57.518255 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:04:57.519457 [debug] [ThreadPool]: On list_schemas: Close
08:04:57.520076 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
08:04:57.520568 [debug] [ThreadPool]: Acquiring new clickhouse connection "create__homework_db_homework_db"
08:04:57.520791 [debug] [ThreadPool]: Creating schema "_ReferenceKey(database=None, schema='homework_db_homework_db', identifier=None)"
08:04:57.527267 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:04:57.535792 [debug] [ThreadPool]: clickhouse adapter: On create__homework_db_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "create__homework_db_homework_db"} */
create database if not exists homework_db_homework_db 
  
  ...
08:04:57.538957 [debug] [ThreadPool]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b"Code: 497. DB::Exception: dis: Not enough privileges. To execute this query it's necessary to have grant CREATE DATABASE ON homework_db_homework_db.*. (ACCESS_DENIED) (version 22.3.6.5 (official build))\n"
08:04:57.539113 [debug] [ThreadPool]: On create__homework_db_homework_db: Close
08:04:57.539345 [debug] [ThreadPool]: clickhouse adapter: Error running SQL: macro create_schema
08:04:57.539449 [debug] [ThreadPool]: clickhouse adapter: Rolling back transaction.
08:04:57.540206 [debug] [MainThread]: Connection 'master' was properly closed.
08:04:57.540383 [debug] [MainThread]: Connection 'create__homework_db_homework_db' was properly closed.
08:04:57.540682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e53bbee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e53bbe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39e53df370>]}


============================== 2022-06-10 08:11:04.606402 | ca541a0b-c217-4b2c-a16a-5fd42e9d7995 ==============================
08:11:04.606420 [info ] [MainThread]: Running with dbt=1.1.0
08:11:04.607008 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
08:11:04.607173 [debug] [MainThread]: Tracking: tracking
08:11:04.616402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd0d82790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd0d82910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd0d82940>]}
08:11:04.650164 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
08:11:04.650569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ca541a0b-c217-4b2c-a16a-5fd42e9d7995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd0d2ea90>]}
08:11:04.667893 [debug] [MainThread]: Parsing macros/init_s3_source.sql
08:11:04.672002 [debug] [MainThread]: Parsing macros/catalog.sql
08:11:04.673603 [debug] [MainThread]: Parsing macros/adapters.sql
08:11:04.708167 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
08:11:04.709229 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
08:11:04.733836 [debug] [MainThread]: Parsing macros/materializations/seed.sql
08:11:04.737404 [debug] [MainThread]: Parsing macros/materializations/test.sql
08:11:04.738548 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
08:11:04.764424 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:11:04.766949 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:11:04.768600 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:11:04.770141 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:11:04.771481 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:11:04.772195 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:11:04.773025 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:11:04.773862 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:11:04.781914 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:11:04.786326 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:11:04.790625 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:11:04.793526 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:11:04.800630 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:11:04.803324 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:11:04.812747 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:11:04.822171 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:11:04.824397 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:11:04.828214 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:11:04.830507 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:11:04.846684 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:11:04.852799 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:11:04.854206 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:11:04.860799 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:11:04.863343 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:11:04.865558 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:11:04.868343 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:11:04.875792 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:11:04.877405 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:11:04.888185 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:11:04.904036 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:11:04.918853 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:11:04.923313 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:11:04.935144 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:11:04.945158 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:11:04.946887 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:11:04.962423 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:11:04.964202 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:11:04.968603 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:11:04.970498 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:11:04.973478 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
08:11:04.976539 [debug] [MainThread]: Parsing macros/generate_source.sql
08:11:04.983348 [debug] [MainThread]: Parsing macros/generate_base_model.sql
08:11:04.986345 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
08:11:04.987677 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
08:11:04.989179 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
08:11:04.995101 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
08:11:04.998661 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
08:11:05.008920 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
08:11:05.014017 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
08:11:05.015372 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
08:11:05.017039 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
08:11:05.018486 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
08:11:05.019564 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
08:11:05.021136 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
08:11:05.023071 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
08:11:05.025180 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
08:11:05.026728 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
08:11:05.027747 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
08:11:05.028879 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
08:11:05.029920 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
08:11:05.033100 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
08:11:05.034653 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
08:11:05.037416 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
08:11:05.038401 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
08:11:05.040610 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
08:11:05.046293 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
08:11:05.047615 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
08:11:05.056329 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
08:11:05.058227 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
08:11:05.059486 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
08:11:05.060902 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
08:11:05.062137 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
08:11:05.064981 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
08:11:05.067228 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
08:11:05.069647 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
08:11:05.073675 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
08:11:05.075704 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
08:11:05.077401 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
08:11:05.079520 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
08:11:05.081222 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
08:11:05.089829 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
08:11:05.092076 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
08:11:05.093571 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
08:11:05.096431 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
08:11:05.098204 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
08:11:05.100016 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
08:11:05.101298 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
08:11:05.102521 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
08:11:05.103631 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
08:11:05.104833 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
08:11:05.107081 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
08:11:05.108642 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
08:11:05.116536 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
08:11:05.122216 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
08:11:05.128899 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
08:11:05.130569 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
08:11:05.133955 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
08:11:05.135551 [debug] [MainThread]: Parsing macros/sql/pivot.sql
08:11:05.139651 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
08:11:05.145120 [debug] [MainThread]: Parsing macros/sql/groupby.sql
08:11:05.146567 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
08:11:05.152795 [debug] [MainThread]: Parsing macros/sql/star.sql
08:11:05.156019 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
08:11:05.159079 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
08:11:05.161503 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
08:11:05.165563 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
08:11:05.167218 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
08:11:05.171330 [debug] [MainThread]: Parsing macros/sql/union.sql
08:11:05.181830 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
08:11:05.185299 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
08:11:05.187011 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
08:11:05.210445 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
08:11:05.212506 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
08:11:05.214113 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
08:11:05.573615 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
08:11:05.620630 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:11:05.626872 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:11:05.627442 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:11:05.628010 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:11:05.628382 [info ] [MainThread]: Query is: 

    
08:11:05.628822 [info ] [MainThread]: Macro is OK
08:11:05.629110 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
08:11:05.728967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca541a0b-c217-4b2c-a16a-5fd42e9d7995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd0bd71f0>]}
08:11:05.735922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca541a0b-c217-4b2c-a16a-5fd42e9d7995', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd0bed9d0>]}
08:11:05.736475 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
08:11:05.737866 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:11:05.738359 [debug] [MainThread]: Opening a new connection, currently in state init
08:11:05.757160 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:11:05.761228 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:11:05.762335 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:11:05.762827 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:11:05.766086 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:11:05.767019 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:11:05.767481 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:11:05.770482 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:11:05.771359 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:11:05.771829 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:11:05.774763 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:11:05.775615 [info ] [MainThread]: Query is: 

    
08:11:05.776062 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

    
  ...
08:11:05.779324 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with 
08:11:05.779543 [debug] [MainThread]: On macro_init_s3_sources: Close
08:11:05.779799 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
08:11:05.779904 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
08:11:05.780161 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
08:11:05.780394 [debug] [MainThread]: 
08:11:05.780749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd0da48b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd0da4460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bd0da42e0>]}
08:11:06.262351 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 08:11:45.134898 | a74d2676-fd79-4691-a8f6-9897d6b1f045 ==============================
08:11:45.134912 [info ] [MainThread]: Running with dbt=1.1.0
08:11:45.135346 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
08:11:45.135551 [debug] [MainThread]: Tracking: tracking
08:11:45.144072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4147d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4147d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4147d910>]}
08:11:45.192574 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:11:45.192782 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:11:45.198521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a74d2676-fd79-4691-a8f6-9897d6b1f045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b412baee0>]}
08:11:45.205629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a74d2676-fd79-4691-a8f6-9897d6b1f045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b4135cb50>]}
08:11:45.206133 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
08:11:45.211345 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:11:45.218022 [debug] [MainThread]: Opening a new connection, currently in state init
08:11:45.237396 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:11:45.250134 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:11:45.251326 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:11:45.251894 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:11:45.259528 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:11:45.260682 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:11:45.261166 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:11:45.268459 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:11:45.269358 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:11:45.269837 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:11:45.276122 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:11:45.277042 [info ] [MainThread]: Query is: 

    
08:11:45.277527 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

    
  ...
08:11:45.280447 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with 
08:11:45.280693 [debug] [MainThread]: On macro_init_s3_sources: Close
08:11:45.280976 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
08:11:45.281136 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
08:11:45.281538 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 153 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
08:11:45.281827 [debug] [MainThread]: 
08:11:45.282158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b41224910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b412249a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0b41224a00>]}
08:11:45.771726 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 08:12:02.026894 | 023333ae-58de-4f00-9d26-2362665a3175 ==============================
08:12:02.026912 [info ] [MainThread]: Running with dbt=1.1.0
08:12:02.027508 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:12:02.027719 [debug] [MainThread]: Tracking: tracking
08:12:02.037127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a2ff38b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a2ff3910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a2ff3940>]}
08:12:02.088893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:12:02.089159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:12:02.095626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '023333ae-58de-4f00-9d26-2362665a3175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a2e2dee0>]}
08:12:02.104431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '023333ae-58de-4f00-9d26-2362665a3175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a2ecd7c0>]}
08:12:02.104811 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:12:02.105062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '023333ae-58de-4f00-9d26-2362665a3175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a2ecdb50>]}
08:12:02.106769 [info ] [MainThread]: 
08:12:02.107421 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:12:02.108393 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
08:12:02.118247 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:12:02.159396 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
08:12:02.163429 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.164794 [debug] [ThreadPool]: On list_schemas: Close
08:12:02.165922 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
08:12:02.171375 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:12:02.179943 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
08:12:02.183513 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.184783 [debug] [ThreadPool]: On list_None_homework_db: Close
08:12:02.185469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '023333ae-58de-4f00-9d26-2362665a3175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a25643d0>]}
08:12:02.185954 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:12:02.186233 [info ] [MainThread]: 
08:12:02.189558 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
08:12:02.189903 [info ] [Thread-1  ]: 1 of 1 START view model homework_db.lineorder_flat ............................. [RUN]
08:12:02.190423 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
08:12:02.190688 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
08:12:02.190847 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
08:12:02.236694 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:12:02.245449 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
08:12:02.249326 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.258274 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
08:12:02.262459 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.268500 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
08:12:02.272392 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.278148 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
08:12:02.282252 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.286667 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
08:12:02.287058 [debug] [Thread-1  ]: finished collecting timing info
08:12:02.287243 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
08:12:02.310642 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:12:02.313387 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:12:02.317270 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.318349 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:12:02.318861 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:12:02.321968 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.322936 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:12:02.323418 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:12:02.326464 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.327415 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:12:02.327888 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:12:02.331752 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:12:02.333081 [info ] [Thread-1  ]: Query is: 

    
08:12:02.333551 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

    
  ...
08:12:02.336692 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 161 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with 
08:12:02.336855 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
08:12:02.338088 [debug] [Thread-1  ]: finished collecting timing info
08:12:02.338419 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 161 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
08:12:02.338691 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '023333ae-58de-4f00-9d26-2362665a3175', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a0c29f10>]}
08:12:02.339031 [error] [Thread-1  ]: 1 of 1 ERROR creating view model homework_db.lineorder_flat .................... [[31mERROR[0m in 0.15s]
08:12:02.339434 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
08:12:02.340671 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:12:02.341053 [info ] [MainThread]: 
08:12:02.341297 [info ] [MainThread]: Finished running 1 view model in 0.23s.
08:12:02.341573 [debug] [MainThread]: Connection 'master' was properly closed.
08:12:02.341729 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
08:12:02.350923 [info ] [MainThread]: 
08:12:02.351232 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:12:02.351559 [info ] [MainThread]: 
08:12:02.351801 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
08:12:02.352022 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
08:12:02.352244 [error] [MainThread]:    b"Code: 62. DB::Exception: Syntax error: failed at position 161 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
08:12:02.352486 [info ] [MainThread]: 
08:12:02.352747 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
08:12:02.353137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a0c8ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a2e10f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1a254ef10>]}


============================== 2022-06-10 08:13:57.859181 | 545bf227-737e-4dde-a588-0705a92d9066 ==============================
08:13:57.859199 [info ] [MainThread]: Running with dbt=1.1.0
08:13:57.859687 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:13:57.859893 [debug] [MainThread]: Tracking: tracking
08:13:57.869055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc406ea7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc406ea820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc406ea850>]}
08:13:57.902212 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
08:13:57.902587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '545bf227-737e-4dde-a588-0705a92d9066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc40692940>]}
08:13:57.920125 [debug] [MainThread]: Parsing macros/init_s3_source.sql
08:13:57.924206 [debug] [MainThread]: Parsing macros/catalog.sql
08:13:57.925793 [debug] [MainThread]: Parsing macros/adapters.sql
08:13:57.961263 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
08:13:57.962234 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
08:13:57.987816 [debug] [MainThread]: Parsing macros/materializations/seed.sql
08:13:57.991596 [debug] [MainThread]: Parsing macros/materializations/test.sql
08:13:57.992755 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
08:13:58.019696 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:13:58.022271 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:13:58.023751 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:13:58.025298 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:13:58.026699 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:13:58.027403 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:13:58.028209 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:13:58.029056 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:13:58.037300 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:13:58.041521 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:13:58.045775 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:13:58.048630 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:13:58.055687 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:13:58.058488 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:13:58.067704 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:13:58.076618 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:13:58.078645 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:13:58.082312 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:13:58.084574 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:13:58.100697 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:13:58.106714 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:13:58.108079 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:13:58.114992 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:13:58.117691 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:13:58.119981 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:13:58.122772 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:13:58.130325 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:13:58.131859 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:13:58.141469 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:13:58.157006 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:13:58.171880 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:13:58.176304 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:13:58.188909 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:13:58.199572 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:13:58.201305 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:13:58.217534 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:13:58.219349 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:13:58.223754 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:13:58.225608 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:13:58.228508 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
08:13:58.231583 [debug] [MainThread]: Parsing macros/generate_source.sql
08:13:58.238290 [debug] [MainThread]: Parsing macros/generate_base_model.sql
08:13:58.241202 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
08:13:58.242496 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
08:13:58.243863 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
08:13:58.249672 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
08:13:58.253116 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
08:13:58.262935 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
08:13:58.267929 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
08:13:58.269171 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
08:13:58.270810 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
08:13:58.272234 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
08:13:58.273251 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
08:13:58.274691 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
08:13:58.276576 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
08:13:58.278516 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
08:13:58.279970 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
08:13:58.280919 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
08:13:58.281992 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
08:13:58.282960 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
08:13:58.286083 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
08:13:58.287555 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
08:13:58.290218 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
08:13:58.291102 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
08:13:58.293187 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
08:13:58.298539 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
08:13:58.299748 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
08:13:58.308264 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
08:13:58.310110 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
08:13:58.311330 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
08:13:58.312746 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
08:13:58.313990 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
08:13:58.316608 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
08:13:58.318685 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
08:13:58.320986 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
08:13:58.324931 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
08:13:58.326908 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
08:13:58.328546 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
08:13:58.330539 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
08:13:58.332119 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
08:13:58.341063 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
08:13:58.343254 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
08:13:58.344709 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
08:13:58.347491 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
08:13:58.349177 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
08:13:58.350934 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
08:13:58.352137 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
08:13:58.353359 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
08:13:58.354438 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
08:13:58.355571 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
08:13:58.357860 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
08:13:58.359400 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
08:13:58.367092 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
08:13:58.372698 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
08:13:58.379287 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
08:13:58.380843 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
08:13:58.384006 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
08:13:58.385518 [debug] [MainThread]: Parsing macros/sql/pivot.sql
08:13:58.389530 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
08:13:58.395122 [debug] [MainThread]: Parsing macros/sql/groupby.sql
08:13:58.396442 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
08:13:58.402386 [debug] [MainThread]: Parsing macros/sql/star.sql
08:13:58.405597 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
08:13:58.408886 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
08:13:58.411533 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
08:13:58.415737 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
08:13:58.417274 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
08:13:58.421212 [debug] [MainThread]: Parsing macros/sql/union.sql
08:13:58.431855 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
08:13:58.435226 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
08:13:58.436843 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
08:13:58.459888 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
08:13:58.461926 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
08:13:58.463485 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
08:13:58.825284 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
08:13:58.871794 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:13:58.877770 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:13:58.878269 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:13:58.878642 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:13:58.878988 [info ] [MainThread]: Query is: 

    
08:13:58.879319 [info ] [MainThread]: Macro is OK
08:13:58.879600 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
08:13:58.975537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '545bf227-737e-4dde-a588-0705a92d9066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4055ca00>]}
08:13:58.983528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '545bf227-737e-4dde-a588-0705a92d9066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc40705ca0>]}
08:13:58.983843 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:13:58.984054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '545bf227-737e-4dde-a588-0705a92d9066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4053d190>]}
08:13:58.985252 [info ] [MainThread]: 
08:13:58.985771 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:13:58.986667 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
08:13:58.991979 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:13:59.010701 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
08:13:59.013358 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.014560 [debug] [ThreadPool]: On list_schemas: Close
08:13:59.015561 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
08:13:59.020768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:13:59.028430 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
08:13:59.031691 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.032843 [debug] [ThreadPool]: On list_None_homework_db: Close
08:13:59.033415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '545bf227-737e-4dde-a588-0705a92d9066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc40706970>]}
08:13:59.033885 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:13:59.034150 [info ] [MainThread]: 
08:13:59.037266 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
08:13:59.037566 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
08:13:59.038003 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
08:13:59.038216 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
08:13:59.038359 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
08:13:59.057721 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:13:59.065403 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
08:13:59.068488 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.076775 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
08:13:59.080066 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.085761 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
08:13:59.089396 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.094749 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
08:13:59.097805 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.101765 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
08:13:59.102101 [debug] [Thread-1  ]: finished collecting timing info
08:13:59.102289 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
08:13:59.121208 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:13:59.121742 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:13:59.124366 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.125302 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:13:59.125785 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:13:59.128928 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.129977 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:13:59.130393 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:13:59.132913 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.133803 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:13:59.134253 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:13:59.136790 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:13:59.137693 [info ] [Thread-1  ]: Query is: 

    
08:13:59.138194 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

    
  ...
08:13:59.141006 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 161 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with 
08:13:59.141228 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
08:13:59.142249 [debug] [Thread-1  ]: finished collecting timing info
08:13:59.142573 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 161 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
08:13:59.142857 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '545bf227-737e-4dde-a588-0705a92d9066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3e316cd0>]}
08:13:59.143281 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 0.10s]
08:13:59.143684 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
08:13:59.144826 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:13:59.145171 [info ] [MainThread]: 
08:13:59.145411 [info ] [MainThread]: Finished running 1 table model in 0.16s.
08:13:59.145616 [debug] [MainThread]: Connection 'master' was properly closed.
08:13:59.145734 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
08:13:59.154538 [info ] [MainThread]: 
08:13:59.154913 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:13:59.155179 [info ] [MainThread]: 
08:13:59.155416 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
08:13:59.155642 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
08:13:59.155858 [error] [MainThread]:    b"Code: 62. DB::Exception: Syntax error: failed at position 161 ('FORMAT'): FORMAT Native. Expected one of: Query, Query with output, EXPLAIN, SELECT query, possibly with UNION, list of union elements, SELECT query, subquery, possibly with
08:13:59.156080 [info ] [MainThread]: 
08:13:59.156304 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
08:13:59.156667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc3fc14eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc4056feb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc40697040>]}


============================== 2022-06-10 08:20:34.680411 | 803bccf9-c262-42d0-9f5f-148b16208ad9 ==============================
08:20:34.680428 [info ] [MainThread]: Running with dbt=1.1.0
08:20:34.681015 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
08:20:34.681171 [debug] [MainThread]: Tracking: tracking
08:20:34.690367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8be3fe6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8be3fe850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8be3fe880>]}
08:20:34.741665 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:20:34.742214 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
08:20:34.742427 [debug] [MainThread]: Parsing macros/init_s3_source.sql
08:20:34.761052 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
08:20:34.806920 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
08:20:34.813026 [info ] [MainThread]: Macro is OK
08:20:34.813362 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
08:20:34.824165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '803bccf9-c262-42d0-9f5f-148b16208ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8be1bb490>]}
08:20:34.831862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '803bccf9-c262-42d0-9f5f-148b16208ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8be1abdc0>]}
08:20:34.832373 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
08:20:34.833735 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
08:20:34.834233 [debug] [MainThread]: Opening a new connection, currently in state init
08:20:34.853659 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
08:20:34.856701 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY       
08:20:34.856890 [debug] [MainThread]: On macro_init_s3_sources: Close
08:20:34.857114 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
08:20:34.857223 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
08:20:34.857571 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY
08:20:34.857844 [debug] [MainThread]: 
08:20:34.858109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8be2f3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8be2f3790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8be2f3850>]}
08:20:35.362392 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 08:26:50.938457 | c87e2bfb-6912-485a-842d-e969a2d7566f ==============================
08:26:50.938473 [info ] [MainThread]: Running with dbt=1.1.0
08:26:50.938991 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
08:26:50.939202 [debug] [MainThread]: Tracking: tracking
08:26:50.948322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35e9aa6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35e9aa850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35e9aa880>]}
08:26:50.998153 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:26:50.998708 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
08:26:50.998917 [debug] [MainThread]: Parsing macros/init_s3_source.sql
08:26:51.016783 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
08:26:51.064146 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:26:51.070461 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:26:51.070944 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:26:51.071366 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:26:51.071761 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
08:26:51.072170 [info ] [MainThread]: Macro is OK
08:26:51.072415 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
08:26:51.087778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c87e2bfb-6912-485a-842d-e969a2d7566f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35e7726a0>]}
08:26:51.095572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87e2bfb-6912-485a-842d-e969a2d7566f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35e7bbdf0>]}
08:26:51.096097 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
08:26:51.097501 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:26:51.097984 [debug] [MainThread]: Opening a new connection, currently in state init
08:26:51.117914 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:26:51.120242 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:26:51.121479 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:26:51.121970 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:26:51.124408 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:26:51.125324 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:26:51.125767 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:26:51.128829 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:26:51.129714 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:26:51.130140 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:26:51.132740 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:26:51.133658 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
08:26:51.134147 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
08:26:51.137034 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY       
08:26:51.137189 [debug] [MainThread]: On macro_init_s3_sources: Close
08:26:51.137397 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
08:26:51.137499 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
08:26:51.137790 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY
08:26:51.138046 [debug] [MainThread]: 
08:26:51.138299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35e6eb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35e6eb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff35e6eb8b0>]}
08:26:51.617364 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 08:28:55.400873 | e4251238-4404-4886-901c-c7e90ea5edaf ==============================
08:28:55.400890 [info ] [MainThread]: Running with dbt=1.1.0
08:28:55.401396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
08:28:55.401608 [debug] [MainThread]: Tracking: tracking
08:28:55.410845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144e90700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144e90880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144e908b0>]}
08:28:55.461102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:28:55.461674 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
08:28:55.461889 [debug] [MainThread]: Parsing macros/init_s3_source.sql
08:28:55.480850 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
08:28:55.527763 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:28:55.534105 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:28:55.534641 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:28:55.535174 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:28:55.535736 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
08:28:55.536272 [info ] [MainThread]: Macro is OK
08:28:55.536510 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
08:28:55.547132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4251238-4404-4886-901c-c7e90ea5edaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144c5a6d0>]}
08:28:55.554764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4251238-4404-4886-901c-c7e90ea5edaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144ca4fa0>]}
08:28:55.555317 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
08:28:55.556773 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:28:55.557276 [debug] [MainThread]: Opening a new connection, currently in state init
08:28:55.579957 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:28:55.582382 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:28:55.583545 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:28:55.584107 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:28:55.586738 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:28:55.587629 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:28:55.588135 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:28:55.590380 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:28:55.591241 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:28:55.591729 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:28:55.594389 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:28:55.595210 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
08:28:55.595643 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
08:28:55.598430 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY       
08:28:55.598629 [debug] [MainThread]: On macro_init_s3_sources: Close
08:28:55.598868 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
08:28:55.599001 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
08:28:55.599244 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY
08:28:55.599478 [debug] [MainThread]: 
08:28:55.599820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144bd6130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144bd67c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1144bd6910>]}
08:28:56.090995 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 08:29:40.792223 | 23f13cfa-c076-4292-8efe-1d69a35af9e2 ==============================
08:29:40.792239 [info ] [MainThread]: Running with dbt=1.1.0
08:29:40.792776 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'write_manifest': False, 'compile': False, 'which': 'parse', 'rpc_method': 'parse', 'indirect_selection': 'eager'}
08:29:40.792939 [debug] [MainThread]: Tracking: tracking
08:29:40.802067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d8ccd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d8ccd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d8ccd8e0>]}
08:29:40.802470 [info ] [MainThread]: Start parsing.
08:29:40.825716 [info ] [MainThread]: Dependencies loaded
08:29:40.836347 [info ] [MainThread]: ManifestLoader created
08:29:40.852985 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:29:40.853188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:29:40.853336 [info ] [MainThread]: Manifest loaded
08:29:40.853824 [info ] [MainThread]: Manifest checked
08:29:40.854438 [info ] [MainThread]: Flat graph built
08:29:40.854778 [info ] [MainThread]: Manifest loaded
08:29:40.855465 [info ] [MainThread]: Performance info: target/perf_info.json
08:29:40.855710 [info ] [MainThread]: Done.
08:29:40.856019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d8afd3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d8afd4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93d8afd430>]}


============================== 2022-06-10 08:41:45.076790 | 911d4a70-299e-4bc9-a1cc-5b44be4238f8 ==============================
08:41:45.076808 [info ] [MainThread]: Running with dbt=1.1.0
08:41:45.077315 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
08:41:45.077527 [debug] [MainThread]: Tracking: tracking
08:41:45.087545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fecf96a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fecf9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fecf9850>]}
08:41:45.138344 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:41:45.138905 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
08:41:45.139119 [debug] [MainThread]: Parsing macros/init_s3_source.sql
08:41:45.157166 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
08:41:45.205111 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:41:45.211512 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:41:45.212074 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:41:45.212632 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:41:45.213147 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
08:41:45.213769 [info ] [MainThread]: Macro is OK
08:41:45.214128 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
08:41:45.225897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '911d4a70-299e-4bc9-a1cc-5b44be4238f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98feac4670>]}
08:41:45.233601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '911d4a70-299e-4bc9-a1cc-5b44be4238f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98feb0edc0>]}
08:41:45.234146 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
08:41:45.235569 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:41:45.236057 [debug] [MainThread]: Opening a new connection, currently in state init
08:41:45.255499 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:41:45.258111 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:41:45.259275 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:41:45.259795 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:41:45.262416 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:41:45.263326 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:41:45.263754 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:41:45.266628 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:41:45.267505 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:41:45.267985 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:41:45.270732 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:41:45.271611 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
08:41:45.272092 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
08:41:45.275159 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY       
08:41:45.275325 [debug] [MainThread]: On macro_init_s3_sources: Close
08:41:45.275569 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
08:41:45.275677 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
08:41:45.276020 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY
08:41:45.276287 [debug] [MainThread]: 
08:41:45.276577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fea41730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fea418b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f98fea41250>]}
08:41:45.778494 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 08:46:20.879384 | e30c0ef7-4f7e-4247-8e57-3addf2075f7b ==============================
08:46:20.879401 [info ] [MainThread]: Running with dbt=1.1.0
08:46:20.879892 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
08:46:20.880109 [debug] [MainThread]: Tracking: tracking
08:46:20.889576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300de0f760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300de0f8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300de0f910>]}
08:46:20.939269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:46:20.939484 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:46:20.945528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e30c0ef7-4f7e-4247-8e57-3addf2075f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300dc4dee0>]}
08:46:20.952939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e30c0ef7-4f7e-4247-8e57-3addf2075f7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300dcedb50>]}
08:46:20.953459 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
08:46:20.959176 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:46:20.965818 [debug] [MainThread]: Opening a new connection, currently in state init
08:46:20.983769 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:46:20.986254 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:46:20.987405 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:46:20.987874 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:46:20.990478 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:46:20.991580 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:46:20.992004 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:46:20.994490 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:46:20.995351 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:46:20.995768 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:46:20.998077 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:46:20.998925 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
08:46:20.999368 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        ;

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        ;

    
  ...
08:46:21.002118 [debug] [MainThread]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY       
08:46:21.002278 [debug] [MainThread]: On macro_init_s3_sources: Close
08:46:21.002480 [debug] [MainThread]: clickhouse adapter: Error running SQL: macro init_s3_sources
08:46:21.002585 [debug] [MainThread]: clickhouse adapter: Rolling back transaction.
08:46:21.002872 [error] [MainThread]: Encountered an error while running operation: Database Error
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b'Code: 62. DB::Exception: Syntax error (Multi-statements are not allowed): failed at position 721 (end of query) (line 17, col 9): ;\n\n        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder\n        (\n            LO_ORDERKEY
08:46:21.003139 [debug] [MainThread]: 
08:46:21.003434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300dbb89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300dbb8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f300dbb8ac0>]}
08:46:21.488135 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 08:49:34.114729 | f272c296-336a-4170-94cb-535f35bdbda6 ==============================
08:49:34.114749 [info ] [MainThread]: Running with dbt=1.1.0
08:49:34.115258 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'macro': 'init_s3_sources', 'args': '{}', 'which': 'run-operation', 'rpc_method': 'run-operation', 'indirect_selection': 'eager'}
08:49:34.115413 [debug] [MainThread]: Tracking: tracking
08:49:34.124795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e5a0b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e5a0b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e5a0b8e0>]}
08:49:34.176792 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
08:49:34.177420 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://macros/init_s3_source.sql
08:49:34.177634 [debug] [MainThread]: Parsing macros/init_s3_source.sql
08:49:34.195646 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
08:49:34.250520 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:49:34.251090 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:49:34.251614 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:49:34.252084 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:49:34.252441 [info ] [MainThread]: Query is: 

    
08:49:34.252743 [info ] [MainThread]: Macro is OK
08:49:34.253042 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
08:49:34.265484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f272c296-336a-4170-94cb-535f35bdbda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e57d0700>]}
08:49:34.273402 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f272c296-336a-4170-94cb-535f35bdbda6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e581cfd0>]}
08:49:34.273940 [debug] [MainThread]: Acquiring new clickhouse connection "macro_init_s3_sources"
08:49:34.275428 [debug] [MainThread]: Opening a new connection, currently in state init
08:49:34.295511 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:49:34.297940 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:49:34.299088 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:49:34.299639 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:49:34.302078 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:49:34.302988 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:49:34.303539 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:49:34.306045 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:49:34.306964 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:49:34.307459 [debug] [MainThread]: clickhouse adapter: On macro_init_s3_sources: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "macro_init_s3_sources"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:49:34.310156 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:49:34.311039 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:49:34.311309 [info ] [MainThread]: Query is: 

    
08:49:34.311575 [info ] [MainThread]: Macro is OK
08:49:34.311871 [debug] [MainThread]: On macro_init_s3_sources: Close
08:49:34.312355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e5a0b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e57756d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb6e5775490>]}
08:49:34.800484 [debug] [MainThread]: Connection 'macro_init_s3_sources' was properly closed.


============================== 2022-06-10 08:50:03.660943 | 36dea456-015d-47e9-b8ff-1b4e2fc195da ==============================
08:50:03.660961 [info ] [MainThread]: Running with dbt=1.1.0
08:50:03.661494 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
08:50:03.661705 [debug] [MainThread]: Tracking: tracking
08:50:03.670537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ee1e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ee1e7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ee1e7f0>]}
08:50:03.721143 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:50:03.721389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:50:03.727593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36dea456-015d-47e9-b8ff-1b4e2fc195da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ec59d90>]}
08:50:03.735827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36dea456-015d-47e9-b8ff-1b4e2fc195da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ecf9670>]}
08:50:03.736157 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:50:03.736418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36dea456-015d-47e9-b8ff-1b4e2fc195da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ecf9a00>]}
08:50:03.737778 [info ] [MainThread]: 
08:50:03.738308 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:50:03.739196 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
08:50:03.748687 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:50:03.767964 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
08:50:03.770739 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.772077 [debug] [ThreadPool]: On list_schemas: Close
08:50:03.773123 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
08:50:03.778633 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:50:03.787553 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
08:50:03.791616 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.792763 [debug] [ThreadPool]: On list_None_homework_db: Close
08:50:03.793337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36dea456-015d-47e9-b8ff-1b4e2fc195da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6e3944c0>]}
08:50:03.793799 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:50:03.794069 [info ] [MainThread]: 
08:50:03.797049 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
08:50:03.797341 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
08:50:03.797785 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
08:50:03.798023 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
08:50:03.798179 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
08:50:03.842155 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:50:03.851123 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
08:50:03.855367 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.863759 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
08:50:03.867399 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.872996 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
08:50:03.876541 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.881836 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
08:50:03.885582 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.889677 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
08:50:03.890035 [debug] [Thread-1  ]: finished collecting timing info
08:50:03.890226 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
08:50:03.915411 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:50:03.918906 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.919836 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
08:50:03.920340 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:50:03.923244 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.924126 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
08:50:03.924641 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:50:03.927332 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.928226 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
08:50:03.928734 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:50:03.930887 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:50:03.932013 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
08:50:03.932282 [info ] [Thread-1  ]: Query is: 

    
08:50:03.932530 [info ] [Thread-1  ]: Macro is OK
08:50:03.954969 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
08:50:03.955536 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT

    md5(cast(coalesce(cast(LO_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    string
), '') as 
    string
))
    ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
    ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
    ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
    ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

FROM homework_db.src_lineorder AS l
INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
08:50:03.978183 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
 b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
08:50:03.978457 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
08:50:03.978768 [debug] [Thread-1  ]: finished collecting timing info
08:50:03.979084 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
   b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
08:50:03.979369 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36dea456-015d-47e9-b8ff-1b4e2fc195da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6ca7a0a0>]}
08:50:03.979731 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 0.18s]
08:50:03.980184 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
08:50:03.981289 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:50:03.981684 [info ] [MainThread]: 
08:50:03.981967 [info ] [MainThread]: Finished running 1 table model in 0.24s.
08:50:03.982252 [debug] [MainThread]: Connection 'master' was properly closed.
08:50:03.982388 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
08:50:03.990966 [info ] [MainThread]: 
08:50:03.991254 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:50:03.991499 [info ] [MainThread]: 
08:50:03.991727 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
08:50:03.991960 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
08:50:03.992183 [error] [MainThread]:    b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
08:50:03.992400 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
08:50:03.992682 [info ] [MainThread]: 
08:50:03.992964 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
08:50:03.993339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6e37bf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6e37bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a6e37bc40>]}


============================== 2022-06-10 09:21:03.608750 | 8cb261ed-139a-4e0c-9324-d9ddc300f0a2 ==============================
09:21:03.608769 [info ] [MainThread]: Running with dbt=1.1.0
09:21:03.609284 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:21:03.609487 [debug] [MainThread]: Tracking: tracking
09:21:03.618514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ef3fc7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ef3fc820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ef3fc850>]}
09:21:03.667935 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
09:21:03.668159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
09:21:03.674043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8cb261ed-139a-4e0c-9324-d9ddc300f0a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ef236df0>]}
09:21:03.682394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8cb261ed-139a-4e0c-9324-d9ddc300f0a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ef21b6d0>]}
09:21:03.682728 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
09:21:03.682999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cb261ed-139a-4e0c-9324-d9ddc300f0a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ef21ba60>]}
09:21:03.684405 [info ] [MainThread]: 
09:21:03.684978 [debug] [MainThread]: Acquiring new clickhouse connection "master"
09:21:03.685880 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
09:21:03.696126 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:21:03.714683 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
09:21:03.717000 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.718232 [debug] [ThreadPool]: On list_schemas: Close
09:21:03.719222 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
09:21:03.724420 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:21:03.731608 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
09:21:03.734716 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.735817 [debug] [ThreadPool]: On list_None_homework_db: Close
09:21:03.736391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8cb261ed-139a-4e0c-9324-d9ddc300f0a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ee9702e0>]}
09:21:03.736888 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:21:03.737158 [info ] [MainThread]: 
09:21:03.740245 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
09:21:03.740568 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
09:21:03.741031 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
09:21:03.741254 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
09:21:03.741407 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
09:21:03.784613 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:21:03.793263 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:03.796725 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.805392 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:03.809311 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.815107 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:03.819154 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.824603 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:03.827888 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.832090 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
09:21:03.832474 [debug] [Thread-1  ]: finished collecting timing info
09:21:03.832697 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
09:21:03.858655 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
09:21:03.861750 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.862758 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
09:21:03.863263 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
09:21:03.866032 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.866966 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
09:21:03.867444 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
09:21:03.869815 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.870706 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
09:21:03.871147 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
09:21:03.873630 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:03.874845 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
09:21:03.875135 [info ] [Thread-1  ]: Query is: 

    
09:21:03.875340 [info ] [Thread-1  ]: Macro is OK
09:21:03.899237 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
09:21:03.899706 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT

    md5(cast(coalesce(cast(LO_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    string
), '') as 
    string
))
    ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
    ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
    ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
    ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

FROM homework_db.src_lineorder AS l
INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
09:21:03.916456 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
 b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
09:21:03.916731 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
09:21:03.917061 [debug] [Thread-1  ]: finished collecting timing info
09:21:03.917377 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
   b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
09:21:03.917662 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8cb261ed-139a-4e0c-9324-d9ddc300f0a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ed09b850>]}
09:21:03.918031 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 0.18s]
09:21:03.918522 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
09:21:03.919604 [debug] [MainThread]: Acquiring new clickhouse connection "master"
09:21:03.919979 [info ] [MainThread]: 
09:21:03.920257 [info ] [MainThread]: Finished running 1 table model in 0.24s.
09:21:03.920485 [debug] [MainThread]: Connection 'master' was properly closed.
09:21:03.920637 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
09:21:03.929034 [info ] [MainThread]: 
09:21:03.929346 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
09:21:03.929608 [info ] [MainThread]: 
09:21:03.929838 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
09:21:03.930063 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
09:21:03.930279 [error] [MainThread]:    b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
09:21:03.930547 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
09:21:03.930811 [info ] [MainThread]: 
09:21:03.931065 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
09:21:03.931462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ee9633d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ee963370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f68ee963430>]}


============================== 2022-06-10 09:21:14.775337 | c5d27da1-6107-4438-827a-8b6b5740b83d ==============================
09:21:14.775355 [info ] [MainThread]: Running with dbt=1.1.0
09:21:14.775890 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:21:14.776046 [debug] [MainThread]: Tracking: tracking
09:21:14.785360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb270790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb2707f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb270820>]}
09:21:14.835965 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
09:21:14.836501 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
09:21:14.849535 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
09:21:14.904971 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
09:21:14.905538 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
09:21:14.905961 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
09:21:14.906356 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
09:21:14.906640 [info ] [MainThread]: Query is: 

    
09:21:14.906899 [info ] [MainThread]: Macro is OK
09:21:14.907149 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
09:21:14.917764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5d27da1-6107-4438-827a-8b6b5740b83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb02d5b0>]}
09:21:14.926378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5d27da1-6107-4438-827a-8b6b5740b83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb071ee0>]}
09:21:14.926709 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
09:21:14.926951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d27da1-6107-4438-827a-8b6b5740b83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb0ec850>]}
09:21:14.928294 [info ] [MainThread]: 
09:21:14.928914 [debug] [MainThread]: Acquiring new clickhouse connection "master"
09:21:14.929848 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
09:21:14.935181 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:21:14.955636 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
09:21:14.958247 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:14.959534 [debug] [ThreadPool]: On list_schemas: Close
09:21:14.960534 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
09:21:14.965581 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:21:14.974852 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
09:21:14.978237 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:14.979416 [debug] [ThreadPool]: On list_None_homework_db: Close
09:21:14.980023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d27da1-6107-4438-827a-8b6b5740b83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffaffb7c0>]}
09:21:14.980503 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:21:14.980789 [info ] [MainThread]: 
09:21:14.983963 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
09:21:14.984262 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
09:21:14.984683 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
09:21:14.984910 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
09:21:14.985092 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
09:21:15.003735 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:21:15.013805 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:15.017627 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:15.026394 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:15.033668 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
09:21:15.039733 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:15.050431 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
09:21:15.056086 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:15.060600 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:15.064756 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
09:21:15.065111 [debug] [Thread-1  ]: finished collecting timing info
09:21:15.065285 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
09:21:15.084599 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
09:21:15.087924 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:15.088948 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
09:21:15.089442 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
09:21:15.092514 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:15.093488 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
09:21:15.093942 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
09:21:15.096727 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:15.097656 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
09:21:15.098113 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
09:21:15.100471 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:15.101372 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
09:21:15.101651 [info ] [Thread-1  ]: Query is: 

    
09:21:15.101854 [info ] [Thread-1  ]: Macro is OK
09:21:15.124910 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
09:21:15.125399 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT

    md5(cast(coalesce(cast(LO_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    string
), '') as 
    string
))
    ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
    ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
    ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
    ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

FROM homework_db.src_lineorder AS l
INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
09:21:15.139434 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
 b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
09:21:15.139695 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
09:21:15.140009 [debug] [Thread-1  ]: finished collecting timing info
09:21:15.140331 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
   b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
09:21:15.140655 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d27da1-6107-4438-827a-8b6b5740b83d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffa7368b0>]}
09:21:15.141069 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 0.16s]
09:21:15.141550 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
09:21:15.142777 [debug] [MainThread]: Acquiring new clickhouse connection "master"
09:21:15.143185 [info ] [MainThread]: 
09:21:15.143417 [info ] [MainThread]: Finished running 1 table model in 0.21s.
09:21:15.143629 [debug] [MainThread]: Connection 'master' was properly closed.
09:21:15.143786 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
09:21:15.152512 [info ] [MainThread]: 
09:21:15.152829 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
09:21:15.153106 [info ] [MainThread]: 
09:21:15.153357 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
09:21:15.153589 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
09:21:15.153807 [error] [MainThread]:    b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
09:21:15.154026 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
09:21:15.154268 [info ] [MainThread]: 
09:21:15.154545 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
09:21:15.154949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb0237c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb071a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffb057dc0>]}


============================== 2022-06-10 09:21:36.210994 | 5f68f97b-c86c-4eea-bde9-9652eec55924 ==============================
09:21:36.211016 [info ] [MainThread]: Running with dbt=1.1.0
09:21:36.211669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
09:21:36.211905 [debug] [MainThread]: Tracking: tracking
09:21:36.225446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a0903700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a0903760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a0903790>]}
09:21:36.289036 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
09:21:36.289281 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
09:21:36.295290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5f68f97b-c86c-4eea-bde9-9652eec55924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a073cd30>]}
09:21:36.303257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5f68f97b-c86c-4eea-bde9-9652eec55924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a07dd610>]}
09:21:36.303554 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
09:21:36.303767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f68f97b-c86c-4eea-bde9-9652eec55924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a07dd9a0>]}
09:21:36.305070 [info ] [MainThread]: 
09:21:36.305669 [debug] [MainThread]: Acquiring new clickhouse connection "master"
09:21:36.306493 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
09:21:36.315971 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:21:36.335418 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
09:21:36.338920 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:36.340308 [debug] [ThreadPool]: On list_None_homework_db: Close
09:21:36.341010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5f68f97b-c86c-4eea-bde9-9652eec55924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46a0720f70>]}
09:21:36.341500 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:21:36.341782 [info ] [MainThread]: 
09:21:36.344820 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
09:21:36.345170 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
09:21:36.345384 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
09:21:36.345533 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
09:21:36.390110 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:21:36.399174 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:36.402826 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:36.412150 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:36.415752 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:36.421619 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:36.425315 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:36.430765 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
09:21:36.434524 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:21:36.438868 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
09:21:36.439219 [debug] [Thread-1  ]: finished collecting timing info
09:21:36.439394 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
09:21:36.439552 [debug] [Thread-1  ]: finished collecting timing info
09:21:36.439691 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
09:21:36.440127 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
09:21:36.441109 [debug] [MainThread]: Connection 'master' was properly closed.
09:21:36.441274 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
09:21:36.449159 [info ] [MainThread]: Done.
09:21:36.449528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469fe80250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469fe80490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f469fe80550>]}


============================== 2022-06-10 09:36:22.522636 | e0354655-4dbe-4f2b-bc67-dc4aacd198c7 ==============================
09:36:22.522654 [info ] [MainThread]: Running with dbt=1.1.0
09:36:22.523184 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:36:22.523400 [debug] [MainThread]: Tracking: tracking
09:36:22.532673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85abb9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85abb9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85abb98b0>]}
09:36:22.584367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
09:36:22.584940 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
09:36:22.597333 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
09:36:22.651523 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
09:36:22.652109 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
09:36:22.652654 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
09:36:22.653051 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
09:36:22.653299 [info ] [MainThread]: Query is: 

    
09:36:22.653611 [info ] [MainThread]: Macro is OK
09:36:22.653913 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
09:36:22.664870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0354655-4dbe-4f2b-bc67-dc4aacd198c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85a974640>]}
09:36:22.673692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0354655-4dbe-4f2b-bc67-dc4aacd198c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85a9b7250>]}
09:36:22.674054 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
09:36:22.674337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0354655-4dbe-4f2b-bc67-dc4aacd198c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85aa348e0>]}
09:36:22.675745 [info ] [MainThread]: 
09:36:22.676411 [debug] [MainThread]: Acquiring new clickhouse connection "master"
09:36:22.677316 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
09:36:22.682349 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:36:22.700628 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
09:36:22.703192 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.704457 [debug] [ThreadPool]: On list_schemas: Close
09:36:22.705540 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
09:36:22.710837 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:36:22.719397 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
09:36:22.722641 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.724105 [debug] [ThreadPool]: On list_None_homework_db: Close
09:36:22.724771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0354655-4dbe-4f2b-bc67-dc4aacd198c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85a921820>]}
09:36:22.725279 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:36:22.725557 [info ] [MainThread]: 
09:36:22.728702 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
09:36:22.729018 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
09:36:22.729496 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
09:36:22.729744 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
09:36:22.729916 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
09:36:22.748752 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:36:22.756692 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
09:36:22.760115 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.768996 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
09:36:22.772912 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.778811 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
09:36:22.782081 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.787769 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
09:36:22.791300 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.795604 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
09:36:22.795979 [debug] [Thread-1  ]: finished collecting timing info
09:36:22.796186 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
09:36:22.815811 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
09:36:22.819139 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.820079 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
09:36:22.820631 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
09:36:22.823683 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.824540 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
09:36:22.825045 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
09:36:22.827556 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.828419 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
09:36:22.828918 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
09:36:22.831586 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:36:22.832425 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
09:36:22.832715 [info ] [Thread-1  ]: Query is: 

    
09:36:22.832978 [info ] [Thread-1  ]: Macro is OK
09:36:22.856256 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
09:36:22.856754 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT

     md5(cast(coalesce(cast(LO_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    string
), '') as 
    string
))
    ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
    ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
    ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
    ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

FROM homework_db.src_lineorder AS l
INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
09:36:22.870574 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
 b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
09:36:22.870820 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
09:36:22.871139 [debug] [Thread-1  ]: finished collecting timing info
09:36:22.871456 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
   b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
09:36:22.871746 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0354655-4dbe-4f2b-bc67-dc4aacd198c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8587db8b0>]}
09:36:22.872137 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 0.14s]
09:36:22.872660 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
09:36:22.873879 [debug] [MainThread]: Acquiring new clickhouse connection "master"
09:36:22.874301 [info ] [MainThread]: 
09:36:22.874569 [info ] [MainThread]: Finished running 1 table model in 0.20s.
09:36:22.874780 [debug] [MainThread]: Connection 'master' was properly closed.
09:36:22.874935 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
09:36:22.883662 [info ] [MainThread]: 
09:36:22.883975 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
09:36:22.884302 [info ] [MainThread]: 
09:36:22.884595 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
09:36:22.884863 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
09:36:22.885123 [error] [MainThread]:    b"Code: 46. DB::Exception: Unknown function md5. Maybe you meant: ['MD5','MD4']: While processing md5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_SUPPKEY, 'string'
09:36:22.885365 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
09:36:22.885600 [info ] [MainThread]: 
09:36:22.885836 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
09:36:22.886191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85a9b7ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85a9a1fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff85aa34970>]}


============================== 2022-06-10 09:58:05.953339 | 8c5f3292-ea74-4a15-b43b-17f2ad886187 ==============================
09:58:05.953356 [info ] [MainThread]: Running with dbt=1.1.0
09:58:05.953884 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
09:58:05.954041 [debug] [MainThread]: Tracking: tracking
09:58:05.963303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552f317c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552f31820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552f31850>]}
09:58:06.016726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
09:58:06.017455 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/cross_db_utils/hash.sql
09:58:06.017683 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
09:58:06.022351 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
09:58:06.040642 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
09:58:06.096475 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
09:58:06.097084 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
09:58:06.097503 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
09:58:06.097881 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
09:58:06.098132 [info ] [MainThread]: Query is: 

    
09:58:06.098347 [info ] [MainThread]: Macro is OK
09:58:06.098611 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
09:58:06.111448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c5f3292-ea74-4a15-b43b-17f2ad886187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552c5e6a0>]}
09:58:06.120522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c5f3292-ea74-4a15-b43b-17f2ad886187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552cd58b0>]}
09:58:06.120902 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
09:58:06.121192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c5f3292-ea74-4a15-b43b-17f2ad886187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552dbcb20>]}
09:58:06.122616 [info ] [MainThread]: 
09:58:06.123209 [debug] [MainThread]: Acquiring new clickhouse connection "master"
09:58:06.124153 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
09:58:06.129531 [debug] [ThreadPool]: Opening a new connection, currently in state init
09:58:06.147561 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
09:58:06.150877 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.152138 [debug] [ThreadPool]: On list_schemas: Close
09:58:06.153194 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
09:58:06.158382 [debug] [ThreadPool]: Opening a new connection, currently in state closed
09:58:06.166336 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
09:58:06.170094 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.171291 [debug] [ThreadPool]: On list_None_homework_db: Close
09:58:06.171898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c5f3292-ea74-4a15-b43b-17f2ad886187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552cb1850>]}
09:58:06.172384 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
09:58:06.172688 [info ] [MainThread]: 
09:58:06.175833 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
09:58:06.176134 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
09:58:06.176593 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
09:58:06.176873 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
09:58:06.177039 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
09:58:06.196433 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
09:58:06.205104 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
09:58:06.208421 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.217170 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
09:58:06.220756 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.226450 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
09:58:06.229955 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.235707 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
09:58:06.239161 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.243484 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
09:58:06.243854 [debug] [Thread-1  ]: finished collecting timing info
09:58:06.244054 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
09:58:06.264824 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
09:58:06.268159 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.269178 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
09:58:06.269679 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
09:58:06.273056 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.273967 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
09:58:06.274388 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
09:58:06.277034 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.277919 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
09:58:06.278411 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
09:58:06.280947 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
09:58:06.281838 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
09:58:06.282093 [info ] [Thread-1  ]: Query is: 

    
09:58:06.282367 [info ] [Thread-1  ]: Macro is OK
09:58:06.305212 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
09:58:06.305693 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT

     MD5(cast(coalesce(cast(LO_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    string
), '') as 
    string
))
    ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
    ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
    ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
    ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

FROM homework_db.src_lineorder AS l
INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
09:58:06.323817 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
 b"Code: 50. DB::Exception: Unknown data type family: string. Maybe you meant: ['String','Ring']: While processing MD5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_S
09:58:06.324080 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
09:58:06.324353 [debug] [Thread-1  ]: finished collecting timing info
09:58:06.324661 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
   b"Code: 50. DB::Exception: Unknown data type family: string. Maybe you meant: ['String','Ring']: While processing MD5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_S
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
09:58:06.324930 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c5f3292-ea74-4a15-b43b-17f2ad886187', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd550b58280>]}
09:58:06.325275 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 0.15s]
09:58:06.325776 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
09:58:06.327128 [debug] [MainThread]: Acquiring new clickhouse connection "master"
09:58:06.327483 [info ] [MainThread]: 
09:58:06.327728 [info ] [MainThread]: Finished running 1 table model in 0.20s.
09:58:06.327937 [debug] [MainThread]: Connection 'master' was properly closed.
09:58:06.328043 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
09:58:06.336798 [info ] [MainThread]: 
09:58:06.337099 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
09:58:06.337362 [info ] [MainThread]: 
09:58:06.337596 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
09:58:06.337833 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 404)
09:58:06.338058 [error] [MainThread]:    b"Code: 50. DB::Exception: Unknown data type family: string. Maybe you meant: ['String','Ring']: While processing MD5(CAST(concat(coalesce(CAST(LO_CUSTKEY, 'string'), ''), '-', coalesce(CAST(C_CUSTKEY, 'string'), ''), '-', coalesce(CAST(S_S
09:58:06.338283 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
09:58:06.338539 [info ] [MainThread]: 
09:58:06.338812 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
09:58:06.339160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552dc3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552dbcb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd552dbcb20>]}


============================== 2022-06-10 10:19:44.319192 | 32fc39d2-3dfb-4e0e-9a08-a5a528ea2662 ==============================
10:19:44.319209 [info ] [MainThread]: Running with dbt=1.1.0
10:19:44.319752 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:19:44.319959 [debug] [MainThread]: Tracking: tracking
10:19:44.329039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8625557820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8625557880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86255578b0>]}
10:19:44.381113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
10:19:44.382848 [debug] [MainThread]: Partial parsing: updated file: dbt_utils://macros/cross_db_utils/datatypes.sql
10:19:44.383074 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
10:19:44.409432 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
10:19:44.412303 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
10:19:44.428806 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
10:19:44.441318 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
10:19:44.452209 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
10:19:44.453804 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
10:19:44.461775 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
10:19:44.463905 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
10:19:44.466503 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
10:19:44.467955 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
10:19:44.471413 [debug] [MainThread]: Parsing macros/sql/union.sql
10:19:44.482192 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
10:19:44.485508 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
10:19:44.510027 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
10:19:44.511955 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
10:19:44.514823 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
10:19:44.519901 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
10:19:44.626154 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
10:19:44.680438 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
10:19:44.681063 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
10:19:44.681631 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
10:19:44.682117 [info ] [MainThread]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
10:19:44.682423 [info ] [MainThread]: Query is: 

    
10:19:44.682699 [info ] [MainThread]: Macro is OK
10:19:44.682977 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
10:19:44.698358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32fc39d2-3dfb-4e0e-9a08-a5a528ea2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8625366c10>]}
10:19:44.707064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32fc39d2-3dfb-4e0e-9a08-a5a528ea2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8625380040>]}
10:19:44.707414 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
10:19:44.707686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32fc39d2-3dfb-4e0e-9a08-a5a528ea2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8625380370>]}
10:19:44.709251 [info ] [MainThread]: 
10:19:44.709783 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:19:44.710708 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
10:19:44.716154 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:19:44.734883 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
10:19:44.737567 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.739059 [debug] [ThreadPool]: On list_schemas: Close
10:19:44.740094 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
10:19:44.745584 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:19:44.753625 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
10:19:44.757080 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.758263 [debug] [ThreadPool]: On list_None_homework_db: Close
10:19:44.758900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32fc39d2-3dfb-4e0e-9a08-a5a528ea2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f862528e4c0>]}
10:19:44.759392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:19:44.759667 [info ] [MainThread]: 
10:19:44.763182 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
10:19:44.763507 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
10:19:44.763960 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
10:19:44.764208 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
10:19:44.764372 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
10:19:44.783280 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:19:44.791713 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
10:19:44.795100 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.802571 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
10:19:44.806186 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.811492 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
10:19:44.814890 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.820638 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
10:19:44.824005 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.827119 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
10:19:44.827449 [debug] [Thread-1  ]: finished collecting timing info
10:19:44.827631 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
10:19:44.847220 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
10:19:44.850542 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.851527 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
10:19:44.851976 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
10:19:44.854739 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.856036 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
10:19:44.856519 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
10:19:44.859365 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.860273 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
10:19:44.860765 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
10:19:44.863254 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:19:44.864154 [info ] [Thread-1  ]: Query is: 

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
10:19:44.864421 [info ] [Thread-1  ]: Query is: 

    
10:19:44.864713 [info ] [Thread-1  ]: Macro is OK
10:19:44.887694 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
10:19:44.888219 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT

     MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
))
    ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
    ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
    ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
    ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

FROM homework_db.src_lineorder AS l
INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
10:19:55.745110 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
10:19:55.745377 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
10:19:55.745688 [debug] [Thread-1  ]: finished collecting timing info
10:19:55.746021 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
10:19:55.746312 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '32fc39d2-3dfb-4e0e-9a08-a5a528ea2662', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8624a3b370>]}
10:19:55.746686 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 10.98s]
10:19:55.747127 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
10:19:55.748345 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:19:55.748745 [info ] [MainThread]: 
10:19:55.748981 [info ] [MainThread]: Finished running 1 table model in 11.04s.
10:19:55.749236 [debug] [MainThread]: Connection 'master' was properly closed.
10:19:55.749383 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
10:19:55.757214 [info ] [MainThread]: 
10:19:55.757498 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
10:19:55.757818 [info ] [MainThread]: 
10:19:55.758088 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
10:19:55.758361 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
10:19:55.758612 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
10:19:55.758846 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
10:19:55.759113 [info ] [MainThread]: 
10:19:55.759399 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
10:19:55.759782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86253e8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8625380280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f86253802b0>]}


============================== 2022-06-10 10:28:42.057962 | 109b33af-d964-48fb-acd4-69538ecde7e7 ==============================
10:28:42.057977 [info ] [MainThread]: Running with dbt=1.1.0
10:28:42.058334 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
10:28:42.058514 [debug] [MainThread]: Tracking: tracking
10:28:42.067632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98a65040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98a65970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98a715b0>]}
10:28:42.085956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98a715b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98a71130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffb98a711c0>]}


============================== 2022-06-10 10:28:55.797603 | 08e9d55e-9e3a-4e14-92b6-a3ba7b6922c8 ==============================
10:28:55.797618 [info ] [MainThread]: Running with dbt=1.1.0
10:28:55.797960 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
10:28:55.798081 [debug] [MainThread]: Tracking: tracking
10:28:55.806964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31824933d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3182493400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3182493f10>]}
10:28:55.807606 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-0netc6as'
10:28:55.807907 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
10:28:55.921570 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
10:28:55.922200 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
10:28:56.043018 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
10:28:56.046666 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
10:28:56.148827 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
10:28:56.210992 [info ] [MainThread]: Installing dbt-labs/codegen
10:28:56.478378 [info ] [MainThread]:   Installed from version 0.6.0
10:28:56.478780 [info ] [MainThread]:   Up to date!
10:28:56.479099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '08e9d55e-9e3a-4e14-92b6-a3ba7b6922c8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3182502f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3182459b80>]}
10:28:56.479437 [info ] [MainThread]: Installing dbt-labs/dbt_utils
10:28:56.947928 [info ] [MainThread]:   Installed from version 0.8.5
10:28:56.948275 [info ] [MainThread]:   Up to date!
10:28:56.948635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '08e9d55e-9e3a-4e14-92b6-a3ba7b6922c8', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3182439a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3182439160>]}
10:28:56.949202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f318250c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3182437f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3182437d30>]}


============================== 2022-06-10 10:29:03.588945 | 19a30bff-f719-40bc-bf93-489f6203a966 ==============================
10:29:03.588963 [info ] [MainThread]: Running with dbt=1.1.0
10:29:03.589491 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:29:03.589646 [debug] [MainThread]: Tracking: tracking
10:29:03.599037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a6f7670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a6f7760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a6f7790>]}
10:29:03.624055 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
10:29:03.624389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '19a30bff-f719-40bc-bf93-489f6203a966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a6a7ac0>]}
10:29:03.641170 [debug] [MainThread]: Parsing macros/init_s3_source.sql
10:29:03.644933 [debug] [MainThread]: Parsing macros/catalog.sql
10:29:03.646383 [debug] [MainThread]: Parsing macros/adapters.sql
10:29:03.678812 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
10:29:03.679852 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
10:29:03.704993 [debug] [MainThread]: Parsing macros/materializations/seed.sql
10:29:03.708833 [debug] [MainThread]: Parsing macros/materializations/test.sql
10:29:03.710102 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
10:29:03.735550 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
10:29:03.737900 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
10:29:03.739388 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
10:29:03.740975 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
10:29:03.742339 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
10:29:03.743078 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
10:29:03.743924 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
10:29:03.744804 [debug] [MainThread]: Parsing macros/etc/datetime.sql
10:29:03.752920 [debug] [MainThread]: Parsing macros/etc/statement.sql
10:29:03.757232 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
10:29:03.761311 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
10:29:03.763845 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
10:29:03.770527 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
10:29:03.773134 [debug] [MainThread]: Parsing macros/adapters/columns.sql
10:29:03.782030 [debug] [MainThread]: Parsing macros/adapters/relation.sql
10:29:03.791285 [debug] [MainThread]: Parsing macros/adapters/schema.sql
10:29:03.793462 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
10:29:03.797295 [debug] [MainThread]: Parsing macros/materializations/configs.sql
10:29:03.799658 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
10:29:03.815867 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
10:29:03.821955 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
10:29:03.823314 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
10:29:03.829748 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
10:29:03.832275 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
10:29:03.834446 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
10:29:03.837071 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
10:29:03.844071 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
10:29:03.845627 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
10:29:03.855496 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
10:29:03.871168 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
10:29:03.885935 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
10:29:03.890460 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
10:29:03.902863 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
10:29:03.913457 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
10:29:03.915179 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
10:29:03.931203 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
10:29:03.932971 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
10:29:03.937149 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
10:29:03.938892 [debug] [MainThread]: Parsing tests/generic/builtin.sql
10:29:03.941743 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
10:29:03.944673 [debug] [MainThread]: Parsing macros/generate_source.sql
10:29:03.950984 [debug] [MainThread]: Parsing macros/generate_base_model.sql
10:29:03.953925 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
10:29:03.955237 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
10:29:03.956651 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
10:29:03.962340 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
10:29:03.965674 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
10:29:03.975054 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
10:29:03.979749 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
10:29:03.980982 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
10:29:03.982504 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
10:29:03.983932 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
10:29:03.985000 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
10:29:03.986466 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
10:29:03.988386 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
10:29:03.990463 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
10:29:03.992020 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
10:29:03.993020 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
10:29:03.994143 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
10:29:03.995195 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
10:29:03.998442 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
10:29:03.999983 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
10:29:04.002769 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
10:29:04.003725 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
10:29:04.005944 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
10:29:04.011674 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
10:29:04.012979 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
10:29:04.021609 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
10:29:04.023452 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
10:29:04.024711 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
10:29:04.026117 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
10:29:04.027382 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
10:29:04.030105 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
10:29:04.032243 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
10:29:04.034626 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
10:29:04.038478 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
10:29:04.040425 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
10:29:04.042099 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
10:29:04.044145 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
10:29:04.045826 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
10:29:04.054356 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
10:29:04.056536 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
10:29:04.057968 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
10:29:04.060768 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
10:29:04.062505 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
10:29:04.064281 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
10:29:04.065572 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
10:29:04.066770 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
10:29:04.067926 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
10:29:04.069121 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
10:29:04.071404 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
10:29:04.072973 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
10:29:04.080914 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
10:29:04.086521 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
10:29:04.093362 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
10:29:04.095052 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
10:29:04.098479 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
10:29:04.100109 [debug] [MainThread]: Parsing macros/sql/pivot.sql
10:29:04.104384 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
10:29:04.110138 [debug] [MainThread]: Parsing macros/sql/groupby.sql
10:29:04.111535 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
10:29:04.117704 [debug] [MainThread]: Parsing macros/sql/star.sql
10:29:04.121024 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
10:29:04.124364 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
10:29:04.127091 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
10:29:04.131440 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
10:29:04.133092 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
10:29:04.137128 [debug] [MainThread]: Parsing macros/sql/union.sql
10:29:04.147710 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
10:29:04.150973 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
10:29:04.152549 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
10:29:04.175166 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
10:29:04.177190 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
10:29:04.178742 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
10:29:04.540430 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
10:29:04.592732 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
10:29:04.687018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a30bff-f719-40bc-bf93-489f6203a966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a6ccd60>]}
10:29:04.694894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a30bff-f719-40bc-bf93-489f6203a966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a71dac0>]}
10:29:04.695219 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
10:29:04.695483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a30bff-f719-40bc-bf93-489f6203a966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a733310>]}
10:29:04.696791 [info ] [MainThread]: 
10:29:04.697347 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:29:04.698251 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
10:29:04.703716 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:29:04.722900 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
10:29:04.725894 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:29:04.727086 [debug] [ThreadPool]: On list_schemas: Close
10:29:04.728082 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
10:29:04.733358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:29:04.743519 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
10:29:04.747636 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:29:04.748716 [debug] [ThreadPool]: On list_None_homework_db: Close
10:29:04.749228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a30bff-f719-40bc-bf93-489f6203a966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a605040>]}
10:29:04.749713 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:29:04.749982 [info ] [MainThread]: 
10:29:04.753174 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
10:29:04.753472 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
10:29:04.753932 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
10:29:04.754090 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
10:29:04.754209 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
10:29:04.773573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:29:04.783934 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
10:29:04.787466 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:29:04.790667 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
10:29:04.794383 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:29:04.797632 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
10:29:04.800921 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:29:04.803966 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
10:29:04.807289 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:29:04.808760 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
10:29:04.809176 [debug] [Thread-1  ]: finished collecting timing info
10:29:04.809339 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
10:29:04.828605 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
10:29:04.835927 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
10:29:04.837088 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
10:29:04.843363 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
10:29:04.845866 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
10:29:04.852877 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
10:29:04.853957 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
10:29:04.860423 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
10:29:04.883283 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
10:29:04.883802 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT

     md5(cast(coalesce(cast(LO_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    string
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    string
), '') as 
    string
)) AS Surrogate_key
    ,
    ,
    ,
    ,

FROM homework_db.src_lineorder AS l
INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
10:29:04.889209 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 581 (',') (line 28, col 5): ,\n    ,\n    ,\n\nFROM homework_db.src_lineorder AS l\nINNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\nINNER JOIN homework_db.s
10:29:04.889449 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
10:29:04.889750 [debug] [Thread-1  ]: finished collecting timing info
10:29:04.890059 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 581 (',') (line 28, col 5): ,\n    ,\n    ,\n\nFROM homework_db.src_lineorder AS l\nINNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\nINNER JOIN homework_db.s
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
10:29:04.890334 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a30bff-f719-40bc-bf93-489f6203a966', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48283a6c40>]}
10:29:04.890690 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 0.14s]
10:29:04.891162 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
10:29:04.892300 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:29:04.892673 [info ] [MainThread]: 
10:29:04.892932 [info ] [MainThread]: Finished running 1 table model in 0.20s.
10:29:04.893151 [debug] [MainThread]: Connection 'master' was properly closed.
10:29:04.893308 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
10:29:04.901008 [info ] [MainThread]: 
10:29:04.901245 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
10:29:04.901495 [info ] [MainThread]: 
10:29:04.901770 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
10:29:04.902013 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
10:29:04.902194 [error] [MainThread]:    b"Code: 62. DB::Exception: Syntax error: failed at position 581 (',') (line 28, col 5): ,\n    ,\n    ,\n\nFROM homework_db.src_lineorder AS l\nINNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\nINNER JOIN homework_db.s
10:29:04.902374 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
10:29:04.902605 [info ] [MainThread]: 
10:29:04.902804 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
10:29:04.903160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482a699040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4829bf79a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4829bf7f70>]}


============================== 2022-06-10 10:31:09.005897 | dbe5ee9b-7596-4946-b62b-2ea20045e8b6 ==============================
10:31:09.005911 [info ] [MainThread]: Running with dbt=1.1.0
10:31:09.006304 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
10:31:09.006454 [debug] [MainThread]: Tracking: tracking
10:31:09.015316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514eea9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514eea9100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514eea9160>]}
10:31:09.016915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514eea91c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514eea9220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f514eea9160>]}


============================== 2022-06-10 10:32:35.261919 | 25617670-757d-4d0a-8fa8-11c2075fa0d6 ==============================
10:32:35.261938 [info ] [MainThread]: Running with dbt=1.1.0
10:32:35.262454 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:32:35.262663 [debug] [MainThread]: Tracking: tracking
10:32:35.272252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa2db4700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa2db47f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa2db4820>]}
10:32:35.296439 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
10:32:35.296802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '25617670-757d-4d0a-8fa8-11c2075fa0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa2d5bb50>]}
10:32:35.313229 [debug] [MainThread]: Parsing macros/init_s3_source.sql
10:32:35.316916 [debug] [MainThread]: Parsing macros/catalog.sql
10:32:35.318398 [debug] [MainThread]: Parsing macros/adapters.sql
10:32:35.352471 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
10:32:35.353458 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
10:32:35.378389 [debug] [MainThread]: Parsing macros/materializations/seed.sql
10:32:35.382310 [debug] [MainThread]: Parsing macros/materializations/test.sql
10:32:35.383525 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
10:32:35.410375 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
10:32:35.412692 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
10:32:35.414079 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
10:32:35.415496 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
10:32:35.416746 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
10:32:35.417382 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
10:32:35.418122 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
10:32:35.418885 [debug] [MainThread]: Parsing macros/etc/datetime.sql
10:32:35.426989 [debug] [MainThread]: Parsing macros/etc/statement.sql
10:32:35.431350 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
10:32:35.435648 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
10:32:35.438538 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
10:32:35.445790 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
10:32:35.448480 [debug] [MainThread]: Parsing macros/adapters/columns.sql
10:32:35.457800 [debug] [MainThread]: Parsing macros/adapters/relation.sql
10:32:35.467102 [debug] [MainThread]: Parsing macros/adapters/schema.sql
10:32:35.469269 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
10:32:35.473065 [debug] [MainThread]: Parsing macros/materializations/configs.sql
10:32:35.475402 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
10:32:35.491302 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
10:32:35.496990 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
10:32:35.498268 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
10:32:35.505050 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
10:32:35.507685 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
10:32:35.509867 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
10:32:35.512509 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
10:32:35.519813 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
10:32:35.521508 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
10:32:35.531537 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
10:32:35.547377 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
10:32:35.562499 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
10:32:35.566787 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
10:32:35.579154 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
10:32:35.589743 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
10:32:35.591432 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
10:32:35.607097 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
10:32:35.608849 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
10:32:35.612939 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
10:32:35.614659 [debug] [MainThread]: Parsing tests/generic/builtin.sql
10:32:35.617388 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
10:32:35.620304 [debug] [MainThread]: Parsing macros/generate_source.sql
10:32:35.627096 [debug] [MainThread]: Parsing macros/generate_base_model.sql
10:32:35.630053 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
10:32:35.631345 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
10:32:35.632740 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
10:32:35.638327 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
10:32:35.641863 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
10:32:35.651600 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
10:32:35.656507 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
10:32:35.657751 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
10:32:35.659436 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
10:32:35.661079 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
10:32:35.662390 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
10:32:35.664293 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
10:32:35.666425 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
10:32:35.668720 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
10:32:35.670322 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
10:32:35.671331 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
10:32:35.672509 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
10:32:35.673623 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
10:32:35.676983 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
10:32:35.678592 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
10:32:35.681453 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
10:32:35.682427 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
10:32:35.684655 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
10:32:35.690469 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
10:32:35.691736 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
10:32:35.700057 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
10:32:35.701909 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
10:32:35.703197 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
10:32:35.704706 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
10:32:35.705997 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
10:32:35.708915 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
10:32:35.711166 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
10:32:35.713622 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
10:32:35.717655 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
10:32:35.719678 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
10:32:35.721392 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
10:32:35.723511 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
10:32:35.725211 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
10:32:35.733791 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
10:32:35.736021 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
10:32:35.737446 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
10:32:35.740282 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
10:32:35.742107 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
10:32:35.743944 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
10:32:35.745266 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
10:32:35.746515 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
10:32:35.747649 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
10:32:35.748832 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
10:32:35.751068 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
10:32:35.752611 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
10:32:35.760318 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
10:32:35.765880 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
10:32:35.772870 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
10:32:35.774552 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
10:32:35.778061 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
10:32:35.779736 [debug] [MainThread]: Parsing macros/sql/pivot.sql
10:32:35.783961 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
10:32:35.789674 [debug] [MainThread]: Parsing macros/sql/groupby.sql
10:32:35.791027 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
10:32:35.797087 [debug] [MainThread]: Parsing macros/sql/star.sql
10:32:35.800110 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
10:32:35.803290 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
10:32:35.805956 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
10:32:35.810208 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
10:32:35.811848 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
10:32:35.815759 [debug] [MainThread]: Parsing macros/sql/union.sql
10:32:35.826062 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
10:32:35.829517 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
10:32:35.831222 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
10:32:35.855112 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
10:32:35.857256 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
10:32:35.858876 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
10:32:36.218880 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
10:32:36.271627 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
10:32:36.362729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25617670-757d-4d0a-8fa8-11c2075fa0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa2dfd970>]}
10:32:36.370432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25617670-757d-4d0a-8fa8-11c2075fa0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa2ddd9d0>]}
10:32:36.370770 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
10:32:36.371042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25617670-757d-4d0a-8fa8-11c2075fa0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa2d6e070>]}
10:32:36.372225 [info ] [MainThread]: 
10:32:36.372761 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:32:36.373637 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
10:32:36.379184 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:32:36.398609 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
10:32:36.401476 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:32:36.402628 [debug] [ThreadPool]: On list_schemas: Close
10:32:36.403589 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
10:32:36.408629 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:32:36.416182 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
10:32:36.419288 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:32:36.420289 [debug] [ThreadPool]: On list_None_homework_db: Close
10:32:36.420815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25617670-757d-4d0a-8fa8-11c2075fa0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa2c61fd0>]}
10:32:36.421276 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:32:36.421541 [info ] [MainThread]: 
10:32:36.424763 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
10:32:36.425078 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
10:32:36.425505 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
10:32:36.425651 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
10:32:36.425796 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
10:32:36.445264 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:32:36.454204 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
10:32:36.457398 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:32:36.460584 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
10:32:36.463565 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:32:36.466611 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
10:32:36.469635 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:32:36.472584 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
10:32:36.475692 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:32:36.477141 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
10:32:36.477581 [debug] [Thread-1  ]: finished collecting timing info
10:32:36.477761 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
10:32:36.496968 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
10:32:36.514992 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
10:32:36.516231 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
10:32:36.522200 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
10:32:36.526007 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
10:32:36.533736 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
10:32:36.534813 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
10:32:36.541149 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
10:32:36.563358 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
10:32:36.563856 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT

     MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
))
    ,
    ,
    ,
    ,

FROM homework_db.src_lineorder AS l
INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
10:32:36.568695 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 564 (',') (line 28, col 5): ,\n    ,\n    ,\n\nFROM homework_db.src_lineorder AS l\nINNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\nINNER JOIN homework_db.s
10:32:36.568860 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
10:32:36.569153 [debug] [Thread-1  ]: finished collecting timing info
10:32:36.569468 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 564 (',') (line 28, col 5): ,\n    ,\n    ,\n\nFROM homework_db.src_lineorder AS l\nINNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\nINNER JOIN homework_db.s
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
10:32:36.569711 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25617670-757d-4d0a-8fa8-11c2075fa0d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa0a70c10>]}
10:32:36.570048 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 0.14s]
10:32:36.570476 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
10:32:36.571606 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:32:36.571942 [info ] [MainThread]: 
10:32:36.572211 [info ] [MainThread]: Finished running 1 table model in 0.20s.
10:32:36.572480 [debug] [MainThread]: Connection 'master' was properly closed.
10:32:36.572644 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
10:32:36.580423 [info ] [MainThread]: 
10:32:36.580709 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
10:32:36.581026 [info ] [MainThread]: 
10:32:36.581289 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
10:32:36.581539 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
10:32:36.581768 [error] [MainThread]:    b"Code: 62. DB::Exception: Syntax error: failed at position 564 (',') (line 28, col 5): ,\n    ,\n    ,\n\nFROM homework_db.src_lineorder AS l\nINNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\nINNER JOIN homework_db.s
10:32:36.581996 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
10:32:36.582250 [info ] [MainThread]: 
10:32:36.582512 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
10:32:36.582871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa22b8df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa22b8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbfa22b8a30>]}


============================== 2022-06-10 10:38:02.095336 | a9323d07-01d0-4b2d-b2f9-c5f09ec096d9 ==============================
10:38:02.095355 [info ] [MainThread]: Running with dbt=1.1.0
10:38:02.095908 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:38:02.096072 [debug] [MainThread]: Tracking: tracking
10:38:02.105456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5432096700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5432096850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5432096880>]}
10:38:02.156001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
10:38:02.156325 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
10:38:02.162567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a9323d07-01d0-4b2d-b2f9-c5f09ec096d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5431ed0e20>]}
10:38:02.170885 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a9323d07-01d0-4b2d-b2f9-c5f09ec096d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5431f6a700>]}
10:38:02.171221 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
10:38:02.171483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9323d07-01d0-4b2d-b2f9-c5f09ec096d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5431f6aa90>]}
10:38:02.173160 [info ] [MainThread]: 
10:38:02.173745 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:38:02.174661 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
10:38:02.184545 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:38:02.202720 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
10:38:02.205297 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.206604 [debug] [ThreadPool]: On list_schemas: Close
10:38:02.207598 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
10:38:02.213130 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:38:02.221275 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
10:38:02.224542 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.225740 [debug] [ThreadPool]: On list_None_homework_db: Close
10:38:02.226352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a9323d07-01d0-4b2d-b2f9-c5f09ec096d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543160a310>]}
10:38:02.226844 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:38:02.227136 [info ] [MainThread]: 
10:38:02.230250 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
10:38:02.230558 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
10:38:02.230981 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
10:38:02.231259 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
10:38:02.231418 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
10:38:02.275753 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
10:38:02.285420 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
10:38:02.289112 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.297900 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
10:38:02.301804 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.307733 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
10:38:02.311584 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.317130 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
10:38:02.320711 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.324908 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
10:38:02.325292 [debug] [Thread-1  ]: finished collecting timing info
10:38:02.325489 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
10:38:02.350075 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
10:38:02.353505 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.354705 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
10:38:02.357214 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.358314 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
10:38:02.360613 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.361642 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
10:38:02.363914 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:38:02.387953 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
10:38:02.388472 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

SELECT

     MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
))
    ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
    ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
    ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
    ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

FROM homework_db.src_lineorder AS l
INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
10:38:13.439480 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
10:38:13.439683 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
10:38:13.440002 [debug] [Thread-1  ]: finished collecting timing info
10:38:13.440339 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
10:38:13.440611 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a9323d07-01d0-4b2d-b2f9-c5f09ec096d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54304f6b50>]}
10:38:13.440941 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 11.21s]
10:38:13.441470 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
10:38:13.442629 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:38:13.443008 [info ] [MainThread]: 
10:38:13.443275 [info ] [MainThread]: Finished running 1 table model in 11.27s.
10:38:13.443531 [debug] [MainThread]: Connection 'master' was properly closed.
10:38:13.443693 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
10:38:13.451478 [info ] [MainThread]: 
10:38:13.451715 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
10:38:13.452014 [info ] [MainThread]: 
10:38:13.452296 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
10:38:13.452643 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
10:38:13.452865 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
10:38:13.453128 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
10:38:13.453398 [info ] [MainThread]: 
10:38:13.453691 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
10:38:13.454058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543051fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f543051fc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f54315fd520>]}


============================== 2022-06-10 10:53:14.115706 | a3f397af-e39e-4dca-8d69-381a88046d76 ==============================
10:53:14.115723 [info ] [MainThread]: Running with dbt=1.1.0
10:53:14.116205 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:53:14.116356 [debug] [MainThread]: Tracking: tracking
10:53:14.125531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd882ca26d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd882ca2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd882ca2850>]}
10:53:14.174807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
10:53:14.175268 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
10:53:14.187300 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
10:53:14.193820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd882b8fc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd882a92a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd882a928e0>]}


============================== 2022-06-10 10:58:12.939831 | 5651df0a-c384-428d-8d89-bc97d290b81f ==============================
10:58:12.939850 [info ] [MainThread]: Running with dbt=1.1.0
10:58:12.940344 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
10:58:12.940561 [debug] [MainThread]: Tracking: tracking
10:58:12.949852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff808e82760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff808e828b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff808e828e0>]}
10:58:13.000444 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
10:58:13.000937 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
10:58:13.013314 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
10:58:13.067541 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
10:58:13.078323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5651df0a-c384-428d-8d89-bc97d290b81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff808c40790>]}
10:58:13.086882 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5651df0a-c384-428d-8d89-bc97d290b81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff808c17a90>]}
10:58:13.087227 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
10:58:13.087504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5651df0a-c384-428d-8d89-bc97d290b81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff808cff910>]}
10:58:13.088923 [info ] [MainThread]: 
10:58:13.089460 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:58:13.090317 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
10:58:13.095503 [debug] [ThreadPool]: Opening a new connection, currently in state init
10:58:13.114460 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
10:58:13.117036 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:58:13.118254 [debug] [ThreadPool]: On list_schemas: Close
10:58:13.119265 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
10:58:13.124573 [debug] [ThreadPool]: Opening a new connection, currently in state closed
10:58:13.132591 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
10:58:13.136113 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
10:58:13.137263 [debug] [ThreadPool]: On list_None_homework_db: Close
10:58:13.137873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5651df0a-c384-428d-8d89-bc97d290b81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff808bcf190>]}
10:58:13.138303 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
10:58:13.138538 [info ] [MainThread]: 
10:58:13.141344 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
10:58:13.141654 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
10:58:13.142121 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
10:58:13.142342 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
10:58:13.142494 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
10:58:13.149980 [debug] [Thread-1  ]: finished collecting timing info
10:58:13.150325 [error] [Thread-1  ]: [31mUnhandled error while executing model.dbt_starschema_2.lineorder_flat[0m
get_relation() missing 1 required positional argument: 'database'
10:58:13.150602 [debug] [Thread-1  ]: 
10:58:13.150868 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5651df0a-c384-428d-8d89-bc97d290b81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff808356f70>]}
10:58:13.151200 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 0.01s]
10:58:13.151549 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
10:58:13.152699 [debug] [MainThread]: Acquiring new clickhouse connection "master"
10:58:13.153010 [info ] [MainThread]: 
10:58:13.153239 [info ] [MainThread]: Finished running 1 table model in 0.06s.
10:58:13.153496 [debug] [MainThread]: Connection 'master' was properly closed.
10:58:13.153640 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
10:58:13.161613 [info ] [MainThread]: 
10:58:13.161868 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
10:58:13.162165 [info ] [MainThread]: 
10:58:13.162415 [error] [MainThread]: [33mget_relation() missing 1 required positional argument: 'database'[0m
10:58:13.162657 [info ] [MainThread]: 
10:58:13.162927 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
10:58:13.163259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80834ca60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80834c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff80834c760>]}


============================== 2022-06-10 11:00:04.089296 | 795744f0-65eb-49c4-8f59-2cdbc02019fa ==============================
11:00:04.089313 [info ] [MainThread]: Running with dbt=1.1.0
11:00:04.089844 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:00:04.089999 [debug] [MainThread]: Tracking: tracking
11:00:04.099297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61699c8700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61699c87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61699c8820>]}
11:00:04.150595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:00:04.151103 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
11:00:04.164102 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
11:00:04.167314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61698b4c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61697b6a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61697b6af0>]}


============================== 2022-06-10 11:00:25.403516 | 6ead5c38-c438-4167-9738-1e4cb3d156db ==============================
11:00:25.403534 [info ] [MainThread]: Running with dbt=1.1.0
11:00:25.404005 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:00:25.404220 [debug] [MainThread]: Tracking: tracking
11:00:25.413233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c3a2a700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c3a2a7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c3a2a820>]}
11:00:25.462807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:00:25.463309 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
11:00:25.475899 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
11:00:25.531117 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
11:00:25.541427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6ead5c38-c438-4167-9738-1e4cb3d156db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c37f06d0>]}
11:00:25.549743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6ead5c38-c438-4167-9738-1e4cb3d156db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c37c5f70>]}
11:00:25.550086 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
11:00:25.550347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ead5c38-c438-4167-9738-1e4cb3d156db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c38ac850>]}
11:00:25.551755 [info ] [MainThread]: 
11:00:25.552288 [debug] [MainThread]: Acquiring new clickhouse connection "master"
11:00:25.553153 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
11:00:25.558189 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:00:25.576167 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
11:00:25.578791 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.580038 [debug] [ThreadPool]: On list_schemas: Close
11:00:25.580986 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
11:00:25.586293 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:00:25.594021 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
11:00:25.597632 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.598795 [debug] [ThreadPool]: On list_None_homework_db: Close
11:00:25.599419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6ead5c38-c438-4167-9738-1e4cb3d156db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c37880d0>]}
11:00:25.599889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:00:25.600164 [info ] [MainThread]: 
11:00:25.603031 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
11:00:25.603318 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
11:00:25.603743 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
11:00:25.603933 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
11:00:25.604068 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
11:00:25.623846 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:00:25.631899 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
11:00:25.635427 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.642208 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
11:00:25.645568 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.650407 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
11:00:25.653905 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.658554 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
11:00:25.662101 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.665398 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
11:00:25.665727 [debug] [Thread-1  ]: finished collecting timing info
11:00:25.665906 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
11:00:25.686653 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */
drop table if exists homework_db.lineorder_flat__dbt_tmp 
  ...
11:00:25.690282 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.696324 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
11:00:25.699010 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.700118 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
11:00:25.703833 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.704866 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
11:00:25.707196 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.708167 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
11:00:25.710404 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:00:25.731737 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
11:00:25.732187 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    





  SELECT

      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY


  )...
11:05:25.840417 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
11:05:25.840713 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
11:05:25.841044 [debug] [Thread-1  ]: finished collecting timing info
11:05:25.841386 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
11:05:25.841678 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6ead5c38-c438-4167-9738-1e4cb3d156db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c1639eb0>]}
11:05:25.842051 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 300.24s]
11:05:25.842504 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
11:05:25.843718 [debug] [MainThread]: Acquiring new clickhouse connection "master"
11:05:25.844145 [info ] [MainThread]: 
11:05:25.844385 [info ] [MainThread]: Finished running 1 table model in 300.29s.
11:05:25.844660 [debug] [MainThread]: Connection 'master' was properly closed.
11:05:25.844814 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
11:05:25.853290 [info ] [MainThread]: 
11:05:25.853574 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:05:25.853908 [info ] [MainThread]: 
11:05:25.854150 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
11:05:25.854417 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
11:05:25.854670 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
11:05:25.854940 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
11:05:25.855208 [info ] [MainThread]: 
11:05:25.855472 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
11:05:25.855853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c1631940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c1658c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97c164da30>]}


============================== 2022-06-10 11:14:10.493116 | f59e62a1-e56d-4d9f-979a-67f60dbe09ad ==============================
11:14:10.493135 [info ] [MainThread]: Running with dbt=1.1.0
11:14:10.493673 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:14:10.493833 [debug] [MainThread]: Tracking: tracking
11:14:10.503123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861fc43670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861fc437c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861fc437f0>]}
11:14:10.553601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:14:10.554152 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
11:14:10.566981 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
11:14:10.570118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861fb29c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861fa2ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f861fa2bac0>]}


============================== 2022-06-10 11:28:52.891060 | 4bc8f585-5a1d-44c2-b519-a24ab6e5b78d ==============================
11:28:52.891077 [info ] [MainThread]: Running with dbt=1.1.0
11:28:52.891588 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:28:52.891780 [debug] [MainThread]: Tracking: tracking
11:28:52.900615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912b3f9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912b3f9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912b3f98b0>]}
11:28:52.950413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:28:52.950880 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
11:28:52.963338 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
11:28:52.966502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912b2cdcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912b1e2af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f912b1e2b80>]}


============================== 2022-06-10 11:29:26.621123 | 662a5800-3982-4bf3-bd3d-fe8e61ce745b ==============================
11:29:26.621143 [info ] [MainThread]: Running with dbt=1.1.0
11:29:26.621643 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:29:26.621792 [debug] [MainThread]: Tracking: tracking
11:29:26.630812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28122e07f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28122e08e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28122e0910>]}
11:29:26.680579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:29:26.681068 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
11:29:26.693643 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
11:29:26.697499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28121b3d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28120c7b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f28120c7be0>]}


============================== 2022-06-10 11:29:44.948722 | 9ad91d45-2ee8-40c0-aba0-12723a4675d4 ==============================
11:29:44.948740 [info ] [MainThread]: Running with dbt=1.1.0
11:29:44.949259 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:29:44.949415 [debug] [MainThread]: Tracking: tracking
11:29:44.958566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2355876730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2355876820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2355876850>]}
11:29:45.008390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:29:45.008908 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
11:29:45.021146 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
11:29:45.076775 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
11:29:45.087844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ad91d45-2ee8-40c0-aba0-12723a4675d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2355635190>]}
11:29:45.104916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ad91d45-2ee8-40c0-aba0-12723a4675d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23556745b0>]}
11:29:45.105277 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
11:29:45.105546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad91d45-2ee8-40c0-aba0-12723a4675d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23556f3880>]}
11:29:45.106902 [info ] [MainThread]: 
11:29:45.107471 [debug] [MainThread]: Acquiring new clickhouse connection "master"
11:29:45.108404 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
11:29:45.113824 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:29:45.138516 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
11:29:45.141034 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.142270 [debug] [ThreadPool]: On list_schemas: Close
11:29:45.143263 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
11:29:45.148725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:29:45.156175 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
11:29:45.159497 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.160669 [debug] [ThreadPool]: On list_None_homework_db: Close
11:29:45.161306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ad91d45-2ee8-40c0-aba0-12723a4675d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23555cd100>]}
11:29:45.161765 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:29:45.162042 [info ] [MainThread]: 
11:29:45.164944 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
11:29:45.165234 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
11:29:45.165671 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
11:29:45.165874 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
11:29:45.166006 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
11:29:45.186732 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:29:45.194490 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
11:29:45.197942 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.204581 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
11:29:45.208040 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.212736 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
11:29:45.216140 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.220668 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
11:29:45.223591 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.226821 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
11:29:45.227165 [debug] [Thread-1  ]: finished collecting timing info
11:29:45.227351 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
11:29:45.248138 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */
drop table if exists homework_db.lineorder_flat__dbt_tmp 
  ...
11:29:45.251828 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.257720 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
11:29:45.260604 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.261705 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
11:29:45.265725 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.266725 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
11:29:45.269084 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.270058 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
11:29:45.272525 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:29:45.293314 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
11:29:45.293755 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    





  SELECT

      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY


  )...
11:34:45.362926 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
11:34:45.363134 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
11:34:45.363454 [debug] [Thread-1  ]: finished collecting timing info
11:34:45.363877 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
11:34:45.364188 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9ad91d45-2ee8-40c0-aba0-12723a4675d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2354485d00>]}
11:34:45.364565 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 300.20s]
11:34:45.365104 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
11:34:45.366422 [debug] [MainThread]: Acquiring new clickhouse connection "master"
11:34:45.366815 [info ] [MainThread]: 
11:34:45.367050 [info ] [MainThread]: Finished running 1 table model in 300.26s.
11:34:45.367276 [debug] [MainThread]: Connection 'master' was properly closed.
11:34:45.367456 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
11:34:45.375082 [info ] [MainThread]: 
11:34:45.375312 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:34:45.375607 [info ] [MainThread]: 
11:34:45.375839 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
11:34:45.376125 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
11:34:45.376354 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
11:34:45.376615 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
11:34:45.376894 [info ] [MainThread]: 
11:34:45.377149 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
11:34:45.377522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f235447d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23544a2f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23556f3910>]}


============================== 2022-06-10 11:35:37.680286 | 10500cea-4dff-4a1b-8cb8-1278d27185e0 ==============================
11:35:37.680302 [info ] [MainThread]: Running with dbt=1.1.0
11:35:37.680882 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:35:37.681095 [debug] [MainThread]: Tracking: tracking
11:35:37.690335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47208cb730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47208cb880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47208cb8b0>]}
11:35:37.740428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:35:37.740912 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
11:35:37.753218 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
11:35:37.756538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f472079fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47206b4af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47206b4b50>]}


============================== 2022-06-10 11:36:00.649992 | 90c583ec-17a9-4509-963a-0934fc0a971b ==============================
11:36:00.650011 [info ] [MainThread]: Running with dbt=1.1.0
11:36:00.650564 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:36:00.650771 [debug] [MainThread]: Tracking: tracking
11:36:00.660294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafd205670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafd205760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafd205790>]}
11:36:00.712012 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
11:36:00.712532 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
11:36:00.725676 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
11:36:00.735246 [info ] [MainThread]: Parametrs is: Nonehomework_dblineorder_flat
11:36:00.783939 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
11:36:00.794985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90c583ec-17a9-4509-963a-0934fc0a971b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafcfc4190>]}
11:36:00.803795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90c583ec-17a9-4509-963a-0934fc0a971b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafcffa5b0>]}
11:36:00.804164 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
11:36:00.804450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c583ec-17a9-4509-963a-0934fc0a971b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafcfc6f10>]}
11:36:00.805773 [info ] [MainThread]: 
11:36:00.806324 [debug] [MainThread]: Acquiring new clickhouse connection "master"
11:36:00.807211 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
11:36:00.812605 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:36:00.851387 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
11:36:00.854376 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:36:00.855727 [debug] [ThreadPool]: On list_schemas: Close
11:36:00.856837 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
11:36:00.862509 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:36:00.872207 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
11:36:00.876470 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:36:00.877726 [debug] [ThreadPool]: On list_None_homework_db: Close
11:36:00.878400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c583ec-17a9-4509-963a-0934fc0a971b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafcf54100>]}
11:36:00.878877 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:36:00.879159 [info ] [MainThread]: 
11:36:00.882156 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
11:36:00.882469 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
11:36:00.882882 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
11:36:00.883130 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
11:36:00.883280 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
11:36:00.891865 [info ] [Thread-1  ]: Parametrs is: Nonehomework_dbstarschema
11:36:00.906077 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:36:00.915158 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
11:36:00.919517 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:36:00.928019 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
11:36:00.932389 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:36:00.938325 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
11:36:00.942294 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:36:00.947738 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
11:36:00.951736 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:36:00.955987 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
11:36:00.956355 [debug] [Thread-1  ]: finished collecting timing info
11:36:00.956527 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
11:36:00.977520 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */
drop table if exists homework_db.lineorder_flat__dbt_tmp 
  ...
11:36:01.709336 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.73 seconds
11:36:01.715975 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
11:36:01.724360 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
11:36:01.725668 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
11:36:01.734029 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
11:36:01.735148 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
11:36:01.749376 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
11:36:01.750611 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
11:36:01.754202 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:36:01.775367 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
11:36:01.775933 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    







  SELECT

      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY


  )...
11:41:01.963259 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
11:41:01.963596 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
11:41:01.963926 [debug] [Thread-1  ]: finished collecting timing info
11:41:01.964264 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
11:41:01.964574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c583ec-17a9-4509-963a-0934fc0a971b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafc62bf10>]}
11:41:01.964944 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 301.08s]
11:41:01.965410 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
11:41:01.966647 [debug] [MainThread]: Acquiring new clickhouse connection "master"
11:41:01.966991 [info ] [MainThread]: 
11:41:01.967232 [info ] [MainThread]: Finished running 1 table model in 301.16s.
11:41:01.967466 [debug] [MainThread]: Connection 'master' was properly closed.
11:41:01.967603 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
11:41:01.975219 [info ] [MainThread]: 
11:41:01.975482 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:41:01.975849 [info ] [MainThread]: 
11:41:01.976139 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
11:41:01.976435 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
11:41:01.976713 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
11:41:01.976948 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
11:41:01.977198 [info ] [MainThread]: 
11:41:01.977462 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
11:41:01.977853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafc60ca30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafd0817f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffafd081820>]}


============================== 2022-06-10 11:53:40.983419 | 7c86e9b8-c77e-406f-a4be-3df33f58783c ==============================
11:53:40.983434 [info ] [MainThread]: Running with dbt=1.1.0
11:53:40.983814 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
11:53:40.984012 [debug] [MainThread]: Tracking: tracking
11:53:40.993110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff116142610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1161421f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff116142100>]}
11:53:40.994759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1161422b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1161421c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff116142100>]}


============================== 2022-06-10 11:53:48.431789 | 82ce4ff8-e974-4610-a857-0a5e32e8ec71 ==============================
11:53:48.431807 [info ] [MainThread]: Running with dbt=1.1.0
11:53:48.432334 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
11:53:48.432487 [debug] [MainThread]: Tracking: tracking
11:53:48.441738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9cb566d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9cb567c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9cb567f0>]}
11:53:48.465843 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
11:53:48.466179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82ce4ff8-e974-4610-a857-0a5e32e8ec71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9cb06b20>]}
11:53:48.483412 [debug] [MainThread]: Parsing macros/init_s3_source.sql
11:53:48.487312 [debug] [MainThread]: Parsing macros/catalog.sql
11:53:48.488908 [debug] [MainThread]: Parsing macros/adapters.sql
11:53:48.523584 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
11:53:48.524650 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
11:53:48.550173 [debug] [MainThread]: Parsing macros/materializations/seed.sql
11:53:48.553903 [debug] [MainThread]: Parsing macros/materializations/test.sql
11:53:48.555058 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
11:53:48.580383 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
11:53:48.582732 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
11:53:48.584177 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
11:53:48.585704 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
11:53:48.587011 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
11:53:48.587734 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
11:53:48.588562 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
11:53:48.589398 [debug] [MainThread]: Parsing macros/etc/datetime.sql
11:53:48.597524 [debug] [MainThread]: Parsing macros/etc/statement.sql
11:53:48.601875 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
11:53:48.606155 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
11:53:48.609021 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
11:53:48.616329 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
11:53:48.618976 [debug] [MainThread]: Parsing macros/adapters/columns.sql
11:53:48.628271 [debug] [MainThread]: Parsing macros/adapters/relation.sql
11:53:48.637420 [debug] [MainThread]: Parsing macros/adapters/schema.sql
11:53:48.639527 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
11:53:48.643169 [debug] [MainThread]: Parsing macros/materializations/configs.sql
11:53:48.645405 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
11:53:48.661331 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
11:53:48.666969 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
11:53:48.668257 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
11:53:48.674943 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
11:53:48.677602 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
11:53:48.679878 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
11:53:48.682728 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
11:53:48.690139 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
11:53:48.691682 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
11:53:48.701263 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
11:53:48.716539 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
11:53:48.731527 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
11:53:48.735955 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
11:53:48.748065 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
11:53:48.758496 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
11:53:48.760075 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
11:53:48.775718 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
11:53:48.777565 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
11:53:48.781822 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
11:53:48.783572 [debug] [MainThread]: Parsing tests/generic/builtin.sql
11:53:48.786457 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
11:53:48.789610 [debug] [MainThread]: Parsing macros/generate_source.sql
11:53:48.796364 [debug] [MainThread]: Parsing macros/generate_base_model.sql
11:53:48.799102 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
11:53:48.800335 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
11:53:48.801661 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
11:53:48.807080 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
11:53:48.810538 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
11:53:48.820270 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
11:53:48.825338 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
11:53:48.826652 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
11:53:48.828262 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
11:53:48.829715 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
11:53:48.830735 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
11:53:48.832229 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
11:53:48.834173 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
11:53:48.836274 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
11:53:48.837846 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
11:53:48.838855 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
11:53:48.840014 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
11:53:48.841045 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
11:53:48.844201 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
11:53:48.845734 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
11:53:48.848548 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
11:53:48.849512 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
11:53:48.851728 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
11:53:48.857496 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
11:53:48.858793 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
11:53:48.867565 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
11:53:48.869435 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
11:53:48.870679 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
11:53:48.872099 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
11:53:48.873409 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
11:53:48.876263 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
11:53:48.878502 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
11:53:48.880876 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
11:53:48.884624 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
11:53:48.886620 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
11:53:48.888293 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
11:53:48.890405 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
11:53:48.892041 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
11:53:48.900389 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
11:53:48.902499 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
11:53:48.903888 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
11:53:48.906498 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
11:53:48.908166 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
11:53:48.909936 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
11:53:48.911223 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
11:53:48.912464 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
11:53:48.913624 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
11:53:48.914785 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
11:53:48.917090 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
11:53:48.918630 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
11:53:48.926467 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
11:53:48.931864 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
11:53:48.938445 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
11:53:48.940067 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
11:53:48.943333 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
11:53:48.944819 [debug] [MainThread]: Parsing macros/sql/pivot.sql
11:53:48.948775 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
11:53:48.954300 [debug] [MainThread]: Parsing macros/sql/groupby.sql
11:53:48.955611 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
11:53:48.961504 [debug] [MainThread]: Parsing macros/sql/star.sql
11:53:48.964650 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
11:53:48.967790 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
11:53:48.970402 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
11:53:48.974614 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
11:53:48.976215 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
11:53:48.980126 [debug] [MainThread]: Parsing macros/sql/union.sql
11:53:48.990593 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
11:53:48.993968 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
11:53:48.995541 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
11:53:49.018499 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
11:53:49.020507 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
11:53:49.022050 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
11:53:49.382843 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
11:53:49.390771 [info ] [MainThread]: Parametrs is: Nonehomework_dblineorder_flat
11:53:49.437921 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
11:53:49.530864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82ce4ff8-e974-4610-a857-0a5e32e8ec71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9cb8d940>]}
11:53:49.538683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82ce4ff8-e974-4610-a857-0a5e32e8ec71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9cb7cb20>]}
11:53:49.538990 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
11:53:49.539226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ce4ff8-e974-4610-a857-0a5e32e8ec71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9cb0a040>]}
11:53:49.540435 [info ] [MainThread]: 
11:53:49.540993 [debug] [MainThread]: Acquiring new clickhouse connection "master"
11:53:49.541886 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
11:53:49.547118 [debug] [ThreadPool]: Opening a new connection, currently in state init
11:53:49.566506 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
11:53:49.569213 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:49.570336 [debug] [ThreadPool]: On list_schemas: Close
11:53:49.571308 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
11:53:49.576406 [debug] [ThreadPool]: Opening a new connection, currently in state closed
11:53:49.584367 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
11:53:49.587956 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:49.589157 [debug] [ThreadPool]: On list_None_homework_db: Close
11:53:49.589755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82ce4ff8-e974-4610-a857-0a5e32e8ec71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9cac7490>]}
11:53:49.590212 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
11:53:49.590487 [info ] [MainThread]: 
11:53:49.593597 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
11:53:49.594008 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
11:53:49.594444 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
11:53:49.594589 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
11:53:49.594735 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
11:53:49.603809 [info ] [Thread-1  ]: Parametrs is: Nonehomework_dbstarschema
11:53:49.616185 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
11:53:49.625458 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
11:53:49.629232 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:49.637982 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
11:53:49.642021 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:49.647888 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
11:53:49.651751 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:49.657164 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
11:53:49.660599 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:49.664641 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
11:53:49.665027 [debug] [Thread-1  ]: finished collecting timing info
11:53:49.665197 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
11:53:49.686151 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */
drop table if exists homework_db.lineorder_flat__dbt_tmp 
  ...
11:53:50.271743 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.59 seconds
11:53:50.278203 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
11:53:50.282954 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:50.284047 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
11:53:50.286812 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:50.287875 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
11:53:50.290372 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:50.291426 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
11:53:50.294579 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
11:53:50.316273 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
11:53:50.316788 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    







  SELECT

      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY


  )...
11:58:50.427752 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
11:58:50.427970 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
11:58:50.428297 [debug] [Thread-1  ]: finished collecting timing info
11:58:50.428673 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
11:58:50.428950 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82ce4ff8-e974-4610-a857-0a5e32e8ec71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9ca4bb80>]}
11:58:50.429302 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 300.83s]
11:58:50.429792 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
11:58:50.430892 [debug] [MainThread]: Acquiring new clickhouse connection "master"
11:58:50.431271 [info ] [MainThread]: 
11:58:50.431548 [info ] [MainThread]: Finished running 1 table model in 300.89s.
11:58:50.431786 [debug] [MainThread]: Connection 'master' was properly closed.
11:58:50.431946 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
11:58:50.439878 [info ] [MainThread]: 
11:58:50.440107 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
11:58:50.440374 [info ] [MainThread]: 
11:58:50.440665 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
11:58:50.440914 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
11:58:50.441135 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
11:58:50.441379 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
11:58:50.441654 [info ] [MainThread]: 
11:58:50.441911 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
11:58:50.442279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9ca8c130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9cb0a0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa9c05aeb0>]}


============================== 2022-06-10 12:02:01.626895 | 3e8718a3-57c2-422f-a8b5-858a27ed67dd ==============================
12:02:01.626909 [info ] [MainThread]: Running with dbt=1.1.0
12:02:01.627285 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
12:02:01.627419 [debug] [MainThread]: Tracking: tracking
12:02:01.636394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d50eaea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d50eaeb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d50eae640>]}
12:02:01.638052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d50eae1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d50eaea60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d50eae640>]}


============================== 2022-06-10 12:02:34.997857 | 980830d8-7ea9-4644-b1b9-e1d45ac0de9c ==============================
12:02:34.997877 [info ] [MainThread]: Running with dbt=1.1.0
12:02:34.998402 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:02:34.998609 [debug] [MainThread]: Tracking: tracking
12:02:35.008065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba77a640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba77a730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba77a760>]}
12:02:35.033920 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:02:35.034263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '980830d8-7ea9-4644-b1b9-e1d45ac0de9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba72adf0>]}
12:02:35.052051 [debug] [MainThread]: Parsing macros/init_s3_source.sql
12:02:35.056084 [debug] [MainThread]: Parsing macros/catalog.sql
12:02:35.057657 [debug] [MainThread]: Parsing macros/adapters.sql
12:02:35.092737 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
12:02:35.093764 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:02:35.119038 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:02:35.122766 [debug] [MainThread]: Parsing macros/materializations/test.sql
12:02:35.123909 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:02:35.149991 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:02:35.152408 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:02:35.153863 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:02:35.155416 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:02:35.156781 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:02:35.157455 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:02:35.158263 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:02:35.159089 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:02:35.167061 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:02:35.171239 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:02:35.175376 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:02:35.178062 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:02:35.184751 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:02:35.187382 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:02:35.197086 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:02:35.206569 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:02:35.208747 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:02:35.212580 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:02:35.214943 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:02:35.231080 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:02:35.237024 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:02:35.238353 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:02:35.245267 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:02:35.247893 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:02:35.250123 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:02:35.252876 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:02:35.260151 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:02:35.261677 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:02:35.271669 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:02:35.287565 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:02:35.302737 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:02:35.307184 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:02:35.319736 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:02:35.330163 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:02:35.331778 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:02:35.347447 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:02:35.349333 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:02:35.353645 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:02:35.355496 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:02:35.358489 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
12:02:35.361687 [debug] [MainThread]: Parsing macros/generate_source.sql
12:02:35.368070 [debug] [MainThread]: Parsing macros/generate_base_model.sql
12:02:35.370827 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:02:35.372100 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:02:35.373392 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:02:35.379002 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:02:35.382247 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:02:35.391875 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:02:35.396986 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:02:35.398258 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:02:35.399856 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:02:35.401322 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:02:35.402341 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:02:35.403860 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:02:35.405794 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:02:35.407857 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:02:35.409410 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:02:35.410414 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:02:35.411527 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:02:35.412574 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:02:35.415793 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:02:35.417322 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:02:35.420145 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:02:35.421132 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:02:35.423312 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:02:35.429072 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:02:35.430270 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:02:35.438584 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:02:35.440366 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:02:35.441563 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:02:35.442921 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:02:35.444175 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:02:35.446995 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:02:35.449189 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:02:35.451654 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:02:35.455678 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:02:35.457664 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:02:35.459286 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:02:35.461379 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:02:35.463031 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:02:35.471644 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:02:35.473779 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:02:35.475144 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:02:35.478021 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:02:35.479760 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:02:35.481628 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:02:35.482911 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:02:35.484066 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:02:35.485187 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:02:35.486393 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:02:35.488731 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:02:35.490347 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:02:35.498417 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:02:35.504138 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:02:35.511156 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:02:35.512904 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:02:35.516357 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:02:35.518012 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:02:35.522474 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:02:35.528353 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:02:35.529703 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:02:35.536129 [debug] [MainThread]: Parsing macros/sql/star.sql
12:02:35.539572 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:02:35.542981 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:02:35.545739 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:02:35.550161 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:02:35.551846 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:02:35.556037 [debug] [MainThread]: Parsing macros/sql/union.sql
12:02:35.566757 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:02:35.570101 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:02:35.571755 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:02:35.595807 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:02:35.597915 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:02:35.599502 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:02:35.969227 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:02:36.023470 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:02:36.121074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '980830d8-7ea9-4644-b1b9-e1d45ac0de9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba74e970>]}
12:02:36.128633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '980830d8-7ea9-4644-b1b9-e1d45ac0de9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba79fa90>]}
12:02:36.128953 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:02:36.129178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '980830d8-7ea9-4644-b1b9-e1d45ac0de9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba754f40>]}
12:02:36.130421 [info ] [MainThread]: 
12:02:36.130896 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:02:36.131764 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
12:02:36.136988 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:02:36.156466 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
12:02:36.159406 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:02:36.160653 [debug] [ThreadPool]: On list_schemas: Close
12:02:36.161684 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
12:02:36.166817 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:02:36.176009 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
12:02:36.181017 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:02:36.182140 [debug] [ThreadPool]: On list_None_homework_db: Close
12:02:36.182706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '980830d8-7ea9-4644-b1b9-e1d45ac0de9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba67c460>]}
12:02:36.183138 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:02:36.183397 [info ] [MainThread]: 
12:02:36.186616 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
12:02:36.186946 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.starschema ................................ [RUN]
12:02:36.187577 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
12:02:36.187751 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
12:02:36.187906 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
12:02:36.208852 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:02:36.224323 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
12:02:36.228273 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:02:36.237028 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
12:02:36.240849 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:02:36.246753 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
12:02:36.256510 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:02:36.262427 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
12:02:36.268310 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:02:36.272701 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
12:02:36.273117 [debug] [Thread-1  ]: finished collecting timing info
12:02:36.273301 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
12:02:36.294055 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
12:02:36.298774 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:02:36.300149 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
12:02:36.304038 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:02:36.305196 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
12:02:36.308119 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:02:36.309215 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
12:02:36.312211 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:02:36.336615 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
12:02:36.337075 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

'


'

  SELECT

      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY

''
  )...
12:02:36.345943 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 355 (''\n\n\n'') (line 16, col 1): '\n\n\n'\n\n  SELECT\n\n      MD5(cast(coalesce(cast(LO_CUSTKEY as \n    String\n), '') || '-' || coalesce(cast(C_CUSTKEY as \n    String\n), '')
12:02:36.346145 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
12:02:36.346467 [debug] [Thread-1  ]: finished collecting timing info
12:02:36.346786 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 355 (''\n\n\n'') (line 16, col 1): '\n\n\n'\n\n  SELECT\n\n      MD5(cast(coalesce(cast(LO_CUSTKEY as \n    String\n), '') || '-' || coalesce(cast(C_CUSTKEY as \n    String\n), '')
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:02:36.347062 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '980830d8-7ea9-4644-b1b9-e1d45ac0de9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7b9ca2c40>]}
12:02:36.347404 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.starschema ....................... [[31mERROR[0m in 0.16s]
12:02:36.347932 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
12:02:36.349105 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:02:36.349467 [info ] [MainThread]: 
12:02:36.349700 [info ] [MainThread]: Finished running 1 table model in 0.22s.
12:02:36.349950 [debug] [MainThread]: Connection 'master' was properly closed.
12:02:36.350095 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
12:02:36.357841 [info ] [MainThread]: 
12:02:36.358131 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:02:36.358450 [info ] [MainThread]: 
12:02:36.358717 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
12:02:36.358974 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
12:02:36.359209 [error] [MainThread]:    b"Code: 62. DB::Exception: Syntax error: failed at position 355 (''\n\n\n'') (line 16, col 1): '\n\n\n'\n\n  SELECT\n\n      MD5(cast(coalesce(cast(LO_CUSTKEY as \n    String\n), '') || '-' || coalesce(cast(C_CUSTKEY as \n    String\n), '')
12:02:36.359451 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:02:36.359709 [info ] [MainThread]: 
12:02:36.359945 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:02:36.360291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7ba72e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7b844d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7b9c7efd0>]}


============================== 2022-06-10 12:04:49.656835 | 1667fad5-018d-4cff-8e7f-cf857cee55bb ==============================
12:04:49.656851 [info ] [MainThread]: Running with dbt=1.1.0
12:04:49.657205 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
12:04:49.657325 [debug] [MainThread]: Tracking: tracking
12:04:49.666539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f007049f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00704aba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00704ab280>]}
12:04:49.668135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00704ab940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00704ab130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00704ab280>]}


============================== 2022-06-10 12:05:01.639623 | 287c6fc4-e263-41ac-b891-6c70e1bb03ae ==============================
12:05:01.639640 [info ] [MainThread]: Running with dbt=1.1.0
12:05:01.640190 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:05:01.640412 [debug] [MainThread]: Tracking: tracking
12:05:01.649447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48237706d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4823770820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4823770850>]}
12:05:01.674714 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:05:01.675075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '287c6fc4-e263-41ac-b891-6c70e1bb03ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4823723ee0>]}
12:05:01.692359 [debug] [MainThread]: Parsing macros/init_s3_source.sql
12:05:01.696202 [debug] [MainThread]: Parsing macros/catalog.sql
12:05:01.697796 [debug] [MainThread]: Parsing macros/adapters.sql
12:05:01.732016 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
12:05:01.733033 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:05:01.757127 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:05:01.760888 [debug] [MainThread]: Parsing macros/materializations/test.sql
12:05:01.762073 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:05:01.788819 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:05:01.791348 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:05:01.792826 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:05:01.794331 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:05:01.795657 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:05:01.796324 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:05:01.797138 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:05:01.797980 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:05:01.806190 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:05:01.810513 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:05:01.814786 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:05:01.817633 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:05:01.824759 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:05:01.827396 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:05:01.836804 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:05:01.846108 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:05:01.848340 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:05:01.852117 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:05:01.854419 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:05:01.870812 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:05:01.876913 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:05:01.878272 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:05:01.885096 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:05:01.887782 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:05:01.890048 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:05:01.892821 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:05:01.900154 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:05:01.901761 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:05:01.911747 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:05:01.927858 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:05:01.943091 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:05:01.947612 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:05:01.960054 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:05:01.970798 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:05:01.972549 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:05:01.988884 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:05:01.990760 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:05:01.995207 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:05:01.997045 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:05:01.999834 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
12:05:02.002896 [debug] [MainThread]: Parsing macros/generate_source.sql
12:05:02.009664 [debug] [MainThread]: Parsing macros/generate_base_model.sql
12:05:02.012623 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:05:02.013915 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:05:02.015327 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:05:02.021064 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:05:02.024446 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:05:02.034456 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:05:02.039508 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:05:02.040830 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:05:02.042428 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:05:02.043859 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:05:02.044877 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:05:02.046343 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:05:02.048279 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:05:02.050352 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:05:02.051927 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:05:02.052903 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:05:02.054021 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:05:02.055029 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:05:02.058255 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:05:02.059779 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:05:02.062558 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:05:02.063485 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:05:02.065660 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:05:02.071496 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:05:02.072831 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:05:02.081406 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:05:02.083235 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:05:02.084458 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:05:02.085885 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:05:02.087095 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:05:02.089877 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:05:02.092042 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:05:02.094442 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:05:02.098396 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:05:02.100388 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:05:02.102117 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:05:02.104205 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:05:02.105850 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:05:02.114488 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:05:02.116718 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:05:02.118127 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:05:02.120919 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:05:02.122646 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:05:02.124418 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:05:02.125698 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:05:02.126861 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:05:02.127994 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:05:02.129160 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:05:02.131382 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:05:02.132951 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:05:02.140840 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:05:02.146459 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:05:02.153297 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:05:02.154917 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:05:02.158339 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:05:02.159935 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:05:02.164177 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:05:02.169908 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:05:02.171242 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:05:02.177386 [debug] [MainThread]: Parsing macros/sql/star.sql
12:05:02.180660 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:05:02.183942 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:05:02.186624 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:05:02.190937 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:05:02.192572 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:05:02.196564 [debug] [MainThread]: Parsing macros/sql/union.sql
12:05:02.207091 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:05:02.210482 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:05:02.212110 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:05:02.235565 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:05:02.237643 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:05:02.239207 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:05:02.604489 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:05:02.607228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482373b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48235e5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48235e5ca0>]}


============================== 2022-06-10 12:05:41.549757 | bf8a8a6e-8a7e-4968-8f2f-2f41468cf79a ==============================
12:05:41.549774 [info ] [MainThread]: Running with dbt=1.1.0
12:05:41.550248 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:05:41.550446 [debug] [MainThread]: Tracking: tracking
12:05:41.559573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59619316a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5961931790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59619317c0>]}
12:05:41.584110 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:05:41.584446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf8a8a6e-8a7e-4968-8f2f-2f41468cf79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59618e9e50>]}
12:05:41.601908 [debug] [MainThread]: Parsing macros/init_s3_source.sql
12:05:41.605755 [debug] [MainThread]: Parsing macros/catalog.sql
12:05:41.607247 [debug] [MainThread]: Parsing macros/adapters.sql
12:05:41.641915 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
12:05:41.642880 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:05:41.668542 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:05:41.672286 [debug] [MainThread]: Parsing macros/materializations/test.sql
12:05:41.673449 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:05:41.699922 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:05:41.702425 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:05:41.703870 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:05:41.705538 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:05:41.706876 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:05:41.707543 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:05:41.708358 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:05:41.709194 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:05:41.717412 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:05:41.721746 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:05:41.725993 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:05:41.728818 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:05:41.735870 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:05:41.738497 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:05:41.747843 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:05:41.757191 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:05:41.759354 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:05:41.763174 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:05:41.765543 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:05:41.781939 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:05:41.787885 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:05:41.789215 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:05:41.796506 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:05:41.799209 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:05:41.801527 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:05:41.804291 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:05:41.811743 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:05:41.813303 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:05:41.823050 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:05:41.838787 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:05:41.853974 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:05:41.858392 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:05:41.870621 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:05:41.881251 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:05:41.882896 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:05:41.899365 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:05:41.901176 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:05:41.905508 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:05:41.907304 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:05:41.910170 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
12:05:41.913300 [debug] [MainThread]: Parsing macros/generate_source.sql
12:05:41.920038 [debug] [MainThread]: Parsing macros/generate_base_model.sql
12:05:41.922929 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:05:41.924203 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:05:41.925583 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:05:41.931141 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:05:41.934904 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:05:41.944795 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:05:41.949820 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:05:41.951081 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:05:41.952711 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:05:41.954154 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:05:41.955144 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:05:41.956773 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:05:41.958675 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:05:41.960789 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:05:41.962316 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:05:41.963274 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:05:41.964374 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:05:41.965439 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:05:41.968702 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:05:41.970138 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:05:41.972951 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:05:41.973887 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:05:41.976044 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:05:41.981830 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:05:41.983102 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:05:41.991673 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:05:41.993513 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:05:41.994718 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:05:41.996099 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:05:41.997336 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:05:42.000122 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:05:42.002277 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:05:42.004685 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:05:42.008624 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:05:42.010575 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:05:42.012173 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:05:42.014259 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:05:42.015858 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:05:42.024520 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:05:42.026683 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:05:42.028100 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:05:42.030849 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:05:42.032599 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:05:42.034385 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:05:42.035628 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:05:42.036805 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:05:42.037847 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:05:42.038946 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:05:42.041219 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:05:42.042773 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:05:42.050642 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:05:42.056267 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:05:42.063034 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:05:42.064661 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:05:42.067911 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:05:42.069461 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:05:42.073649 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:05:42.079358 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:05:42.080724 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:05:42.086873 [debug] [MainThread]: Parsing macros/sql/star.sql
12:05:42.090168 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:05:42.093479 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:05:42.096142 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:05:42.100490 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:05:42.102134 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:05:42.106134 [debug] [MainThread]: Parsing macros/sql/union.sql
12:05:42.116779 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:05:42.120064 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:05:42.121635 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:05:42.144906 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:05:42.146887 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:05:42.148402 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:05:42.510161 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:05:42.563793 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:05:42.660103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf8a8a6e-8a7e-4968-8f2f-2f41468cf79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5961974130>]}
12:05:42.667831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf8a8a6e-8a7e-4968-8f2f-2f41468cf79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59619c8c40>]}
12:05:42.668137 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:05:42.668361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf8a8a6e-8a7e-4968-8f2f-2f41468cf79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f596196dbb0>]}
12:05:42.669623 [info ] [MainThread]: 
12:05:42.670114 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:05:42.670997 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
12:05:42.676282 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:05:42.696405 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
12:05:42.699115 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:05:42.700334 [debug] [ThreadPool]: On list_schemas: Close
12:05:42.701377 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
12:05:42.706786 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:05:42.714730 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
12:05:42.718375 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:05:42.719598 [debug] [ThreadPool]: On list_None_homework_db: Close
12:05:42.720213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf8a8a6e-8a7e-4968-8f2f-2f41468cf79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59617ce670>]}
12:05:42.720715 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:05:42.720991 [info ] [MainThread]: 
12:05:42.724051 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
12:05:42.724356 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
12:05:42.724806 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
12:05:42.725030 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
12:05:42.725177 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
12:05:42.745836 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:05:42.757255 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
12:05:42.773806 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
12:05:42.782605 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
12:05:42.786860 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:05:42.792865 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
12:05:42.796633 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:05:42.802283 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
12:05:42.806542 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:05:42.810827 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
12:05:42.811247 [debug] [Thread-1  ]: finished collecting timing info
12:05:42.811432 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
12:05:42.831260 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
12:05:42.834726 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:05:42.837302 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
12:05:42.840123 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:05:42.841219 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
12:05:42.843656 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:05:42.844715 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
12:05:42.847236 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:05:42.870428 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
12:05:42.870993 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

'


'

  SELECT

      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"

  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY

''
  )...
12:05:42.877113 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 355 (''\n\n\n'') (line 16, col 1): '\n\n\n'\n\n  SELECT\n\n      MD5(cast(coalesce(cast(LO_CUSTKEY as \n    String\n), '') || '-' || coalesce(cast(C_CUSTKEY as \n    String\n), '')
12:05:42.877286 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
12:05:42.877562 [debug] [Thread-1  ]: finished collecting timing info
12:05:42.877865 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 355 (''\n\n\n'') (line 16, col 1): '\n\n\n'\n\n  SELECT\n\n      MD5(cast(coalesce(cast(LO_CUSTKEY as \n    String\n), '') || '-' || coalesce(cast(C_CUSTKEY as \n    String\n), '')
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:05:42.878144 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf8a8a6e-8a7e-4968-8f2f-2f41468cf79a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5960e5e940>]}
12:05:42.878506 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 0.15s]
12:05:42.878949 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
12:05:42.880182 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:05:42.880629 [info ] [MainThread]: 
12:05:42.880903 [info ] [MainThread]: Finished running 1 table model in 0.21s.
12:05:42.881166 [debug] [MainThread]: Connection 'master' was properly closed.
12:05:42.881316 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
12:05:42.889019 [info ] [MainThread]: 
12:05:42.889267 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:05:42.889551 [info ] [MainThread]: 
12:05:42.889801 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
12:05:42.890039 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
12:05:42.890264 [error] [MainThread]:    b"Code: 62. DB::Exception: Syntax error: failed at position 355 (''\n\n\n'') (line 16, col 1): '\n\n\n'\n\n  SELECT\n\n      MD5(cast(coalesce(cast(LO_CUSTKEY as \n    String\n), '') || '-' || coalesce(cast(C_CUSTKEY as \n    String\n), '')
12:05:42.890526 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:05:42.890796 [info ] [MainThread]: 
12:05:42.891096 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:05:42.891459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5961745130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59618d9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5960e2cfa0>]}


============================== 2022-06-10 12:06:03.980989 | 20f5e64c-0490-484c-a0f1-a3db5c0cf84b ==============================
12:06:03.981003 [info ] [MainThread]: Running with dbt=1.1.0
12:06:03.981384 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
12:06:03.981529 [debug] [MainThread]: Tracking: tracking
12:06:03.990515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3284c2a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3284c2b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3284c2640>]}
12:06:03.992086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3284c21c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3284c2a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3284c2640>]}


============================== 2022-06-10 12:06:09.289942 | 3d9d3da7-06b2-4ab3-9673-d2b1e3d0c6a9 ==============================
12:06:09.289959 [info ] [MainThread]: Running with dbt=1.1.0
12:06:09.290452 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:06:09.290646 [debug] [MainThread]: Tracking: tracking
12:06:09.299287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b8fbe5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b8fbe6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b8fbe700>]}
12:06:09.323140 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:06:09.323467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3d9d3da7-06b2-4ab3-9673-d2b1e3d0c6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b8f72a30>]}
12:06:09.340654 [debug] [MainThread]: Parsing macros/init_s3_source.sql
12:06:09.344522 [debug] [MainThread]: Parsing macros/catalog.sql
12:06:09.346078 [debug] [MainThread]: Parsing macros/adapters.sql
12:06:09.380142 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
12:06:09.381091 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:06:09.406107 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:06:09.409915 [debug] [MainThread]: Parsing macros/materializations/test.sql
12:06:09.411048 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:06:09.436464 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:06:09.438975 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:06:09.440441 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:06:09.441976 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:06:09.443293 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:06:09.443980 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:06:09.444776 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:06:09.445602 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:06:09.453808 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:06:09.458160 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:06:09.462411 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:06:09.465201 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:06:09.472210 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:06:09.474838 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:06:09.484145 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:06:09.493009 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:06:09.494974 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:06:09.498513 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:06:09.500639 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:06:09.516626 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:06:09.522298 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:06:09.523540 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:06:09.530035 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:06:09.532693 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:06:09.534903 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:06:09.537673 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:06:09.545096 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:06:09.546627 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:06:09.556575 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:06:09.571978 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:06:09.586888 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:06:09.591347 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:06:09.603927 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:06:09.614746 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:06:09.616459 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:06:09.632217 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:06:09.634066 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:06:09.638322 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:06:09.640139 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:06:09.643040 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
12:06:09.646206 [debug] [MainThread]: Parsing macros/generate_source.sql
12:06:09.652991 [debug] [MainThread]: Parsing macros/generate_base_model.sql
12:06:09.655889 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:06:09.657204 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:06:09.658573 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:06:09.664317 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:06:09.667719 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:06:09.677485 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:06:09.682499 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:06:09.683779 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:06:09.685334 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:06:09.686729 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:06:09.687701 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:06:09.689082 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:06:09.690917 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:06:09.692894 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:06:09.694362 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:06:09.695285 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:06:09.696386 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:06:09.697386 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:06:09.700614 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:06:09.702110 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:06:09.704817 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:06:09.705736 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:06:09.707902 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:06:09.713577 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:06:09.714860 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:06:09.723486 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:06:09.725260 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:06:09.726418 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:06:09.727784 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:06:09.728989 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:06:09.731758 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:06:09.733907 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:06:09.736308 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:06:09.740221 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:06:09.742193 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:06:09.743824 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:06:09.745876 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:06:09.747501 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:06:09.756009 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:06:09.758152 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:06:09.759558 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:06:09.762327 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:06:09.764091 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:06:09.765859 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:06:09.767125 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:06:09.768303 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:06:09.769437 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:06:09.770588 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:06:09.772876 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:06:09.774423 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:06:09.782052 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:06:09.787267 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:06:09.794119 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:06:09.795816 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:06:09.799272 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:06:09.800942 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:06:09.805112 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:06:09.810934 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:06:09.812320 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:06:09.818222 [debug] [MainThread]: Parsing macros/sql/star.sql
12:06:09.821439 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:06:09.824751 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:06:09.827478 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:06:09.831729 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:06:09.833328 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:06:09.837278 [debug] [MainThread]: Parsing macros/sql/union.sql
12:06:09.847976 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:06:09.851400 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:06:09.853042 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:06:09.876570 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:06:09.878619 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:06:09.880180 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:06:10.246844 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:06:10.250772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b8f8c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b8e35af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f06b8e35b80>]}


============================== 2022-06-10 12:08:12.160980 | 88b79d1b-2140-45e3-ae86-bc610364724a ==============================
12:08:12.160994 [info ] [MainThread]: Running with dbt=1.1.0
12:08:12.161360 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
12:08:12.161527 [debug] [MainThread]: Tracking: tracking
12:08:12.171159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6098f5a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6098f5ae80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6098f664f0>]}
12:08:12.172105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6098f66130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6098f661f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6098f66040>]}


============================== 2022-06-10 12:08:38.143489 | 1f3321a2-819f-40f6-9059-d032c4f7e44f ==============================
12:08:38.143506 [info ] [MainThread]: Running with dbt=1.1.0
12:08:38.144016 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:08:38.144216 [debug] [MainThread]: Tracking: tracking
12:08:38.153476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf322246a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf322247f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf32224820>]}
12:08:38.178468 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:08:38.178813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f3321a2-819f-40f6-9059-d032c4f7e44f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf321d1eb0>]}
12:08:38.195968 [debug] [MainThread]: Parsing macros/init_s3_source.sql
12:08:38.199871 [debug] [MainThread]: Parsing macros/catalog.sql
12:08:38.201470 [debug] [MainThread]: Parsing macros/adapters.sql
12:08:38.235842 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
12:08:38.236838 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:08:38.262226 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:08:38.266012 [debug] [MainThread]: Parsing macros/materializations/test.sql
12:08:38.267174 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:08:38.294000 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:08:38.296496 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:08:38.297946 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:08:38.299444 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:08:38.300832 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:08:38.301519 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:08:38.302304 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:08:38.303146 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:08:38.311373 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:08:38.315707 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:08:38.320015 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:08:38.322799 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:08:38.329375 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:08:38.331888 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:08:38.341157 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:08:38.350442 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:08:38.352641 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:08:38.356394 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:08:38.358685 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:08:38.374865 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:08:38.380992 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:08:38.382304 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:08:38.389022 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:08:38.391716 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:08:38.393958 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:08:38.396722 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:08:38.404157 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:08:38.405717 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:08:38.415250 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:08:38.430812 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:08:38.445527 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:08:38.449924 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:08:38.462123 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:08:38.472790 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:08:38.474439 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:08:38.490052 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:08:38.491764 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:08:38.496124 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:08:38.498100 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:08:38.501034 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
12:08:38.504145 [debug] [MainThread]: Parsing macros/generate_source.sql
12:08:38.510977 [debug] [MainThread]: Parsing macros/generate_base_model.sql
12:08:38.513906 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:08:38.515187 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:08:38.516574 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:08:38.522274 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:08:38.525628 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:08:38.535347 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:08:38.540355 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:08:38.541597 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:08:38.543199 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:08:38.544647 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:08:38.545653 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:08:38.547123 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:08:38.549034 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:08:38.551042 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:08:38.552548 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:08:38.553537 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:08:38.554628 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:08:38.555626 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:08:38.558867 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:08:38.560412 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:08:38.563187 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:08:38.564135 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:08:38.566288 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:08:38.572038 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:08:38.573334 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:08:38.581953 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:08:38.583769 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:08:38.585017 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:08:38.586432 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:08:38.587658 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:08:38.590517 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:08:38.592719 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:08:38.595133 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:08:38.599106 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:08:38.601117 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:08:38.602722 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:08:38.604825 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:08:38.606436 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:08:38.615018 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:08:38.617101 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:08:38.618426 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:08:38.621266 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:08:38.622935 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:08:38.624712 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:08:38.625930 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:08:38.627104 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:08:38.628168 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:08:38.629309 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:08:38.631504 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:08:38.633018 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:08:38.640604 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:08:38.646077 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:08:38.652927 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:08:38.654535 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:08:38.657931 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:08:38.659544 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:08:38.663793 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:08:38.669529 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:08:38.670875 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:08:38.677078 [debug] [MainThread]: Parsing macros/sql/star.sql
12:08:38.680375 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:08:38.683712 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:08:38.686408 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:08:38.690730 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:08:38.692354 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:08:38.696441 [debug] [MainThread]: Parsing macros/sql/union.sql
12:08:38.706936 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:08:38.710337 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:08:38.711972 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:08:38.735117 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:08:38.737165 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:08:38.738667 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:08:39.108488 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:08:39.112414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf321ef1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf32099c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf32099ca0>]}


============================== 2022-06-10 12:09:32.180468 | 591cc669-fe5b-42ed-8b5d-e4fc08bfa469 ==============================
12:09:32.180482 [info ] [MainThread]: Running with dbt=1.1.0
12:09:32.180928 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
12:09:32.181060 [debug] [MainThread]: Tracking: tracking
12:09:32.190255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3142468460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3142468880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f31424749a0>]}
12:09:32.191150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3142474be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3142474130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3142474220>]}


============================== 2022-06-10 12:09:36.742676 | 2a4acfce-5122-4dc2-88f8-e87dacb27f88 ==============================
12:09:36.742693 [info ] [MainThread]: Running with dbt=1.1.0
12:09:36.743162 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:09:36.743358 [debug] [MainThread]: Tracking: tracking
12:09:36.752335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ffdbd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ffdbd820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ffdbd850>]}
12:09:36.777254 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:09:36.777602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2a4acfce-5122-4dc2-88f8-e87dacb27f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ffd6cb80>]}
12:09:36.794920 [debug] [MainThread]: Parsing macros/init_s3_source.sql
12:09:36.798702 [debug] [MainThread]: Parsing macros/catalog.sql
12:09:36.800162 [debug] [MainThread]: Parsing macros/adapters.sql
12:09:36.833016 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
12:09:36.833994 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:09:36.859164 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:09:36.863020 [debug] [MainThread]: Parsing macros/materializations/test.sql
12:09:36.864177 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:09:36.891255 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:09:36.893807 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:09:36.895265 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:09:36.896791 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:09:36.898085 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:09:36.898766 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:09:36.899541 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:09:36.900384 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:09:36.908856 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:09:36.913181 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:09:36.917508 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:09:36.920356 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:09:36.927435 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:09:36.930041 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:09:36.939410 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:09:36.948718 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:09:36.950901 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:09:36.954703 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:09:36.957048 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:09:36.974098 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:09:36.980385 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:09:36.981748 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:09:36.991770 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:09:36.996308 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:09:36.999196 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:09:37.002041 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:09:37.009573 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:09:37.011088 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:09:37.021067 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:09:37.036697 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:09:37.051563 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:09:37.056018 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:09:37.068372 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:09:37.078984 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:09:37.080689 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:09:37.097032 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:09:37.098863 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:09:37.103274 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:09:37.105104 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:09:37.107991 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
12:09:37.111083 [debug] [MainThread]: Parsing macros/generate_source.sql
12:09:37.117660 [debug] [MainThread]: Parsing macros/generate_base_model.sql
12:09:37.120499 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:09:37.121826 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:09:37.123226 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:09:37.129030 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:09:37.132426 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:09:37.141714 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:09:37.146399 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:09:37.147641 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:09:37.149262 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:09:37.150762 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:09:37.151790 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:09:37.153292 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:09:37.155263 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:09:37.157369 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:09:37.158966 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:09:37.159982 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:09:37.161136 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:09:37.162169 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:09:37.165472 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:09:37.167033 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:09:37.169851 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:09:37.170813 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:09:37.173042 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:09:37.178764 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:09:37.180090 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:09:37.188785 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:09:37.190614 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:09:37.191862 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:09:37.193347 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:09:37.194618 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:09:37.197488 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:09:37.199695 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:09:37.202119 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:09:37.206135 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:09:37.208135 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:09:37.209808 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:09:37.211931 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:09:37.213592 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:09:37.221971 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:09:37.224168 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:09:37.225619 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:09:37.228445 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:09:37.230182 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:09:37.231969 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:09:37.233222 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:09:37.234416 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:09:37.235507 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:09:37.236672 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:09:37.238895 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:09:37.240431 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:09:37.248260 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:09:37.253901 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:09:37.260816 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:09:37.262484 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:09:37.265939 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:09:37.267562 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:09:37.271819 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:09:37.277651 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:09:37.279034 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:09:37.285242 [debug] [MainThread]: Parsing macros/sql/star.sql
12:09:37.288522 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:09:37.291898 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:09:37.294641 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:09:37.298919 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:09:37.300502 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:09:37.304725 [debug] [MainThread]: Parsing macros/sql/union.sql
12:09:37.315189 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:09:37.318357 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:09:37.319887 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:09:37.342139 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:09:37.344087 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:09:37.345619 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:09:37.706557 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:09:37.757816 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:09:37.850076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2a4acfce-5122-4dc2-88f8-e87dacb27f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ffdf93d0>]}
12:09:37.857602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2a4acfce-5122-4dc2-88f8-e87dacb27f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ffdec9d0>]}
12:09:37.857924 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:09:37.858183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a4acfce-5122-4dc2-88f8-e87dacb27f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ffd6a070>]}
12:09:37.859424 [info ] [MainThread]: 
12:09:37.859917 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:09:37.860804 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
12:09:37.865991 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:09:37.884087 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
12:09:37.887206 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:37.888391 [debug] [ThreadPool]: On list_schemas: Close
12:09:37.889381 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
12:09:37.894694 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:09:37.902397 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
12:09:37.905361 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:37.906521 [debug] [ThreadPool]: On list_None_homework_db: Close
12:09:37.907112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2a4acfce-5122-4dc2-88f8-e87dacb27f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ffca2d90>]}
12:09:37.907571 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:09:37.907845 [info ] [MainThread]: 
12:09:37.910923 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
12:09:37.911234 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
12:09:37.911688 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
12:09:37.911982 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
12:09:37.912147 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
12:09:37.931156 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:09:37.941823 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
12:09:37.945405 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:37.954052 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
12:09:37.957638 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:37.963514 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
12:09:37.966792 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:37.972303 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
12:09:37.975809 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:37.980161 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
12:09:37.980599 [debug] [Thread-1  ]: finished collecting timing info
12:09:37.980784 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
12:09:38.000616 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
12:09:38.003829 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:38.006338 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
12:09:38.009112 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:38.010120 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
12:09:38.012582 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:38.013637 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
12:09:38.015993 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:09:38.038930 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
12:09:38.039498 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
12:14:38.225572 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
12:14:38.225823 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
12:14:38.226188 [debug] [Thread-1  ]: finished collecting timing info
12:14:38.226662 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:14:38.226962 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2a4acfce-5122-4dc2-88f8-e87dacb27f88', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ff2d0d90>]}
12:14:38.227318 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 300.32s]
12:14:38.227741 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
12:14:38.228945 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:14:38.229310 [info ] [MainThread]: 
12:14:38.229555 [info ] [MainThread]: Finished running 1 table model in 300.37s.
12:14:38.229822 [debug] [MainThread]: Connection 'master' was properly closed.
12:14:38.229973 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
12:14:38.237851 [info ] [MainThread]: 
12:14:38.238104 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:14:38.238407 [info ] [MainThread]: 
12:14:38.238667 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
12:14:38.238920 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
12:14:38.239154 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
12:14:38.239385 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:14:38.239628 [info ] [MainThread]: 
12:14:38.239891 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:14:38.240249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ff2c5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ff2adc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67ff2adfd0>]}


============================== 2022-06-10 12:19:40.881926 | 78690d0c-844f-4dcc-a5ae-8f5379027c5a ==============================
12:19:40.881943 [info ] [MainThread]: Running with dbt=1.1.0
12:19:40.882435 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:19:40.882640 [debug] [MainThread]: Tracking: tracking
12:19:40.891878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9ea48610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9ea48760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9ea48790>]}
12:19:40.942372 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:19:40.942851 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
12:19:40.955176 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:19:41.009799 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:19:41.020639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '78690d0c-844f-4dcc-a5ae-8f5379027c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9e814c10>]}
12:19:41.029020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '78690d0c-844f-4dcc-a5ae-8f5379027c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9e84bc10>]}
12:19:41.029334 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:19:41.029591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78690d0c-844f-4dcc-a5ae-8f5379027c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9e8cb7c0>]}
12:19:41.030937 [info ] [MainThread]: 
12:19:41.031402 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:19:41.032284 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
12:19:41.037487 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:19:41.056811 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
12:19:41.059628 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:41.060943 [debug] [ThreadPool]: On list_schemas: Close
12:19:41.061895 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
12:19:41.066962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:19:41.075743 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
12:19:41.079192 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:41.080342 [debug] [ThreadPool]: On list_None_homework_db: Close
12:19:41.080945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '78690d0c-844f-4dcc-a5ae-8f5379027c5a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9e793310>]}
12:19:41.081386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:19:41.081639 [info ] [MainThread]: 
12:19:41.084604 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
12:19:41.084921 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
12:19:41.085406 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
12:19:41.085636 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
12:19:41.085790 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
12:19:41.106225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:19:41.115605 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
12:19:41.119736 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:41.128260 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
12:19:41.132024 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:41.139112 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
12:19:41.144234 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:41.149461 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
12:19:41.152994 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:41.157122 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
12:19:41.157488 [debug] [Thread-1  ]: finished collecting timing info
12:19:41.157685 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
12:19:41.178116 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */
drop table if exists homework_db.lineorder_flat__dbt_tmp 
  ...
12:19:42.182661 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 1.00 seconds
12:19:42.188949 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
12:19:42.191818 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:42.192962 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
12:19:42.195596 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:42.196682 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
12:19:42.200252 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:42.201294 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
12:19:42.203639 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:19:42.225321 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
12:19:42.225796 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
12:20:44.929574 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:20:44.929855 [debug] [MainThread]: clickhouse adapter: Cancelling query 'model.dbt_starschema_2.lineorder_flat'
12:20:44.930144 [debug] [MainThread]: Connection 'master' was properly closed.
12:20:44.930276 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was left open.
12:20:44.930402 [debug] [MainThread]: On model.dbt_starschema_2.lineorder_flat: Close
12:20:44.930608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9c5f9340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9c5f91f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a9c5f9910>]}


============================== 2022-06-10 12:21:32.970124 | a64bb428-c647-4ed1-ac73-79a93d003302 ==============================
12:21:32.970143 [info ] [MainThread]: Running with dbt=1.1.0
12:21:32.970710 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:21:32.970927 [debug] [MainThread]: Tracking: tracking
12:21:32.980075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5e330700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5e3307f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5e330820>]}
12:21:33.028773 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:21:33.029276 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
12:21:33.041919 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:21:33.050744 [info ] [MainThread]: Relation is: None
12:21:33.098956 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:21:33.109798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a64bb428-c647-4ed1-ac73-79a93d003302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5e0f8d60>]}
12:21:33.118156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a64bb428-c647-4ed1-ac73-79a93d003302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5e12cac0>]}
12:21:33.118488 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:21:33.118759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a64bb428-c647-4ed1-ac73-79a93d003302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5e1b3850>]}
12:21:33.120112 [info ] [MainThread]: 
12:21:33.120665 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:21:33.121616 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
12:21:33.127024 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:21:33.148404 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
12:21:33.152829 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:21:33.154120 [debug] [ThreadPool]: On list_schemas: Close
12:21:33.155151 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
12:21:33.160488 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:21:33.171276 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
12:21:33.175657 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:21:33.176842 [debug] [ThreadPool]: On list_None_homework_db: Close
12:21:33.177440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a64bb428-c647-4ed1-ac73-79a93d003302', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5e0a2190>]}
12:21:33.177889 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:21:33.178123 [info ] [MainThread]: 
12:21:33.181841 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
12:21:33.182262 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
12:21:33.182853 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
12:21:33.183145 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
12:21:33.183357 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
12:21:33.191803 [info ] [Thread-1  ]: Relation is: None
12:21:33.204727 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:21:33.220519 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
12:21:33.226249 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:21:33.232893 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
12:21:33.236345 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:21:33.241143 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
12:21:33.245140 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:21:33.249872 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
12:21:33.256468 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:21:33.259799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
12:21:33.260139 [debug] [Thread-1  ]: finished collecting timing info
12:21:33.260319 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
12:21:33.281010 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */
drop table if exists homework_db.lineorder_flat__dbt_tmp 
  ...
12:21:33.732547 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.45 seconds
12:21:33.739006 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
12:21:33.742717 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:21:33.743850 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
12:21:33.747845 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:21:33.748900 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
12:21:33.752697 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:21:33.753677 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
12:21:33.756138 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:21:33.777547 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
12:21:33.777996 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
12:24:34.900991 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:24:34.901259 [debug] [MainThread]: clickhouse adapter: Cancelling query 'model.dbt_starschema_2.lineorder_flat'
12:24:34.901555 [debug] [MainThread]: Connection 'master' was properly closed.
12:24:34.901678 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was left open.
12:24:34.901787 [debug] [MainThread]: On model.dbt_starschema_2.lineorder_flat: Close
12:24:34.902056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5c6e6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5c6e6a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff5c76fb50>]}


============================== 2022-06-10 12:25:54.169850 | c99abffa-5c9a-4638-b4d7-bb0f7745bb9c ==============================
12:25:54.169870 [info ] [MainThread]: Running with dbt=1.1.0
12:25:54.170405 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:25:54.170569 [debug] [MainThread]: Tracking: tracking
12:25:54.179797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc43b730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc43b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc43b8b0>]}
12:25:54.230416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:25:54.230915 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
12:25:54.243603 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:25:54.251943 [info ] [MainThread]: Relation is: 
12:25:54.299249 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:25:54.310017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c99abffa-5c9a-4638-b4d7-bb0f7745bb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc1fcdf0>]}
12:25:54.318209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c99abffa-5c9a-4638-b4d7-bb0f7745bb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc22fcd0>]}
12:25:54.318555 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:25:54.318838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99abffa-5c9a-4638-b4d7-bb0f7745bb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc2b88e0>]}
12:25:54.320210 [info ] [MainThread]: 
12:25:54.320733 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:25:54.321590 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
12:25:54.326568 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:25:54.415745 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
12:25:54.437593 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.02 seconds
12:25:54.439018 [debug] [ThreadPool]: On list_schemas: Close
12:25:54.440088 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
12:25:54.445585 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:25:54.469225 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
12:25:54.485660 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.02 seconds
12:25:54.486956 [debug] [ThreadPool]: On list_None_homework_db: Close
12:25:54.487635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c99abffa-5c9a-4638-b4d7-bb0f7745bb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc1a41f0>]}
12:25:54.488117 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:25:54.488358 [info ] [MainThread]: 
12:25:54.491530 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
12:25:54.491858 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
12:25:54.492287 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
12:25:54.492587 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
12:25:54.492762 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
12:25:54.500528 [debug] [Thread-1  ]: finished collecting timing info
12:25:54.500867 [debug] [Thread-1  ]: Compilation Error in model lineorder_flat (models/lineorder_flat.sql)
  'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'load_relation'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
12:25:54.501140 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c99abffa-5c9a-4638-b4d7-bb0f7745bb9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc186e80>]}
12:25:54.501467 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 0.01s]
12:25:54.501846 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
12:25:54.502920 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:25:54.503272 [info ] [MainThread]: 
12:25:54.503509 [info ] [MainThread]: Finished running 1 table model in 0.18s.
12:25:54.503711 [debug] [MainThread]: Connection 'master' was properly closed.
12:25:54.503879 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
12:25:54.512022 [info ] [MainThread]: 
12:25:54.512320 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:25:54.512670 [info ] [MainThread]: 
12:25:54.512947 [error] [MainThread]: [33mCompilation Error in model lineorder_flat (models/lineorder_flat.sql)[0m
12:25:54.513210 [error] [MainThread]:   'dbt.context.providers.RuntimeDatabaseWrapper object' has no attribute 'load_relation'. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
12:25:54.513465 [info ] [MainThread]: 
12:25:54.513724 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:25:54.514062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc3dfc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc18bdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8efc18be20>]}


============================== 2022-06-10 12:27:05.541307 | 8eb660e3-6ac2-4651-8733-4db9127a189f ==============================
12:27:05.541325 [info ] [MainThread]: Running with dbt=1.1.0
12:27:05.541859 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:27:05.542060 [debug] [MainThread]: Tracking: tracking
12:27:05.551245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba95ec580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba95ec6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba95ec700>]}
12:27:05.601234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
12:27:05.601725 [debug] [MainThread]: Partial parsing: updated file: dbt_starschema_2://models/lineorder_flat.sql
12:27:05.614613 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:27:05.624635 [info ] [MainThread]: Relation is: None
12:27:05.671659 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:27:05.682834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8eb660e3-6ac2-4651-8733-4db9127a189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba93b2ee0>]}
12:27:05.691583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8eb660e3-6ac2-4651-8733-4db9127a189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba95c7760>]}
12:27:05.691956 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:27:05.692227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eb660e3-6ac2-4651-8733-4db9127a189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba95d0d30>]}
12:27:05.693698 [info ] [MainThread]: 
12:27:05.694253 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:27:05.695119 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
12:27:05.700200 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:27:05.721074 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
12:27:05.724869 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:27:05.726145 [debug] [ThreadPool]: On list_schemas: Close
12:27:05.727184 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
12:27:05.732523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:27:05.742609 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
12:27:05.747333 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:27:05.748582 [debug] [ThreadPool]: On list_None_homework_db: Close
12:27:05.749238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8eb660e3-6ac2-4651-8733-4db9127a189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba932a3a0>]}
12:27:05.749714 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:27:05.749994 [info ] [MainThread]: 
12:27:05.753309 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
12:27:05.753594 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
12:27:05.754036 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
12:27:05.754252 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
12:27:05.754389 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
12:27:05.761864 [info ] [Thread-1  ]: Relation is: None
12:27:05.777387 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:27:05.788615 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
12:27:05.796225 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:27:05.803253 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
12:27:05.808721 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:27:05.814003 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
12:27:05.819169 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:27:05.824020 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
12:27:05.828615 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:27:05.831903 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
12:27:05.832238 [debug] [Thread-1  ]: finished collecting timing info
12:27:05.832426 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
12:27:05.853512 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */
drop table if exists homework_db.lineorder_flat__dbt_tmp 
  ...
12:27:06.516210 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.66 seconds
12:27:06.522647 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
12:27:06.526571 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:27:06.527722 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
12:27:06.530978 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:27:06.532044 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
12:27:06.536452 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:27:06.537485 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
12:27:06.540366 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:27:06.562041 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
12:27:06.562524 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
12:32:06.749922 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
12:32:06.750207 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
12:32:06.750539 [debug] [Thread-1  ]: finished collecting timing info
12:32:06.750867 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:32:06.751157 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8eb660e3-6ac2-4651-8733-4db9127a189f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba81a6b50>]}
12:32:06.751514 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 301.00s]
12:32:06.752032 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
12:32:06.753256 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:32:06.753609 [info ] [MainThread]: 
12:32:06.753868 [info ] [MainThread]: Finished running 1 table model in 301.06s.
12:32:06.754127 [debug] [MainThread]: Connection 'master' was properly closed.
12:32:06.754275 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
12:32:06.761928 [info ] [MainThread]: 
12:32:06.762265 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:32:06.762619 [info ] [MainThread]: 
12:32:06.762889 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
12:32:06.763161 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
12:32:06.763410 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
12:32:06.763631 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:32:06.763902 [info ] [MainThread]: 
12:32:06.764186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:32:06.764571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba81fac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba958a130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbba946f790>]}


============================== 2022-06-10 12:55:52.024470 | 17b9a439-e2fb-485a-9bfc-a1e2c7e918e7 ==============================
12:55:52.024485 [info ] [MainThread]: Running with dbt=1.1.0
12:55:52.025026 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
12:55:52.025184 [debug] [MainThread]: Tracking: tracking
12:55:52.034064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2ebe730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2ebe880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2ebe8b0>]}
12:55:52.067183 [info ] [MainThread]: Unable to do partial parsing because profile has changed
12:55:52.067548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17b9a439-e2fb-485a-9bfc-a1e2c7e918e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2ebeca0>]}
12:55:52.084358 [debug] [MainThread]: Parsing macros/init_s3_source.sql
12:55:52.088033 [debug] [MainThread]: Parsing macros/catalog.sql
12:55:52.089514 [debug] [MainThread]: Parsing macros/adapters.sql
12:55:52.123783 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
12:55:52.124841 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:55:52.150054 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:55:52.153740 [debug] [MainThread]: Parsing macros/materializations/test.sql
12:55:52.154904 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:55:52.181259 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:55:52.183632 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:55:52.185121 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:55:52.186582 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:55:52.187906 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:55:52.188622 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:55:52.189426 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:55:52.190260 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:55:52.198036 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:55:52.202098 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:55:52.206344 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:55:52.209124 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:55:52.215864 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:55:52.218376 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:55:52.227623 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:55:52.236704 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:55:52.238825 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:55:52.242660 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:55:52.245005 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:55:52.261163 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:55:52.267230 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:55:52.268564 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:55:52.275477 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:55:52.278205 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:55:52.280490 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:55:52.283285 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:55:52.290252 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:55:52.291650 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:55:52.300718 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:55:52.315355 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:55:52.329389 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:55:52.333564 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:55:52.345035 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:55:52.355016 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:55:52.356652 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:55:52.372372 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:55:52.374213 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:55:52.378636 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:55:52.380471 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:55:52.383392 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
12:55:52.386460 [debug] [MainThread]: Parsing macros/generate_source.sql
12:55:52.393250 [debug] [MainThread]: Parsing macros/generate_base_model.sql
12:55:52.396139 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:55:52.397466 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:55:52.398891 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:55:52.404625 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:55:52.407996 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:55:52.417780 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:55:52.422556 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:55:52.423787 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:55:52.425383 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:55:52.426754 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:55:52.427760 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:55:52.429227 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:55:52.431102 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:55:52.433098 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:55:52.434664 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:55:52.435684 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:55:52.436859 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:55:52.437882 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:55:52.441097 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:55:52.442681 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:55:52.445387 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:55:52.446314 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:55:52.448480 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:55:52.454219 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:55:52.455545 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:55:52.464200 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:55:52.465997 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:55:52.467205 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:55:52.468611 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:55:52.469855 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:55:52.472593 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:55:52.474758 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:55:52.477222 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:55:52.481103 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:55:52.483015 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:55:52.484577 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:55:52.486549 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:55:52.488092 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:55:52.496283 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:55:52.498462 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:55:52.499839 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:55:52.502656 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:55:52.504405 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:55:52.506270 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:55:52.507557 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:55:52.508815 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:55:52.509955 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:55:52.511148 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:55:52.513513 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:55:52.515078 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:55:52.522649 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:55:52.527893 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:55:52.534323 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:55:52.535974 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:55:52.539407 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:55:52.541062 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:55:52.545207 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:55:52.550839 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:55:52.552223 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:55:52.558394 [debug] [MainThread]: Parsing macros/sql/star.sql
12:55:52.561726 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:55:52.565009 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:55:52.567627 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:55:52.571824 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:55:52.573439 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:55:52.577544 [debug] [MainThread]: Parsing macros/sql/union.sql
12:55:52.587837 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:55:52.591036 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:55:52.592578 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:55:52.614677 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:55:52.616530 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:55:52.618027 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:55:52.980755 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:55:53.032324 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:55:53.123192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17b9a439-e2fb-485a-9bfc-a1e2c7e918e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2d37f70>]}
12:55:53.130523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17b9a439-e2fb-485a-9bfc-a1e2c7e918e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2d269a0>]}
12:55:53.130821 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:55:53.131073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b9a439-e2fb-485a-9bfc-a1e2c7e918e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2e4a520>]}
12:55:53.132249 [info ] [MainThread]: 
12:55:53.132782 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:55:53.133592 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
12:55:53.138473 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:55:53.157986 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
12:55:53.160571 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.161717 [debug] [ThreadPool]: On list_schemas: Close
12:55:53.162694 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
12:55:53.167852 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:55:53.175876 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
12:55:53.180644 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.181785 [debug] [ThreadPool]: On list_None_homework_db: Close
12:55:53.182383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17b9a439-e2fb-485a-9bfc-a1e2c7e918e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2f09640>]}
12:55:53.182828 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:55:53.183100 [info ] [MainThread]: 
12:55:53.186051 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
12:55:53.186343 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
12:55:53.186800 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
12:55:53.187022 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
12:55:53.187165 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
12:55:53.205764 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:55:53.214154 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
12:55:53.217795 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.225709 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
12:55:53.229307 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.234892 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
12:55:53.237988 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.243128 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
12:55:53.246428 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.250559 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
12:55:53.250903 [debug] [Thread-1  ]: finished collecting timing info
12:55:53.251078 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
12:55:53.272699 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */
drop table if exists homework_db.lineorder_flat__dbt_tmp 
  ...
12:55:53.321292 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.05 seconds
12:55:53.327099 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
12:55:53.330837 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.331861 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
12:55:53.334585 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.335604 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
12:55:53.338359 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.339327 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
12:55:53.341949 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:55:53.363155 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
12:55:53.363574 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
13:00:53.441069 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
13:00:53.441355 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
13:00:53.441671 [debug] [Thread-1  ]: finished collecting timing info
13:00:53.442005 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:00:53.442287 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17b9a439-e2fb-485a-9bfc-a1e2c7e918e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2e4f940>]}
13:00:53.442655 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 300.26s]
13:00:53.443109 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
13:00:53.444318 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:00:53.444715 [info ] [MainThread]: 
13:00:53.444964 [info ] [MainThread]: Finished running 1 table model in 300.31s.
13:00:53.445221 [debug] [MainThread]: Connection 'master' was properly closed.
13:00:53.445364 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
13:00:53.452963 [info ] [MainThread]: 
13:00:53.453212 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:00:53.453500 [info ] [MainThread]: 
13:00:53.453754 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
13:00:53.454006 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
13:00:53.454253 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
13:00:53.454483 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:00:53.454717 [info ] [MainThread]: 
13:00:53.454959 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:00:53.455311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc23eaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2e73160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fc2e73130>]}


============================== 2022-06-10 13:02:49.813303 | 80096558-ab68-4e9d-9dcb-922092960226 ==============================
13:02:49.813320 [info ] [MainThread]: Running with dbt=1.1.0
13:02:49.813734 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
13:02:49.813877 [debug] [MainThread]: Tracking: tracking
13:02:49.823092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4988e21c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4988e2e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4988eeac0>]}
13:02:49.824722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4988eeaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4988ee1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4988eeac0>]}


============================== 2022-06-10 13:05:17.687895 | 5da6560a-21f7-4a5d-9e5a-b833016e67a0 ==============================
13:05:17.687912 [info ] [MainThread]: Running with dbt=1.1.0
13:05:17.688396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
13:05:17.688611 [debug] [MainThread]: Tracking: tracking
13:05:17.697583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc29f3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc29f37c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc29f37f0>]}
13:05:17.721820 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:05:17.722134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5da6560a-21f7-4a5d-9e5a-b833016e67a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc2992f70>]}
13:05:17.739488 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:05:17.743305 [debug] [MainThread]: Parsing macros/catalog.sql
13:05:17.744866 [debug] [MainThread]: Parsing macros/adapters.sql
13:05:17.778616 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:05:17.779568 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:05:17.804180 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:05:17.807903 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:05:17.809007 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:05:17.835434 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:05:17.837920 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:05:17.839337 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:05:17.840838 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:05:17.842192 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:05:17.842871 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:05:17.843657 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:05:17.844492 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:05:17.852797 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:05:17.857065 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:05:17.861140 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:05:17.863758 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:05:17.870497 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:05:17.873005 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:05:17.882276 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:05:17.891438 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:05:17.893633 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:05:17.897383 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:05:17.899680 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:05:17.915912 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:05:17.921949 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:05:17.923271 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:05:17.930282 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:05:17.932974 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:05:17.935160 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:05:17.937843 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:05:17.944985 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:05:17.946493 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:05:17.956095 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:05:17.971100 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:05:17.986115 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:05:17.990404 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:05:18.002604 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:05:18.013230 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:05:18.014905 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:05:18.031105 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:05:18.032931 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:05:18.037353 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:05:18.039166 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:05:18.042094 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:05:18.045202 [debug] [MainThread]: Parsing macros/generate_source.sql
13:05:18.051938 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:05:18.054872 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:05:18.056153 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:05:18.057561 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:05:18.063260 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:05:18.066636 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:05:18.076459 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:05:18.081653 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:05:18.082946 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:05:18.084578 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:05:18.086051 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:05:18.087063 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:05:18.088570 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:05:18.090516 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:05:18.092586 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:05:18.094153 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:05:18.095076 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:05:18.096155 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:05:18.097246 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:05:18.100486 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:05:18.102022 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:05:18.104760 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:05:18.105689 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:05:18.107839 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:05:18.113525 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:05:18.114802 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:05:18.123353 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:05:18.125161 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:05:18.126363 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:05:18.127772 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:05:18.129003 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:05:18.131781 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:05:18.133950 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:05:18.136356 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:05:18.140323 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:05:18.142314 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:05:18.143913 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:05:18.146003 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:05:18.147607 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:05:18.156035 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:05:18.158111 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:05:18.159438 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:05:18.162137 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:05:18.163765 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:05:18.165494 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:05:18.166687 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:05:18.167818 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:05:18.168906 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:05:18.170025 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:05:18.172192 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:05:18.173744 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:05:18.181440 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:05:18.186781 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:05:18.193409 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:05:18.194967 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:05:18.198296 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:05:18.199875 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:05:18.203987 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:05:18.209545 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:05:18.210882 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:05:18.216985 [debug] [MainThread]: Parsing macros/sql/star.sql
13:05:18.220243 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:05:18.223537 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:05:18.226191 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:05:18.230418 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:05:18.231995 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:05:18.236010 [debug] [MainThread]: Parsing macros/sql/union.sql
13:05:18.246335 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:05:18.249732 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:05:18.251340 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:05:18.274859 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:05:18.276872 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:05:18.278499 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:05:18.643643 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
13:05:18.696427 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
13:05:18.792609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5da6560a-21f7-4a5d-9e5a-b833016e67a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc2a46940>]}
13:05:18.800222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5da6560a-21f7-4a5d-9e5a-b833016e67a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc29ae940>]}
13:05:18.800532 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:05:18.800764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5da6560a-21f7-4a5d-9e5a-b833016e67a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc29ae040>]}
13:05:18.802014 [info ] [MainThread]: 
13:05:18.802514 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:05:18.803412 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
13:05:18.808497 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:05:18.831939 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
13:05:18.834677 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:05:18.835887 [debug] [ThreadPool]: On list_schemas: Close
13:05:18.836925 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
13:05:18.842111 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:05:18.849716 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
13:05:18.852736 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:05:18.853803 [debug] [ThreadPool]: On list_None_homework_db: Close
13:05:18.854309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5da6560a-21f7-4a5d-9e5a-b833016e67a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc2896970>]}
13:05:18.854790 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:05:18.855064 [info ] [MainThread]: 
13:05:18.858318 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
13:05:18.858632 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
13:05:18.859087 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
13:05:18.859318 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
13:05:18.859467 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
13:05:18.878794 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:05:18.887626 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
13:05:18.890902 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:05:18.894115 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
13:05:18.897263 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:05:18.900399 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
13:05:18.903872 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:05:18.906865 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
13:05:18.909885 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:05:18.911236 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
13:05:18.911678 [debug] [Thread-1  ]: finished collecting timing info
13:05:18.911863 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
13:05:18.931264 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
13:05:18.959510 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.03 seconds
13:05:18.960883 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
13:05:18.969522 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:05:18.970992 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
13:05:18.983748 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:05:18.984947 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
13:05:18.998812 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:05:19.023988 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
13:05:19.024586 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,
      ,
      ,
      ,
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
13:05:19.033854 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 587 (',') (line 27, col 7): ,\n      ,\n      ,\n  FROM homework_db.src_lineorder AS l\n  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\n  INNER JOIN homew
13:05:19.034038 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
13:05:19.034326 [debug] [Thread-1  ]: finished collecting timing info
13:05:19.034633 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 587 (',') (line 27, col 7): ,\n      ,\n      ,\n  FROM homework_db.src_lineorder AS l\n  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\n  INNER JOIN homew
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:05:19.034911 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5da6560a-21f7-4a5d-9e5a-b833016e67a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc06d48b0>]}
13:05:19.035267 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 0.18s]
13:05:19.035734 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
13:05:19.036853 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:05:19.037205 [info ] [MainThread]: 
13:05:19.037449 [info ] [MainThread]: Finished running 1 table model in 0.23s.
13:05:19.037667 [debug] [MainThread]: Connection 'master' was properly closed.
13:05:19.037830 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
13:05:19.045477 [info ] [MainThread]: 
13:05:19.045714 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:05:19.045976 [info ] [MainThread]: 
13:05:19.046272 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
13:05:19.046532 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
13:05:19.046742 [error] [MainThread]:    b"Code: 62. DB::Exception: Syntax error: failed at position 587 (',') (line 27, col 7): ,\n      ,\n      ,\n  FROM homework_db.src_lineorder AS l\n  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\n  INNER JOIN homew
13:05:19.046978 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:05:19.047218 [info ] [MainThread]: 
13:05:19.047501 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:05:19.047868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc2996520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc1ee8a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fecc2a1eb20>]}


============================== 2022-06-10 13:11:16.517405 | a010c2a8-8e10-4408-8b3d-f46261c1c96e ==============================
13:11:16.517419 [info ] [MainThread]: Running with dbt=1.1.0
13:11:16.517780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
13:11:16.517943 [debug] [MainThread]: Tracking: tracking
13:11:16.527067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c85e1cbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c85e28280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c85e28100>]}
13:11:16.528648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c85e282e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c85e28160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3c85e28100>]}


============================== 2022-06-10 13:11:24.210912 | ba6a1235-69a7-4751-850a-2396eedd92e4 ==============================
13:11:24.210930 [info ] [MainThread]: Running with dbt=1.1.0
13:11:24.211397 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
13:11:24.211539 [debug] [MainThread]: Tracking: tracking
13:11:24.220181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b23cc76d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b23cc77c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b23cc77f0>]}
13:11:24.244894 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:11:24.245232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ba6a1235-69a7-4751-850a-2396eedd92e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b23c77b20>]}
13:11:24.261808 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:11:24.265722 [debug] [MainThread]: Parsing macros/catalog.sql
13:11:24.267286 [debug] [MainThread]: Parsing macros/adapters.sql
13:11:24.301598 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:11:24.302635 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:11:24.326489 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:11:24.330117 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:11:24.331283 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:11:24.357551 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:11:24.360085 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:11:24.361583 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:11:24.363146 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:11:24.364520 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:11:24.365253 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:11:24.366106 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:11:24.366990 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:11:24.375245 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:11:24.379666 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:11:24.383924 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:11:24.386816 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:11:24.393852 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:11:24.396498 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:11:24.405682 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:11:24.414339 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:11:24.416397 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:11:24.420002 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:11:24.422241 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:11:24.438204 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:11:24.443951 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:11:24.445314 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:11:24.451921 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:11:24.454550 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:11:24.456818 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:11:24.459630 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:11:24.467065 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:11:24.468600 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:11:24.478423 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:11:24.494285 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:11:24.509456 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:11:24.513921 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:11:24.526036 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:11:24.536687 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:11:24.538371 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:11:24.554600 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:11:24.556430 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:11:24.560847 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:11:24.562691 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:11:24.565628 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:11:24.568686 [debug] [MainThread]: Parsing macros/generate_source.sql
13:11:24.575458 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:11:24.578394 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:11:24.579707 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:11:24.581136 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:11:24.586973 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:11:24.590370 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:11:24.600246 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:11:24.604936 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:11:24.606129 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:11:24.607643 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:11:24.608991 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:11:24.610019 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:11:24.611509 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:11:24.613387 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:11:24.615306 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:11:24.616764 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:11:24.617688 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:11:24.618756 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:11:24.619745 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:11:24.622789 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:11:24.624276 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:11:24.627092 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:11:24.628064 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:11:24.630268 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:11:24.635969 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:11:24.637322 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:11:24.645841 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:11:24.647576 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:11:24.648830 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:11:24.650198 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:11:24.651404 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:11:24.654147 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:11:24.656321 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:11:24.658801 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:11:24.662769 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:11:24.664762 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:11:24.666389 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:11:24.668474 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:11:24.670108 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:11:24.678694 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:11:24.680886 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:11:24.682310 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:11:24.685119 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:11:24.686840 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:11:24.688620 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:11:24.689901 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:11:24.691105 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:11:24.692267 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:11:24.693461 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:11:24.695741 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:11:24.697339 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:11:24.705263 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:11:24.710831 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:11:24.717589 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:11:24.719166 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:11:24.722410 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:11:24.724058 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:11:24.728315 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:11:24.733990 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:11:24.735368 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:11:24.741397 [debug] [MainThread]: Parsing macros/sql/star.sql
13:11:24.744699 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:11:24.747959 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:11:24.750639 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:11:24.755015 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:11:24.756716 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:11:24.760829 [debug] [MainThread]: Parsing macros/sql/union.sql
13:11:24.771167 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:11:24.774583 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:11:24.776219 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:11:24.800041 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:11:24.802055 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:11:24.803645 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:11:25.158040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b23c8f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b23b1b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5b23b1b370>]}


============================== 2022-06-10 13:13:00.823611 | 76c393ed-33b4-467d-bcd8-e1a438ce53cc ==============================
13:13:00.823626 [info ] [MainThread]: Running with dbt=1.1.0
13:13:00.824024 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
13:13:00.824148 [debug] [MainThread]: Tracking: tracking
13:13:00.832487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ce00a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ce001c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ce000a0>]}
13:13:00.833334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ce00a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ce00190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd74ce00ac0>]}


============================== 2022-06-10 13:13:06.038153 | 8bcbf1cf-2eaa-409b-b80d-6be663c8d8ce ==============================
13:13:06.038171 [info ] [MainThread]: Running with dbt=1.1.0
13:13:06.038654 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
13:13:06.038875 [debug] [MainThread]: Tracking: tracking
13:13:06.047774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c3f12760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c3f12850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c3f12880>]}
13:13:06.072440 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:13:06.072822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8bcbf1cf-2eaa-409b-b80d-6be663c8d8ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c3ecdf10>]}
13:13:06.090393 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:13:06.094261 [debug] [MainThread]: Parsing macros/catalog.sql
13:13:06.095772 [debug] [MainThread]: Parsing macros/adapters.sql
13:13:06.130249 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:13:06.131259 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:13:06.156263 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:13:06.160046 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:13:06.161198 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:13:06.187916 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:13:06.190420 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:13:06.191902 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:13:06.193417 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:13:06.194713 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:13:06.195403 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:13:06.196281 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:13:06.197160 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:13:06.205266 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:13:06.209507 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:13:06.213624 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:13:06.216358 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:13:06.223330 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:13:06.226015 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:13:06.235424 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:13:06.244272 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:13:06.246422 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:13:06.250194 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:13:06.252506 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:13:06.268949 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:13:06.275014 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:13:06.276379 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:13:06.283340 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:13:06.286018 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:13:06.288333 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:13:06.291150 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:13:06.298612 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:13:06.300132 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:13:06.309917 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:13:06.325223 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:13:06.340024 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:13:06.344365 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:13:06.356595 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:13:06.367320 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:13:06.369051 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:13:06.385439 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:13:06.387275 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:13:06.391719 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:13:06.393614 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:13:06.396608 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:13:06.399789 [debug] [MainThread]: Parsing macros/generate_source.sql
13:13:06.406757 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:13:06.409715 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:13:06.411052 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:13:06.412506 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:13:06.418372 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:13:06.421898 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:13:06.431628 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:13:06.436386 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:13:06.437653 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:13:06.439246 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:13:06.440657 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:13:06.441707 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:13:06.443253 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:13:06.445254 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:13:06.447276 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:13:06.448856 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:13:06.449881 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:13:06.451055 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:13:06.452106 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:13:06.455457 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:13:06.457020 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:13:06.459829 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:13:06.460819 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:13:06.463021 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:13:06.468792 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:13:06.470072 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:13:06.478600 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:13:06.480459 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:13:06.481756 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:13:06.483198 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:13:06.484449 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:13:06.487311 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:13:06.489543 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:13:06.491933 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:13:06.495828 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:13:06.497796 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:13:06.499410 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:13:06.501459 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:13:06.503097 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:13:06.511708 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:13:06.513908 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:13:06.515392 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:13:06.518212 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:13:06.520010 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:13:06.521824 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:13:06.523107 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:13:06.524320 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:13:06.525492 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:13:06.526662 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:13:06.528881 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:13:06.530356 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:13:06.537736 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:13:06.543021 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:13:06.549844 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:13:06.551514 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:13:06.554862 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:13:06.556435 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:13:06.560695 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:13:06.566438 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:13:06.567795 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:13:06.573764 [debug] [MainThread]: Parsing macros/sql/star.sql
13:13:06.577095 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:13:06.580450 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:13:06.583217 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:13:06.587604 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:13:06.589284 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:13:06.593380 [debug] [MainThread]: Parsing macros/sql/union.sql
13:13:06.604023 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:13:06.607417 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:13:06.609129 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:13:06.633224 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:13:06.635342 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:13:06.636926 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:13:06.992302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c3ee5220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c3d6f370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2c3d6f400>]}


============================== 2022-06-10 13:13:28.620470 | e7f3d569-59b1-44ce-b2b7-2cc5f671fe0e ==============================
13:13:28.620487 [info ] [MainThread]: Running with dbt=1.1.0
13:13:28.621038 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
13:13:28.621247 [debug] [MainThread]: Tracking: tracking
13:13:28.630501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84421955e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84421956d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8442195700>]}
13:13:28.655343 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:13:28.655663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e7f3d569-59b1-44ce-b2b7-2cc5f671fe0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844214ad90>]}
13:13:28.673030 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:13:28.676834 [debug] [MainThread]: Parsing macros/catalog.sql
13:13:28.678376 [debug] [MainThread]: Parsing macros/adapters.sql
13:13:28.712659 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:13:28.713694 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:13:28.739032 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:13:28.742914 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:13:28.744117 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:13:28.770901 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:13:28.773423 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:13:28.774949 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:13:28.776485 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:13:28.777844 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:13:28.778556 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:13:28.779387 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:13:28.780232 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:13:28.788224 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:13:28.792393 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:13:28.796498 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:13:28.799454 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:13:28.806524 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:13:28.809196 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:13:28.818602 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:13:28.827801 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:13:28.829954 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:13:28.833778 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:13:28.836087 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:13:28.852672 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:13:28.858716 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:13:28.860041 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:13:28.866894 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:13:28.869467 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:13:28.871672 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:13:28.874335 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:13:28.881735 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:13:28.883286 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:13:28.892671 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:13:28.908199 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:13:28.923035 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:13:28.927346 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:13:28.939655 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:13:28.950328 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:13:28.952060 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:13:28.968278 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:13:28.970155 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:13:28.974333 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:13:28.976163 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:13:28.979073 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:13:28.982124 [debug] [MainThread]: Parsing macros/generate_source.sql
13:13:28.988803 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:13:28.991571 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:13:28.992846 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:13:28.994172 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:13:28.999871 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:13:29.003326 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:13:29.012722 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:13:29.017700 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:13:29.018996 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:13:29.020598 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:13:29.021957 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:13:29.022966 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:13:29.024466 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:13:29.026402 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:13:29.028461 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:13:29.030032 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:13:29.031034 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:13:29.032170 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:13:29.033264 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:13:29.036482 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:13:29.038055 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:13:29.040737 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:13:29.041704 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:13:29.043865 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:13:29.049658 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:13:29.050982 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:13:29.059619 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:13:29.061462 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:13:29.062724 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:13:29.064152 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:13:29.065434 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:13:29.068242 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:13:29.070431 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:13:29.072867 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:13:29.076735 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:13:29.078724 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:13:29.080379 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:13:29.082494 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:13:29.084162 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:13:29.092785 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:13:29.095011 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:13:29.096412 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:13:29.099187 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:13:29.100932 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:13:29.102664 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:13:29.103895 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:13:29.105071 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:13:29.106177 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:13:29.107419 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:13:29.109710 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:13:29.111329 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:13:29.119225 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:13:29.124713 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:13:29.131625 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:13:29.133315 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:13:29.136756 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:13:29.138374 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:13:29.142595 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:13:29.148369 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:13:29.149746 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:13:29.156026 [debug] [MainThread]: Parsing macros/sql/star.sql
13:13:29.159339 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:13:29.162632 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:13:29.165436 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:13:29.169751 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:13:29.171405 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:13:29.175247 [debug] [MainThread]: Parsing macros/sql/union.sql
13:13:29.186047 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:13:29.189492 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:13:29.191142 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:13:29.214352 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:13:29.216326 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:13:29.217893 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:13:29.576843 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
13:13:29.626919 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
13:13:29.722365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e7f3d569-59b1-44ce-b2b7-2cc5f671fe0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84421759a0>]}
13:13:29.730123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e7f3d569-59b1-44ce-b2b7-2cc5f671fe0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84421751f0>]}
13:13:29.730459 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:13:29.730715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f3d569-59b1-44ce-b2b7-2cc5f671fe0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8442183e50>]}
13:13:29.731985 [info ] [MainThread]: 
13:13:29.732477 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:13:29.733333 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
13:13:29.738644 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:13:29.756866 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
13:13:29.759355 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.760542 [debug] [ThreadPool]: On list_schemas: Close
13:13:29.761566 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
13:13:29.766956 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:13:29.774541 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
13:13:29.778042 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.779237 [debug] [ThreadPool]: On list_None_homework_db: Close
13:13:29.779834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e7f3d569-59b1-44ce-b2b7-2cc5f671fe0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8442030940>]}
13:13:29.780265 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:13:29.780500 [info ] [MainThread]: 
13:13:29.783524 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
13:13:29.783837 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
13:13:29.784289 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
13:13:29.784584 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
13:13:29.784768 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
13:13:29.803266 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:13:29.811642 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
13:13:29.815041 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.823236 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
13:13:29.826862 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.832917 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
13:13:29.836328 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.841849 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
13:13:29.845212 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.849409 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
13:13:29.849824 [debug] [Thread-1  ]: finished collecting timing info
13:13:29.850006 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
13:13:29.869464 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
13:13:29.872903 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.875423 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
13:13:29.878099 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.879186 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
13:13:29.882368 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.883437 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
13:13:29.885807 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:13:29.909035 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
13:13:29.909588 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
13:13:57.252937 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:13:57.253219 [debug] [MainThread]: clickhouse adapter: Cancelling query 'model.dbt_starschema_2.lineorder_flat'
13:13:57.253625 [debug] [MainThread]: Connection 'master' was properly closed.
13:13:57.253802 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was left open.
13:13:57.253907 [debug] [MainThread]: On model.dbt_starschema_2.lineorder_flat: Close
13:13:57.254100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844066ec70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844066ee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f844066e8b0>]}


============================== 2022-06-10 13:14:02.811417 | ca9ae6fa-ed2d-425b-bb8a-fc3d86cc0d35 ==============================
13:14:02.811432 [info ] [MainThread]: Running with dbt=1.1.0
13:14:02.811800 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
13:14:02.811974 [debug] [MainThread]: Tracking: tracking
13:14:02.821176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa01ba7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa01ba7970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa01bb3850>]}
13:14:02.822783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa01bb3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa01bb3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faa01bb31c0>]}


============================== 2022-06-10 13:14:21.542062 | 49099568-7b0c-4b42-8bc7-a7413a84323c ==============================
13:14:21.542080 [info ] [MainThread]: Running with dbt=1.1.0
13:14:21.542579 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
13:14:21.542802 [debug] [MainThread]: Tracking: tracking
13:14:21.552078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee095c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee095c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee095c7c0>]}
13:14:21.577302 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:14:21.577631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '49099568-7b0c-4b42-8bc7-a7413a84323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee090aaf0>]}
13:14:21.594765 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:14:21.598635 [debug] [MainThread]: Parsing macros/catalog.sql
13:14:21.600165 [debug] [MainThread]: Parsing macros/adapters.sql
13:14:21.633908 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:14:21.634863 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:14:21.660352 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:14:21.664119 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:14:21.665260 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:14:21.690445 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:14:21.692981 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:14:21.694448 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:14:21.695992 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:14:21.697334 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:14:21.698015 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:14:21.698836 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:14:21.699690 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:14:21.708066 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:14:21.712442 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:14:21.716782 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:14:21.719643 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:14:21.726828 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:14:21.729508 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:14:21.738906 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:14:21.748264 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:14:21.750441 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:14:21.754210 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:14:21.756498 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:14:21.773050 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:14:21.779097 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:14:21.780420 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:14:21.787031 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:14:21.789645 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:14:21.791905 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:14:21.794672 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:14:21.802121 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:14:21.803630 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:14:21.813316 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:14:21.828676 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:14:21.843322 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:14:21.847707 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:14:21.860125 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:14:21.870803 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:14:21.872472 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:14:21.888431 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:14:21.890222 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:14:21.894648 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:14:21.896503 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:14:21.899441 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:14:21.902561 [debug] [MainThread]: Parsing macros/generate_source.sql
13:14:21.909501 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:14:21.912360 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:14:21.913600 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:14:21.914946 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:14:21.920417 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:14:21.923832 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:14:21.933664 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:14:21.938701 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:14:21.939974 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:14:21.941591 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:14:21.943035 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:14:21.944046 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:14:21.945546 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:14:21.947533 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:14:21.949495 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:14:21.951022 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:14:21.951979 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:14:21.953127 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:14:21.954150 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:14:21.957420 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:14:21.958990 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:14:21.961736 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:14:21.962666 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:14:21.964831 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:14:21.970528 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:14:21.971832 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:14:21.980363 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:14:21.982106 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:14:21.983281 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:14:21.984623 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:14:21.985833 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:14:21.988423 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:14:21.990589 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:14:21.992952 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:14:21.996874 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:14:21.998837 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:14:22.000499 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:14:22.002568 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:14:22.004224 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:14:22.012439 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:14:22.014490 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:14:22.015856 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:14:22.018644 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:14:22.020353 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:14:22.022169 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:14:22.023417 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:14:22.024635 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:14:22.025728 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:14:22.026847 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:14:22.029100 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:14:22.030649 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:14:22.038762 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:14:22.044422 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:14:22.051451 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:14:22.053185 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:14:22.056645 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:14:22.058267 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:14:22.062495 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:14:22.068324 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:14:22.069684 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:14:22.075914 [debug] [MainThread]: Parsing macros/sql/star.sql
13:14:22.079239 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:14:22.082512 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:14:22.085229 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:14:22.089579 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:14:22.091211 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:14:22.095327 [debug] [MainThread]: Parsing macros/sql/union.sql
13:14:22.106097 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:14:22.109607 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:14:22.111245 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:14:22.134946 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:14:22.136928 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:14:22.138440 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:14:22.504898 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
13:14:22.558287 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
13:14:22.653323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49099568-7b0c-4b42-8bc7-a7413a84323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee099c130>]}
13:14:22.661107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49099568-7b0c-4b42-8bc7-a7413a84323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee090c070>]}
13:14:22.661421 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:14:22.661640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49099568-7b0c-4b42-8bc7-a7413a84323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee0995bb0>]}
13:14:22.663020 [info ] [MainThread]: 
13:14:22.663507 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:14:22.664445 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
13:14:22.669562 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:14:22.687277 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
13:14:22.689780 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:14:22.690962 [debug] [ThreadPool]: On list_schemas: Close
13:14:22.691918 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
13:14:22.697153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:14:22.704771 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
13:14:22.707710 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:14:22.708777 [debug] [ThreadPool]: On list_None_homework_db: Close
13:14:22.709253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49099568-7b0c-4b42-8bc7-a7413a84323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee0848fa0>]}
13:14:22.709774 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:14:22.710049 [info ] [MainThread]: 
13:14:22.713134 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
13:14:22.713435 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
13:14:22.713864 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
13:14:22.714138 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
13:14:22.714290 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
13:14:22.733229 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:14:22.741794 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
13:14:22.745002 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:14:22.748092 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
13:14:22.751284 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:14:22.754419 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
13:14:22.757743 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:14:22.760797 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
13:14:22.764628 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:14:22.765920 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
13:14:22.766343 [debug] [Thread-1  ]: finished collecting timing info
13:14:22.766521 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
13:14:22.785797 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
13:14:22.796688 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:14:22.797871 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
13:14:22.809825 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:14:22.811242 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
13:14:22.820854 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:14:22.821967 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
13:14:22.829561 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:14:22.854376 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
13:14:22.854930 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,
      ,
      ,
      ,
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
13:14:22.860500 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
 b"Code: 62. DB::Exception: Syntax error: failed at position 587 (',') (line 27, col 7): ,\n      ,\n      ,\n  FROM homework_db.src_lineorder AS l\n  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\n  INNER JOIN homew
13:14:22.860701 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
13:14:22.861008 [debug] [Thread-1  ]: finished collecting timing info
13:14:22.861339 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
   b"Code: 62. DB::Exception: Syntax error: failed at position 587 (',') (line 27, col 7): ,\n      ,\n      ,\n  FROM homework_db.src_lineorder AS l\n  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\n  INNER JOIN homew
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:14:22.861593 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '49099568-7b0c-4b42-8bc7-a7413a84323c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ede637190>]}
13:14:22.861920 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 0.15s]
13:14:22.862357 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
13:14:22.863483 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:14:22.863824 [info ] [MainThread]: 
13:14:22.864110 [info ] [MainThread]: Finished running 1 table model in 0.20s.
13:14:22.864319 [debug] [MainThread]: Connection 'master' was properly closed.
13:14:22.864473 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
13:14:22.871997 [info ] [MainThread]: 
13:14:22.872229 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:14:22.872506 [info ] [MainThread]: 
13:14:22.872774 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
13:14:22.873016 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 400)
13:14:22.873240 [error] [MainThread]:    b"Code: 62. DB::Exception: Syntax error: failed at position 587 (',') (line 27, col 7): ,\n      ,\n      ,\n  FROM homework_db.src_lineorder AS l\n  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY\n  INNER JOIN homew
13:14:22.873515 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:14:22.873773 [info ] [MainThread]: 
13:14:22.874001 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:14:22.874316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee07a5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee09ee790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ee09eec40>]}


============================== 2022-06-10 13:21:12.922550 | 27eca5e6-3843-44ca-b059-d074f750407d ==============================
13:21:12.922564 [info ] [MainThread]: Running with dbt=1.1.0
13:21:12.922962 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
13:21:12.923100 [debug] [MainThread]: Tracking: tracking
13:21:12.932194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417acfda90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417acfdb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417acfd640>]}
13:21:12.933776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417acfd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417acfda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f417acfd640>]}


============================== 2022-06-10 13:21:37.159270 | 693ec3c1-4855-4407-b993-082311978c63 ==============================
13:21:37.159287 [info ] [MainThread]: Running with dbt=1.1.0
13:21:37.159836 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
13:21:37.160052 [debug] [MainThread]: Tracking: tracking
13:21:37.168957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22c50700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22c507f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22c50820>]}
13:21:37.193232 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:21:37.193587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '693ec3c1-4855-4407-b993-082311978c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22c087c0>]}
13:21:37.210947 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:21:37.214780 [debug] [MainThread]: Parsing macros/catalog.sql
13:21:37.216300 [debug] [MainThread]: Parsing macros/adapters.sql
13:21:37.251004 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:21:37.252018 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:21:37.277263 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:21:37.280980 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:21:37.282094 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:21:37.308100 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:21:37.310517 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:21:37.311917 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:21:37.313566 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:21:37.314857 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:21:37.315508 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:21:37.316294 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:21:37.317111 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:21:37.325107 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:21:37.329407 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:21:37.333647 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:21:37.336496 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:21:37.343612 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:21:37.346263 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:21:37.355746 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:21:37.365101 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:21:37.367275 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:21:37.371059 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:21:37.373371 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:21:37.389499 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:21:37.395680 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:21:37.397095 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:21:37.404072 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:21:37.406828 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:21:37.409150 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:21:37.411938 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:21:37.419386 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:21:37.420935 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:21:37.430831 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:21:37.446441 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:21:37.461673 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:21:37.466109 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:21:37.477826 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:21:37.488061 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:21:37.489639 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:21:37.505119 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:21:37.506913 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:21:37.511323 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:21:37.513163 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:21:37.515979 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:21:37.518920 [debug] [MainThread]: Parsing macros/generate_source.sql
13:21:37.525654 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:21:37.528572 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:21:37.529849 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:21:37.531219 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:21:37.536955 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:21:37.540363 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:21:37.550034 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:21:37.554958 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:21:37.556186 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:21:37.557791 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:21:37.559194 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:21:37.560192 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:21:37.561686 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:21:37.563547 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:21:37.565529 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:21:37.566997 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:21:37.567915 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:21:37.568989 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:21:37.569979 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:21:37.573102 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:21:37.574495 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:21:37.577238 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:21:37.578193 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:21:37.580351 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:21:37.585995 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:21:37.587155 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:21:37.595373 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:21:37.597160 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:21:37.598335 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:21:37.599690 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:21:37.600900 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:21:37.603679 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:21:37.605884 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:21:37.608326 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:21:37.612285 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:21:37.614205 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:21:37.615757 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:21:37.617762 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:21:37.619307 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:21:37.627553 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:21:37.629647 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:21:37.630989 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:21:37.633761 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:21:37.635468 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:21:37.637300 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:21:37.638547 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:21:37.639771 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:21:37.640870 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:21:37.642017 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:21:37.644305 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:21:37.645861 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:21:37.653743 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:21:37.659345 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:21:37.666178 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:21:37.667836 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:21:37.671088 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:21:37.672640 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:21:37.676742 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:21:37.682429 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:21:37.683738 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:21:37.689591 [debug] [MainThread]: Parsing macros/sql/star.sql
13:21:37.692769 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:21:37.696046 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:21:37.698771 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:21:37.703101 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:21:37.704773 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:21:37.708833 [debug] [MainThread]: Parsing macros/sql/union.sql
13:21:37.718713 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:21:37.721854 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:21:37.723390 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:21:37.746780 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:21:37.748829 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:21:37.750373 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:21:38.115964 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
13:21:38.168754 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
13:21:38.267131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '693ec3c1-4855-4407-b993-082311978c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22c9a970>]}
13:21:38.274890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '693ec3c1-4855-4407-b993-082311978c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22c090d0>]}
13:21:38.275216 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:21:38.275441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '693ec3c1-4855-4407-b993-082311978c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22c09070>]}
13:21:38.276752 [info ] [MainThread]: 
13:21:38.277258 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:21:38.278146 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
13:21:38.283435 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:21:38.306032 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
13:21:38.309665 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:21:38.310823 [debug] [ThreadPool]: On list_schemas: Close
13:21:38.311882 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
13:21:38.317138 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:21:38.325274 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
13:21:38.328733 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:21:38.329801 [debug] [ThreadPool]: On list_None_homework_db: Close
13:21:38.330307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '693ec3c1-4855-4407-b993-082311978c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22b4b640>]}
13:21:38.330766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:21:38.331031 [info ] [MainThread]: 
13:21:38.334243 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
13:21:38.334552 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
13:21:38.334978 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
13:21:38.335194 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
13:21:38.335342 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
13:21:38.341671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:21:38.352061 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
13:21:38.362935 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:21:38.364381 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
13:21:38.372643 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:21:38.373767 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
13:21:38.381980 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:21:38.383089 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
13:21:38.395714 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
13:21:38.409405 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
13:21:38.413925 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:21:38.422166 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
13:21:38.426447 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:21:38.432287 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
13:21:38.436596 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:21:38.442129 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
13:21:38.445902 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:21:38.450164 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
13:21:38.450573 [debug] [Thread-1  ]: finished collecting timing info
13:21:38.450748 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
13:21:38.491352 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
13:21:38.491954 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    



    
    
    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
13:26:38.622626 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
13:26:38.622896 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
13:26:38.623227 [debug] [Thread-1  ]: finished collecting timing info
13:26:38.623652 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:26:38.623959 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '693ec3c1-4855-4407-b993-082311978c63', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d2217f880>]}
13:26:38.624326 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 300.29s]
13:26:38.624810 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
13:26:38.626060 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:26:38.626408 [info ] [MainThread]: 
13:26:38.626663 [info ] [MainThread]: Finished running 1 table model in 300.35s.
13:26:38.626875 [debug] [MainThread]: Connection 'master' was properly closed.
13:26:38.626994 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
13:26:38.634572 [info ] [MainThread]: 
13:26:38.634838 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:26:38.635097 [info ] [MainThread]: 
13:26:38.635328 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
13:26:38.635567 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
13:26:38.635792 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
13:26:38.636045 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:26:38.636297 [info ] [MainThread]: 
13:26:38.636583 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:26:38.636946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d221468b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22c799a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0d22c799d0>]}


============================== 2022-06-13 12:50:09.259935 | 034d532a-e112-408a-bb1b-01e352b0c82d ==============================
12:50:09.259946 [info ] [MainThread]: Running with dbt=1.1.0
12:50:09.304548 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
12:50:09.304690 [debug] [MainThread]: Tracking: tracking
12:50:09.313190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a932f5fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a932f5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a932f5f10>]}
12:50:09.534702 [debug] [MainThread]: Executing "git --help"
12:50:09.545898 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
12:50:09.546242 [debug] [MainThread]: STDERR: "b''"
12:50:09.551772 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
12:50:09.552121 [debug] [MainThread]: Opening a new connection, currently in state init
12:50:09.570224 [debug] [MainThread]: clickhouse adapter: On debug: select 1 as id...
12:50:09.572962 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:50:09.573864 [debug] [MainThread]: On debug: Close
12:50:09.574158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a93218d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a931d4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a931d43a0>]}
12:50:10.121296 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-13 12:50:55.408626 | 14fed1b7-0d56-475b-ad64-8f9271d88fa5 ==============================
12:50:55.408640 [info ] [MainThread]: Running with dbt=1.1.0
12:50:55.408997 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
12:50:55.409154 [debug] [MainThread]: Tracking: tracking
12:50:55.416920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c299aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c299ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c299a640>]}
12:50:55.418263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c299a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c299aa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5c299a640>]}


============================== 2022-06-13 12:51:08.883164 | b67fe300-70f2-4be8-8a69-5c5feabe8dc4 ==============================
12:51:08.883181 [info ] [MainThread]: Running with dbt=1.1.0
12:51:08.883612 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
12:51:08.883794 [debug] [MainThread]: Tracking: tracking
12:51:08.893060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf273c730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf273c820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf273c850>]}
12:51:08.935465 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
12:51:08.935760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b67fe300-70f2-4be8-8a69-5c5feabe8dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf26eeee0>]}
12:51:09.295540 [debug] [MainThread]: Parsing macros/init_s3_source.sql
12:51:09.300318 [debug] [MainThread]: Parsing macros/catalog.sql
12:51:09.301617 [debug] [MainThread]: Parsing macros/adapters.sql
12:51:09.330742 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
12:51:09.331586 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
12:51:09.353087 [debug] [MainThread]: Parsing macros/materializations/seed.sql
12:51:09.356254 [debug] [MainThread]: Parsing macros/materializations/test.sql
12:51:09.357207 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
12:51:09.379509 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
12:51:09.381562 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
12:51:09.382760 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
12:51:09.384063 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
12:51:09.385177 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
12:51:09.385739 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
12:51:09.386398 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
12:51:09.387135 [debug] [MainThread]: Parsing macros/etc/datetime.sql
12:51:09.394028 [debug] [MainThread]: Parsing macros/etc/statement.sql
12:51:09.397663 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
12:51:09.401341 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
12:51:09.403763 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
12:51:09.409796 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
12:51:09.412106 [debug] [MainThread]: Parsing macros/adapters/columns.sql
12:51:09.419984 [debug] [MainThread]: Parsing macros/adapters/relation.sql
12:51:09.427816 [debug] [MainThread]: Parsing macros/adapters/schema.sql
12:51:09.429636 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
12:51:09.432787 [debug] [MainThread]: Parsing macros/materializations/configs.sql
12:51:09.434740 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
12:51:09.448539 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
12:51:09.453636 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
12:51:09.454804 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
12:51:09.460569 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
12:51:09.462812 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
12:51:09.464687 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
12:51:09.467022 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
12:51:09.473274 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
12:51:09.474552 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
12:51:09.482872 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
12:51:09.496124 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
12:51:09.508850 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
12:51:09.512610 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
12:51:09.523044 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
12:51:09.531997 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
12:51:09.533429 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
12:51:09.547078 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
12:51:09.548586 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
12:51:09.552291 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
12:51:09.553811 [debug] [MainThread]: Parsing tests/generic/builtin.sql
12:51:09.556292 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
12:51:09.558942 [debug] [MainThread]: Parsing macros/generate_source.sql
12:51:09.564611 [debug] [MainThread]: Parsing macros/generate_base_model.sql
12:51:09.567057 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
12:51:09.568154 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
12:51:09.569328 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
12:51:09.574339 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
12:51:09.577229 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
12:51:09.585396 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
12:51:09.589674 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
12:51:09.590720 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
12:51:09.592076 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
12:51:09.593266 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
12:51:09.594097 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
12:51:09.595367 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
12:51:09.596965 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
12:51:09.598704 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
12:51:09.599992 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
12:51:09.600873 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
12:51:09.601796 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
12:51:09.602680 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
12:51:09.605417 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
12:51:09.606745 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
12:51:09.609080 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
12:51:09.609892 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
12:51:09.611749 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
12:51:09.616605 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
12:51:09.617677 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
12:51:09.624864 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
12:51:09.626345 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
12:51:09.627382 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
12:51:09.628518 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
12:51:09.629500 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
12:51:09.631808 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
12:51:09.633613 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
12:51:09.635587 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
12:51:09.638953 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
12:51:09.640617 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
12:51:09.641971 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
12:51:09.643749 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
12:51:09.645133 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
12:51:09.652427 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
12:51:09.654234 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
12:51:09.655457 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
12:51:09.657777 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
12:51:09.659271 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
12:51:09.660769 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
12:51:09.661820 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
12:51:09.662844 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
12:51:09.663768 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
12:51:09.664762 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
12:51:09.666675 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
12:51:09.668040 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
12:51:09.674722 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
12:51:09.679477 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
12:51:09.685310 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
12:51:09.686741 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
12:51:09.689663 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
12:51:09.691039 [debug] [MainThread]: Parsing macros/sql/pivot.sql
12:51:09.694608 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
12:51:09.699425 [debug] [MainThread]: Parsing macros/sql/groupby.sql
12:51:09.700556 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
12:51:09.705727 [debug] [MainThread]: Parsing macros/sql/star.sql
12:51:09.708503 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
12:51:09.711315 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
12:51:09.713582 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
12:51:09.717239 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
12:51:09.718616 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
12:51:09.722047 [debug] [MainThread]: Parsing macros/sql/union.sql
12:51:09.730808 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
12:51:09.733640 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
12:51:09.735023 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
12:51:09.755039 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
12:51:09.756764 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
12:51:09.758093 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
12:51:10.070417 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
12:51:10.114630 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
12:51:10.198765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b67fe300-70f2-4be8-8a69-5c5feabe8dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf27893d0>]}
12:51:10.205717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b67fe300-70f2-4be8-8a69-5c5feabe8dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf26df040>]}
12:51:10.206021 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
12:51:10.206218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67fe300-70f2-4be8-8a69-5c5feabe8dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf26df070>]}
12:51:10.207397 [info ] [MainThread]: 
12:51:10.207890 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:51:10.208777 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
12:51:10.213375 [debug] [ThreadPool]: Opening a new connection, currently in state init
12:51:10.243768 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
12:51:10.246451 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:51:10.247500 [debug] [ThreadPool]: On list_schemas: Close
12:51:10.248476 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
12:51:10.253192 [debug] [ThreadPool]: Opening a new connection, currently in state closed
12:51:10.261367 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
12:51:10.264303 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:51:10.265329 [debug] [ThreadPool]: On list_None_homework_db: Close
12:51:10.265784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b67fe300-70f2-4be8-8a69-5c5feabe8dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf281fd00>]}
12:51:10.266196 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
12:51:10.266404 [info ] [MainThread]: 
12:51:10.274685 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
12:51:10.275000 [info ] [Thread-1  ]: 1 of 1 START table model homework_db.lineorder_flat ............................ [RUN]
12:51:10.275416 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
12:51:10.275679 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
12:51:10.275824 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
12:51:10.281403 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
12:51:10.290215 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
12:51:10.297344 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:51:10.298677 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
12:51:10.305865 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:51:10.306955 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
12:51:10.313437 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:51:10.314525 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
12:51:10.321035 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
12:51:10.333004 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
12:51:10.337679 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:51:10.344093 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
12:51:10.347726 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:51:10.352269 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
12:51:10.356995 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:51:10.361417 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
12:51:10.364798 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
12:51:10.367799 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
12:51:10.368176 [debug] [Thread-1  ]: finished collecting timing info
12:51:10.368327 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
12:51:10.404230 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
12:51:10.404715 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */


  
    create table homework_db.lineorder_flat__dbt_tmp
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    



    
    
    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )...
12:56:10.532642 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
12:56:10.532839 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
12:56:10.533148 [debug] [Thread-1  ]: finished collecting timing info
12:56:10.533544 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:56:10.533819 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b67fe300-70f2-4be8-8a69-5c5feabe8dc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf24e4a00>]}
12:56:10.534156 [error] [Thread-1  ]: 1 of 1 ERROR creating table model homework_db.lineorder_flat ................... [[31mERROR[0m in 300.26s]
12:56:10.534626 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
12:56:10.535918 [debug] [MainThread]: Acquiring new clickhouse connection "master"
12:56:10.536237 [info ] [MainThread]: 
12:56:10.536448 [info ] [MainThread]: Finished running 1 table model in 300.33s.
12:56:10.536646 [debug] [MainThread]: Connection 'master' was properly closed.
12:56:10.536752 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
12:56:10.544077 [info ] [MainThread]: 
12:56:10.544303 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
12:56:10.544553 [info ] [MainThread]: 
12:56:10.544775 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
12:56:10.544997 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
12:56:10.545215 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat__dbt_tmp already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
12:56:10.545423 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
12:56:10.545652 [info ] [MainThread]: 
12:56:10.545872 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
12:56:10.546213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf1c2c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf2760a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cf27609d0>]}


============================== 2022-06-13 13:13:27.227495 | bd37424e-b049-4d3f-85bb-6fa8f68d02b2 ==============================
13:13:27.227509 [info ] [MainThread]: Running with dbt=1.1.0
13:13:27.227841 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
13:13:27.228002 [debug] [MainThread]: Tracking: tracking
13:13:27.235955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a96dbd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a96dbd1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a96dbd100>]}
13:13:27.237342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a96dbd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a96dbd1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0a96dbd100>]}


============================== 2022-06-13 13:15:02.146703 | 8a65a0d3-6075-43eb-a460-be8aa6232fd5 ==============================
13:15:02.146718 [info ] [MainThread]: Running with dbt=1.1.0
13:15:02.147176 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
13:15:02.147343 [debug] [MainThread]: Tracking: tracking
13:15:02.154994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4521168760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4521168850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4521168880>]}
13:15:02.175308 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:15:02.175576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8a65a0d3-6075-43eb-a460-be8aa6232fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4521120850>]}
13:15:02.189870 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:15:02.193082 [debug] [MainThread]: Parsing macros/catalog.sql
13:15:02.194338 [debug] [MainThread]: Parsing macros/adapters.sql
13:15:02.223231 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:15:02.224039 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:15:02.245347 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:15:02.248520 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:15:02.249449 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:15:02.271738 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:15:02.273789 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:15:02.275045 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:15:02.276316 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:15:02.277434 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:15:02.278005 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:15:02.278701 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:15:02.279392 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:15:02.286294 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:15:02.289837 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:15:02.293310 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:15:02.295639 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:15:02.301559 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:15:02.303797 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:15:02.311746 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:15:02.319844 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:15:02.321649 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:15:02.324894 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:15:02.326903 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:15:02.340619 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:15:02.345729 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:15:02.346899 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:15:02.352711 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:15:02.354996 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:15:02.356899 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:15:02.359265 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:15:02.365354 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:15:02.366602 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:15:02.374664 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:15:02.387748 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:15:02.400244 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:15:02.403962 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:15:02.414350 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:15:02.423300 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:15:02.424708 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:15:02.438243 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:15:02.439788 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:15:02.443513 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:15:02.445048 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:15:02.447590 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:15:02.450231 [debug] [MainThread]: Parsing macros/generate_source.sql
13:15:02.455987 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:15:02.458408 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:15:02.459499 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:15:02.460645 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:15:02.465383 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:15:02.468187 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:15:02.476255 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:15:02.480496 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:15:02.481555 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:15:02.482963 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:15:02.484191 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:15:02.485075 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:15:02.486360 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:15:02.488035 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:15:02.489744 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:15:02.491098 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:15:02.491933 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:15:02.492905 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:15:02.493794 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:15:02.496579 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:15:02.497890 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:15:02.500185 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:15:02.500974 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:15:02.502803 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:15:02.507516 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:15:02.508613 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:15:02.515767 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:15:02.517307 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:15:02.518357 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:15:02.519567 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:15:02.520614 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:15:02.522994 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:15:02.524828 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:15:02.526841 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:15:02.530189 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:15:02.531876 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:15:02.533258 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:15:02.535028 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:15:02.536381 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:15:02.543558 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:15:02.545328 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:15:02.546542 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:15:02.548889 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:15:02.550365 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:15:02.551896 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:15:02.552959 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:15:02.554002 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:15:02.555000 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:15:02.556106 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:15:02.558262 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:15:02.559775 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:15:02.566977 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:15:02.571700 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:15:02.577722 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:15:02.579146 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:15:02.582024 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:15:02.583429 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:15:02.586929 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:15:02.591706 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:15:02.592854 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:15:02.598023 [debug] [MainThread]: Parsing macros/sql/star.sql
13:15:02.600805 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:15:02.603667 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:15:02.606009 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:15:02.609596 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:15:02.610966 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:15:02.614295 [debug] [MainThread]: Parsing macros/sql/union.sql
13:15:02.623152 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:15:02.625948 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:15:02.627359 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:15:02.647642 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:15:02.649316 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:15:02.650668 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:15:02.958221 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
13:15:03.003847 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
13:15:03.086799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8a65a0d3-6075-43eb-a460-be8aa6232fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452114c7c0>]}
13:15:03.093348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8a65a0d3-6075-43eb-a460-be8aa6232fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452111a040>]}
13:15:03.093635 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:15:03.093847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a65a0d3-6075-43eb-a460-be8aa6232fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4523bead60>]}
13:15:03.095007 [info ] [MainThread]: 
13:15:03.095448 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:15:03.096289 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
13:15:03.100870 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:15:03.117871 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
13:15:03.120900 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.121962 [debug] [ThreadPool]: On list_schemas: Close
13:15:03.122908 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
13:15:03.127291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:15:03.135308 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
13:15:03.138558 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.139568 [debug] [ThreadPool]: On list_None_homework_db: Close
13:15:03.140071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8a65a0d3-6075-43eb-a460-be8aa6232fd5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4521092190>]}
13:15:03.140465 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:15:03.140694 [info ] [MainThread]: 
13:15:03.143493 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
13:15:03.143751 [info ] [Thread-1  ]: 1 of 1 START incremental model homework_db.lineorder_flat ...................... [RUN]
13:15:03.144107 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
13:15:03.144290 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
13:15:03.144417 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
13:15:03.150680 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:15:03.158916 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
13:15:03.161805 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.162786 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
13:15:03.165664 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.166609 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
13:15:03.168852 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.169739 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
13:15:03.172056 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.183698 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
13:15:03.187909 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.195246 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
13:15:03.199198 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.204169 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
13:15:03.207435 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.211965 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
13:15:03.215675 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:15:03.219572 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
13:15:03.219959 [debug] [Thread-1  ]: finished collecting timing info
13:15:03.220128 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
13:15:03.275526 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
13:15:03.276035 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

      

  
    create table homework_db.lineorder_flat
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    



    
    
    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  )
  ...
13:15:21.400673 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:15:21.400930 [debug] [MainThread]: clickhouse adapter: Cancelling query 'model.dbt_starschema_2.lineorder_flat'
13:15:21.401244 [debug] [MainThread]: Connection 'master' was properly closed.
13:15:21.401413 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was left open.
13:15:21.401558 [debug] [MainThread]: On model.dbt_starschema_2.lineorder_flat: Close
13:15:21.401827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452069b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452069baf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452069bdc0>]}


============================== 2022-06-13 13:39:47.836851 | ca3914f1-a220-42b1-ae37-1e6294b7f5bd ==============================
13:39:47.836864 [info ] [MainThread]: Running with dbt=1.1.0
13:39:47.837237 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
13:39:47.837408 [debug] [MainThread]: Tracking: tracking
13:39:47.845949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ebdb4850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ebdc0070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ebdc0160>]}
13:39:47.847409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ebdc01f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ebdc02e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f84ebdc0160>]}


============================== 2022-06-13 13:39:54.439224 | 226559ad-1894-45e4-8d71-fad7beafdf8d ==============================
13:39:54.439245 [info ] [MainThread]: Running with dbt=1.1.0
13:39:54.439750 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
13:39:54.439956 [debug] [MainThread]: Tracking: tracking
13:39:54.448914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca747c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca748b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca748e0>]}
13:39:54.473692 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
13:39:54.474041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '226559ad-1894-45e4-8d71-fad7beafdf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca258b0>]}
13:39:54.493159 [debug] [MainThread]: Parsing macros/init_s3_source.sql
13:39:54.497529 [debug] [MainThread]: Parsing macros/catalog.sql
13:39:54.499738 [debug] [MainThread]: Parsing macros/adapters.sql
13:39:54.533532 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
13:39:54.534566 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
13:39:54.558999 [debug] [MainThread]: Parsing macros/materializations/seed.sql
13:39:54.562650 [debug] [MainThread]: Parsing macros/materializations/test.sql
13:39:54.563837 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
13:39:54.588937 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
13:39:54.591498 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
13:39:54.592977 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
13:39:54.594492 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
13:39:54.595804 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
13:39:54.596509 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
13:39:54.597302 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
13:39:54.598118 [debug] [MainThread]: Parsing macros/etc/datetime.sql
13:39:54.605910 [debug] [MainThread]: Parsing macros/etc/statement.sql
13:39:54.610116 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
13:39:54.614343 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
13:39:54.617191 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
13:39:54.623896 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
13:39:54.626383 [debug] [MainThread]: Parsing macros/adapters/columns.sql
13:39:54.635222 [debug] [MainThread]: Parsing macros/adapters/relation.sql
13:39:54.644293 [debug] [MainThread]: Parsing macros/adapters/schema.sql
13:39:54.646474 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
13:39:54.650078 [debug] [MainThread]: Parsing macros/materializations/configs.sql
13:39:54.652334 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
13:39:54.668028 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
13:39:54.673986 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
13:39:54.675443 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
13:39:54.682202 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
13:39:54.684915 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
13:39:54.687226 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
13:39:54.690006 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
13:39:54.697397 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
13:39:54.699034 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
13:39:54.708323 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
13:39:54.723416 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
13:39:54.738076 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
13:39:54.742545 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
13:39:54.754294 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
13:39:54.764447 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
13:39:54.766051 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
13:39:54.781472 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
13:39:54.783393 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
13:39:54.787804 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
13:39:54.789668 [debug] [MainThread]: Parsing tests/generic/builtin.sql
13:39:54.792579 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
13:39:54.795609 [debug] [MainThread]: Parsing macros/generate_source.sql
13:39:54.802041 [debug] [MainThread]: Parsing macros/generate_base_model.sql
13:39:54.804895 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
13:39:54.806173 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
13:39:54.807565 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
13:39:54.813102 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
13:39:54.816342 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
13:39:54.825586 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
13:39:54.830311 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
13:39:54.831571 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
13:39:54.833118 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
13:39:54.834518 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
13:39:54.835492 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
13:39:54.836946 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
13:39:54.838797 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
13:39:54.840711 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
13:39:54.842179 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
13:39:54.843134 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
13:39:54.844237 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
13:39:54.845279 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
13:39:54.848452 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
13:39:54.849940 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
13:39:54.852698 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
13:39:54.853641 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
13:39:54.855810 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
13:39:54.861296 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
13:39:54.862556 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
13:39:54.870618 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
13:39:54.872431 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
13:39:54.873726 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
13:39:54.875171 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
13:39:54.876479 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
13:39:54.879266 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
13:39:54.881416 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
13:39:54.883734 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
13:39:54.887561 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
13:39:54.889517 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
13:39:54.891147 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
13:39:54.893208 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
13:39:54.894838 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
13:39:54.903354 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
13:39:54.905550 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
13:39:54.906981 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
13:39:54.909780 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
13:39:54.911633 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
13:39:54.913448 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
13:39:54.914729 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
13:39:54.915925 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
13:39:54.917040 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
13:39:54.918215 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
13:39:54.920478 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
13:39:54.921984 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
13:39:54.929440 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
13:39:54.934689 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
13:39:54.941247 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
13:39:54.942890 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
13:39:54.946100 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
13:39:54.947644 [debug] [MainThread]: Parsing macros/sql/pivot.sql
13:39:54.951629 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
13:39:54.957067 [debug] [MainThread]: Parsing macros/sql/groupby.sql
13:39:54.958357 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
13:39:54.964160 [debug] [MainThread]: Parsing macros/sql/star.sql
13:39:54.967260 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
13:39:54.970448 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
13:39:54.973073 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
13:39:54.977263 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
13:39:54.978937 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
13:39:54.982980 [debug] [MainThread]: Parsing macros/sql/union.sql
13:39:54.993114 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
13:39:54.996477 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
13:39:54.998155 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
13:39:55.020936 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
13:39:55.022963 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
13:39:55.024507 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
13:39:55.374796 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
13:39:55.429103 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
13:39:55.527457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '226559ad-1894-45e4-8d71-fad7beafdf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca4ed90>]}
13:39:55.534825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '226559ad-1894-45e4-8d71-fad7beafdf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca280a0>]}
13:39:55.535151 [info ] [MainThread]: Found 1 model, 0 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
13:39:55.535418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '226559ad-1894-45e4-8d71-fad7beafdf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca28100>]}
13:39:55.536537 [info ] [MainThread]: 
13:39:55.537008 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:39:55.537846 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
13:39:55.542927 [debug] [ThreadPool]: Opening a new connection, currently in state init
13:39:55.561621 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
13:39:55.564246 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.565364 [debug] [ThreadPool]: On list_schemas: Close
13:39:55.566395 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
13:39:55.571832 [debug] [ThreadPool]: Opening a new connection, currently in state closed
13:39:55.581010 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
13:39:55.584726 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.585962 [debug] [ThreadPool]: On list_None_homework_db: Close
13:39:55.586628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '226559ad-1894-45e4-8d71-fad7beafdf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5c91e490>]}
13:39:55.587123 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
13:39:55.587407 [info ] [MainThread]: 
13:39:55.590540 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
13:39:55.590874 [info ] [Thread-1  ]: 1 of 1 START incremental model homework_db.lineorder_flat ...................... [RUN]
13:39:55.591403 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
13:39:55.591672 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
13:39:55.591830 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
13:39:55.600673 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
13:39:55.611185 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
13:39:55.614022 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.615188 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
13:39:55.618956 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.620048 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
13:39:55.622658 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.623698 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
13:39:55.626387 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.639264 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
13:39:55.644320 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.652415 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
13:39:55.656763 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.662252 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
13:39:55.665786 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.671263 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
13:39:55.676413 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
13:39:55.680858 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
13:39:55.681302 [debug] [Thread-1  ]: finished collecting timing info
13:39:55.681488 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
13:39:55.739717 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
13:39:55.740275 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

      

  
    create table homework_db.lineorder_flat
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    



    
    
    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  
  )
  ...
13:44:55.865402 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
13:44:55.865593 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
13:44:55.865915 [debug] [Thread-1  ]: finished collecting timing info
13:44:55.866250 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:44:55.866524 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '226559ad-1894-45e4-8d71-fad7beafdf8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca25af0>]}
13:44:55.866851 [error] [Thread-1  ]: 1 of 1 ERROR creating incremental model homework_db.lineorder_flat ............. [[31mERROR[0m in 300.28s]
13:44:55.867292 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
13:44:55.868458 [debug] [MainThread]: Acquiring new clickhouse connection "master"
13:44:55.868801 [info ] [MainThread]: 
13:44:55.869053 [info ] [MainThread]: Finished running 1 incremental model in 300.33s.
13:44:55.869313 [debug] [MainThread]: Connection 'master' was properly closed.
13:44:55.869463 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
13:44:55.876621 [info ] [MainThread]: 
13:44:55.876863 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
13:44:55.877165 [info ] [MainThread]: 
13:44:55.877422 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
13:44:55.877665 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
13:44:55.877904 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
13:44:55.878137 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
13:44:55.878394 [info ] [MainThread]: 
13:44:55.878715 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
13:44:55.879077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca99c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5ca28130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5d5caac220>]}


============================== 2022-06-13 14:25:14.623367 | 8d007ef8-9a35-4799-99ef-6f4266402b2c ==============================
14:25:14.623386 [info ] [MainThread]: Running with dbt=1.1.0
14:25:14.623913 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:25:14.624076 [debug] [MainThread]: Tracking: tracking
14:25:14.632978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8a52c6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8a52c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8a52c7f0>]}
14:25:14.668107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8a347e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8a4c9b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3e8a4c9130>]}


============================== 2022-06-13 14:25:38.362544 | 42a140d1-34c4-4962-91b1-5f5340df4b11 ==============================
14:25:38.362562 [info ] [MainThread]: Running with dbt=1.1.0
14:25:38.363087 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:25:38.363301 [debug] [MainThread]: Tracking: tracking
14:25:38.372076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cf20c6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cf20c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cf20c7c0>]}
14:25:38.422736 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
14:25:38.423196 [debug] [MainThread]: Partial parsing: added file: dbt_starschema_2://models/lineorder_flat.yml
14:25:38.462716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42a140d1-34c4-4962-91b1-5f5340df4b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cef7c100>]}
14:25:38.470482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42a140d1-34c4-4962-91b1-5f5340df4b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cf10ec70>]}
14:25:38.470832 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:25:38.471102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42a140d1-34c4-4962-91b1-5f5340df4b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cef7de80>]}
14:25:38.472590 [info ] [MainThread]: 
14:25:38.473170 [debug] [MainThread]: Acquiring new clickhouse connection "master"
14:25:38.473930 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
14:25:38.483376 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:25:38.504773 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
14:25:38.510830 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.01 seconds
14:25:38.512241 [debug] [ThreadPool]: On list_None_homework_db: Close
14:25:38.512932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42a140d1-34c4-4962-91b1-5f5340df4b11', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cf1af0d0>]}
14:25:38.513380 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:25:38.513631 [info ] [MainThread]: 
14:25:38.516819 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
14:25:38.517188 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
14:25:38.517433 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
14:25:38.517591 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
14:25:38.529668 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:25:38.537518 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
14:25:38.539963 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:25:38.541157 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
14:25:38.543728 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:25:38.544775 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
14:25:38.547161 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:25:38.548393 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
14:25:38.550786 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:25:38.587784 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
14:25:38.592672 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:25:38.602067 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
14:25:38.606318 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:25:38.611874 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
14:25:38.616723 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:25:38.622261 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
14:25:38.626148 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:25:38.637528 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
14:25:38.637921 [debug] [Thread-1  ]: finished collecting timing info
14:25:38.638088 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
14:25:38.638278 [debug] [Thread-1  ]: finished collecting timing info
14:25:38.638420 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
14:25:38.638893 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
14:25:38.639738 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:25:38.640154 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:25:38.640355 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:25:38.640465 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:25:38.651604 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:25:38.651996 [debug] [Thread-1  ]: finished collecting timing info
14:25:38.652150 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:25:38.652259 [debug] [Thread-1  ]: finished collecting timing info
14:25:38.652600 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:25:38.652779 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:25:38.653107 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:25:38.653239 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:25:38.653336 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:25:38.656542 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:25:38.656815 [debug] [Thread-1  ]: finished collecting timing info
14:25:38.656946 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:25:38.657054 [debug] [Thread-1  ]: finished collecting timing info
14:25:38.657360 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:25:38.658535 [debug] [MainThread]: Connection 'master' was properly closed.
14:25:38.658699 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
14:25:38.666675 [info ] [MainThread]: Done.
14:25:38.697494 [debug] [MainThread]: Acquiring new clickhouse connection "generate_catalog"
14:25:38.697740 [info ] [MainThread]: Building catalog
14:25:38.699190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cf030a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cce74d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd3cce74b50>]}
14:25:39.198779 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.


============================== 2022-06-13 14:30:45.439558 | 4a5f8f04-b77f-4731-ad25-186a22fddeb8 ==============================
14:30:45.439577 [info ] [MainThread]: Running with dbt=1.1.0
14:30:45.440080 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:30:45.440317 [debug] [MainThread]: Tracking: tracking
14:30:45.449559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e545c9820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e545c9880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e545c98b0>]}
14:30:45.485326 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
14:30:45.485752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4a5f8f04-b77f-4731-ad25-186a22fddeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e54575a00>]}
14:30:45.502822 [debug] [MainThread]: Parsing macros/init_s3_source.sql
14:30:45.506635 [debug] [MainThread]: Parsing macros/catalog.sql
14:30:45.508150 [debug] [MainThread]: Parsing macros/adapters.sql
14:30:45.541392 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
14:30:45.542357 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
14:30:45.566994 [debug] [MainThread]: Parsing macros/materializations/seed.sql
14:30:45.570559 [debug] [MainThread]: Parsing macros/materializations/test.sql
14:30:45.571688 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
14:30:45.597142 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
14:30:45.599623 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
14:30:45.601026 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
14:30:45.602542 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
14:30:45.603830 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
14:30:45.604474 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
14:30:45.605225 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
14:30:45.606040 [debug] [MainThread]: Parsing macros/etc/datetime.sql
14:30:45.614126 [debug] [MainThread]: Parsing macros/etc/statement.sql
14:30:45.618590 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
14:30:45.622749 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
14:30:45.625527 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
14:30:45.632390 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
14:30:45.634930 [debug] [MainThread]: Parsing macros/adapters/columns.sql
14:30:45.643836 [debug] [MainThread]: Parsing macros/adapters/relation.sql
14:30:45.652784 [debug] [MainThread]: Parsing macros/adapters/schema.sql
14:30:45.654841 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
14:30:45.658469 [debug] [MainThread]: Parsing macros/materializations/configs.sql
14:30:45.660667 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
14:30:45.676243 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
14:30:45.682178 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
14:30:45.683615 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
14:30:45.690256 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
14:30:45.692895 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
14:30:45.695143 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
14:30:45.697788 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
14:30:45.704928 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
14:30:45.706521 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
14:30:45.715982 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
14:30:45.731234 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
14:30:45.745664 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
14:30:45.750020 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
14:30:45.762062 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
14:30:45.772469 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
14:30:45.774174 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
14:30:45.789953 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
14:30:45.791845 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
14:30:45.796087 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
14:30:45.797865 [debug] [MainThread]: Parsing tests/generic/builtin.sql
14:30:45.800681 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
14:30:45.803691 [debug] [MainThread]: Parsing macros/generate_source.sql
14:30:45.810230 [debug] [MainThread]: Parsing macros/generate_base_model.sql
14:30:45.813075 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
14:30:45.814330 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
14:30:45.815659 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
14:30:45.821281 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
14:30:45.824616 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
14:30:45.834062 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
14:30:45.838823 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
14:30:45.840102 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
14:30:45.841666 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
14:30:45.843088 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
14:30:45.844062 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
14:30:45.845474 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
14:30:45.847313 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
14:30:45.849267 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
14:30:45.850717 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
14:30:45.851651 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
14:30:45.852714 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
14:30:45.853688 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
14:30:45.856852 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
14:30:45.858352 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
14:30:45.861080 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
14:30:45.862006 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
14:30:45.864094 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
14:30:45.869664 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
14:30:45.870957 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
14:30:45.879315 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
14:30:45.881135 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
14:30:45.882369 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
14:30:45.883767 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
14:30:45.884941 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
14:30:45.887627 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
14:30:45.889703 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
14:30:45.892079 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
14:30:45.895956 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
14:30:45.897869 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
14:30:45.899448 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
14:30:45.901425 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
14:30:45.902986 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
14:30:45.911239 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
14:30:45.913332 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
14:30:45.914735 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
14:30:45.917405 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
14:30:45.919107 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
14:30:45.920827 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
14:30:45.922071 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
14:30:45.923240 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
14:30:45.924284 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
14:30:45.925437 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
14:30:45.927622 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
14:30:45.929114 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
14:30:45.936693 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
14:30:45.941968 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
14:30:45.948613 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
14:30:45.950231 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
14:30:45.953516 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
14:30:45.955075 [debug] [MainThread]: Parsing macros/sql/pivot.sql
14:30:45.958998 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
14:30:45.964506 [debug] [MainThread]: Parsing macros/sql/groupby.sql
14:30:45.965821 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
14:30:45.971773 [debug] [MainThread]: Parsing macros/sql/star.sql
14:30:45.975045 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
14:30:45.978305 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
14:30:45.980978 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
14:30:45.985216 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
14:30:45.986894 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
14:30:45.990810 [debug] [MainThread]: Parsing macros/sql/union.sql
14:30:46.000970 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
14:30:46.004261 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
14:30:46.005843 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
14:30:46.028132 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
14:30:46.030172 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
14:30:46.031698 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
14:30:46.382875 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
14:30:46.438868 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
14:30:46.560047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a5f8f04-b77f-4731-ad25-186a22fddeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e54539be0>]}
14:30:46.568492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a5f8f04-b77f-4731-ad25-186a22fddeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5443a8b0>]}
14:30:46.568849 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:30:46.569086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5f8f04-b77f-4731-ad25-186a22fddeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5457d130>]}
14:30:46.570537 [info ] [MainThread]: 
14:30:46.571090 [debug] [MainThread]: Acquiring new clickhouse connection "master"
14:30:46.571910 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
14:30:46.578043 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:46.596582 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
14:30:46.600732 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:30:46.602151 [debug] [ThreadPool]: On list_None_homework_db: Close
14:30:46.603075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a5f8f04-b77f-4731-ad25-186a22fddeb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e545396d0>]}
14:30:46.603545 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:30:46.603800 [info ] [MainThread]: 
14:30:46.606891 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
14:30:46.607278 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
14:30:46.607518 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
14:30:46.607670 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
14:30:46.615445 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:46.624471 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
14:30:46.627507 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:30:46.628782 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
14:30:46.631447 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:30:46.632514 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
14:30:46.635092 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:30:46.636211 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
14:30:46.638863 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:30:46.653142 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
14:30:46.657922 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:30:46.666721 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
14:30:46.670916 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:30:46.677054 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
14:30:46.681177 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:30:46.687085 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
14:30:46.690925 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:30:46.700123 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
14:30:46.700647 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.700890 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
14:30:46.701060 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.701215 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
14:30:46.701762 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
14:30:46.702653 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:30:46.703000 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:30:46.703237 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:30:46.703386 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:30:46.716015 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:30:46.716534 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.716751 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:30:46.716908 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.717362 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:30:46.717569 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:30:46.717957 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:30:46.718103 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:30:46.718258 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:30:46.721903 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:30:46.722327 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.722535 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:30:46.722678 [debug] [Thread-1  ]: finished collecting timing info
14:30:46.723067 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:30:46.724090 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:46.724259 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
14:30:46.732712 [info ] [MainThread]: Done.
14:30:46.735226 [debug] [MainThread]: Acquiring new clickhouse connection "generate_catalog"
14:30:46.735396 [info ] [MainThread]: Building catalog
14:30:46.736753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e5457d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e53ae1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1e53ae1a30>]}
14:30:47.226423 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.


============================== 2022-06-13 14:33:25.429524 | 15bbcd8b-fcd2-4c09-901d-9645604c94f9 ==============================
14:33:25.429540 [info ] [MainThread]: Running with dbt=1.1.0
14:33:25.430011 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:33:25.430227 [debug] [MainThread]: Tracking: tracking
14:33:25.438761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a58f47c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a58f4820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a58f4850>]}
14:33:25.485107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:33:25.485623 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.customer
14:33:25.485759 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.lineorder
14:33:25.485879 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.part
14:33:25.485985 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.supplier
14:33:25.486154 [debug] [MainThread]: Partial parsing: update schema file: dbt_starschema_2://models/sources.yml
14:33:25.496839 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
14:33:25.549793 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
14:33:25.591033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15bbcd8b-fcd2-4c09-901d-9645604c94f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a56aceb0>]}
14:33:25.598886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15bbcd8b-fcd2-4c09-901d-9645604c94f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a5899fa0>]}
14:33:25.599230 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:33:25.599480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15bbcd8b-fcd2-4c09-901d-9645604c94f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a5899e20>]}
14:33:25.600910 [info ] [MainThread]: 
14:33:25.601430 [debug] [MainThread]: Acquiring new clickhouse connection "master"
14:33:25.602195 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
14:33:25.607372 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:33:25.624269 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
14:33:25.627914 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:33:25.629202 [debug] [ThreadPool]: On list_None_homework_db: Close
14:33:25.629824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15bbcd8b-fcd2-4c09-901d-9645604c94f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a5671a00>]}
14:33:25.630259 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:33:25.630536 [info ] [MainThread]: 
14:33:25.633643 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
14:33:25.633976 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
14:33:25.634172 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
14:33:25.634304 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
14:33:25.641435 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:33:25.650083 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
14:33:25.652693 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:33:25.653775 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
14:33:25.656155 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:33:25.657125 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
14:33:25.659385 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:33:25.660362 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
14:33:25.662790 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:33:25.675497 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
14:33:25.679310 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:33:25.687038 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
14:33:25.690688 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:33:25.695605 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
14:33:25.699184 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:33:25.704528 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
14:33:25.707851 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:33:25.714815 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
14:33:25.715157 [debug] [Thread-1  ]: finished collecting timing info
14:33:25.715311 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
14:33:25.715459 [debug] [Thread-1  ]: finished collecting timing info
14:33:25.715575 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
14:33:25.715958 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
14:33:25.716626 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:33:25.716947 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:33:25.717140 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:33:25.717263 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:33:25.727947 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:33:25.728264 [debug] [Thread-1  ]: finished collecting timing info
14:33:25.728418 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:33:25.728584 [debug] [Thread-1  ]: finished collecting timing info
14:33:25.728954 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:33:25.729142 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:33:25.729476 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:33:25.729621 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:33:25.729754 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:33:25.732646 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:33:25.732919 [debug] [Thread-1  ]: finished collecting timing info
14:33:25.733058 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:33:25.733178 [debug] [Thread-1  ]: finished collecting timing info
14:33:25.733503 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:33:25.734221 [debug] [MainThread]: Connection 'master' was properly closed.
14:33:25.734350 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
14:33:25.740749 [info ] [MainThread]: Done.
14:33:25.742531 [debug] [MainThread]: Acquiring new clickhouse connection "generate_catalog"
14:33:25.742773 [info ] [MainThread]: Building catalog
14:33:25.744162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a5899f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a4d64d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23a4d64fd0>]}
14:33:26.233291 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.


============================== 2022-06-13 14:36:14.039659 | b5bf7a30-44d4-4f1f-86aa-b66ada3594a3 ==============================
14:36:14.039676 [info ] [MainThread]: Running with dbt=1.1.0
14:36:14.040129 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:36:14.040307 [debug] [MainThread]: Tracking: tracking
14:36:14.048168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff526ab17f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff526ab1850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff526ab1880>]}
14:36:14.092560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:36:14.093152 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.customer
14:36:14.093298 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.lineorder
14:36:14.093414 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.part
14:36:14.093523 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.supplier
14:36:14.093700 [debug] [MainThread]: Partial parsing: update schema file: dbt_starschema_2://models/sources.yml
14:36:14.105214 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
14:36:14.156976 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
14:36:14.198496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5bf7a30-44d4-4f1f-86aa-b66ada3594a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff52686ef40>]}
14:36:14.206156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5bf7a30-44d4-4f1f-86aa-b66ada3594a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff526a4fd90>]}
14:36:14.206543 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:36:14.206815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5bf7a30-44d4-4f1f-86aa-b66ada3594a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff526a4ff70>]}
14:36:14.208326 [info ] [MainThread]: 
14:36:14.208931 [debug] [MainThread]: Acquiring new clickhouse connection "master"
14:36:14.209706 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
14:36:14.214768 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:36:14.234324 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
14:36:14.237670 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:36:14.238927 [debug] [ThreadPool]: On list_None_homework_db: Close
14:36:14.239497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5bf7a30-44d4-4f1f-86aa-b66ada3594a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff526857e20>]}
14:36:14.239902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:36:14.240143 [info ] [MainThread]: 
14:36:14.242943 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
14:36:14.243249 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
14:36:14.243443 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
14:36:14.243577 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
14:36:14.249963 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:36:14.258486 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
14:36:14.260718 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:36:14.261686 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
14:36:14.264808 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:36:14.265792 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
14:36:14.268125 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:36:14.269063 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
14:36:14.271391 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:36:14.283483 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
14:36:14.287337 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:36:14.295226 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
14:36:14.298938 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:36:14.304430 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
14:36:14.307702 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:36:14.313706 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
14:36:14.317227 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:36:14.324525 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
14:36:14.324870 [debug] [Thread-1  ]: finished collecting timing info
14:36:14.325033 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
14:36:14.325176 [debug] [Thread-1  ]: finished collecting timing info
14:36:14.325302 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
14:36:14.325692 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
14:36:14.326314 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:36:14.326592 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:36:14.326836 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:36:14.326953 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:36:14.337298 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:36:14.337631 [debug] [Thread-1  ]: finished collecting timing info
14:36:14.337784 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:36:14.337920 [debug] [Thread-1  ]: finished collecting timing info
14:36:14.338263 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:36:14.338431 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:36:14.339050 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:36:14.339199 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:36:14.339320 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:36:14.342181 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:36:14.342468 [debug] [Thread-1  ]: finished collecting timing info
14:36:14.342607 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:36:14.342738 [debug] [Thread-1  ]: finished collecting timing info
14:36:14.343039 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:36:14.343704 [debug] [MainThread]: Connection 'master' was properly closed.
14:36:14.343832 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
14:36:14.350109 [info ] [MainThread]: Done.
14:36:14.352156 [debug] [MainThread]: Acquiring new clickhouse connection "generate_catalog"
14:36:14.352307 [info ] [MainThread]: Building catalog
14:36:14.353459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff525f457f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff525f21d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff525f21ee0>]}
14:36:14.932297 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.


============================== 2022-06-13 14:38:30.363387 | 5241b3e0-e0df-4427-b0df-eb253af9cc48 ==============================
14:38:30.363404 [info ] [MainThread]: Running with dbt=1.1.0
14:38:30.363894 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:38:30.364049 [debug] [MainThread]: Tracking: tracking
14:38:30.372796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946ddb4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946ddb48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946ddb4910>]}
14:38:30.424255 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:38:30.424856 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.customer
14:38:30.425057 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.lineorder
14:38:30.425196 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.part
14:38:30.425319 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.supplier
14:38:30.425506 [debug] [MainThread]: Partial parsing: update schema file: dbt_starschema_2://models/sources.yml
14:38:30.437531 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
14:38:30.493174 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
14:38:30.536609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5241b3e0-e0df-4427-b0df-eb253af9cc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946db65f70>]}
14:38:30.544253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5241b3e0-e0df-4427-b0df-eb253af9cc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946dcae5b0>]}
14:38:30.544566 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:38:30.544816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5241b3e0-e0df-4427-b0df-eb253af9cc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946dcae7c0>]}
14:38:30.546080 [info ] [MainThread]: 
14:38:30.546603 [debug] [MainThread]: Acquiring new clickhouse connection "master"
14:38:30.547367 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
14:38:30.552336 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:38:30.571929 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
14:38:30.575778 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:38:30.577208 [debug] [ThreadPool]: On list_None_homework_db: Close
14:38:30.577893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5241b3e0-e0df-4427-b0df-eb253af9cc48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946dd5f910>]}
14:38:30.578400 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:38:30.578716 [info ] [MainThread]: 
14:38:30.581830 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
14:38:30.582226 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
14:38:30.582480 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
14:38:30.582642 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
14:38:30.590267 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:38:30.599188 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
14:38:30.602604 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:38:30.603807 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
14:38:30.606764 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:38:30.607903 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
14:38:30.610533 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:38:30.611715 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
14:38:30.614409 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:38:30.627452 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
14:38:30.631813 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:38:30.638807 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
14:38:30.642974 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:38:30.647845 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
14:38:30.651754 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:38:30.657100 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
14:38:30.660605 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:38:30.667938 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
14:38:30.668296 [debug] [Thread-1  ]: finished collecting timing info
14:38:30.668455 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
14:38:30.668597 [debug] [Thread-1  ]: finished collecting timing info
14:38:30.668720 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
14:38:30.669111 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
14:38:30.669882 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:38:30.670228 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:38:30.670444 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:38:30.670613 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:38:30.682621 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:38:30.683115 [debug] [Thread-1  ]: finished collecting timing info
14:38:30.683303 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:38:30.683447 [debug] [Thread-1  ]: finished collecting timing info
14:38:30.683874 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:38:30.684073 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:38:30.684478 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:38:30.684632 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:38:30.684807 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:38:30.688393 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:38:30.688770 [debug] [Thread-1  ]: finished collecting timing info
14:38:30.688923 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:38:30.689064 [debug] [Thread-1  ]: finished collecting timing info
14:38:30.689443 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:38:30.690325 [debug] [MainThread]: Connection 'master' was properly closed.
14:38:30.690493 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
14:38:30.698051 [info ] [MainThread]: Done.
14:38:30.700677 [debug] [MainThread]: Acquiring new clickhouse connection "generate_catalog"
14:38:30.700883 [info ] [MainThread]: Building catalog
14:38:30.702295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946dcae820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946d225c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f946d225ca0>]}
14:38:31.207523 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.


============================== 2022-06-13 14:39:06.313238 | d965eecf-742b-478e-be0a-65d7ca052199 ==============================
14:39:06.313262 [info ] [MainThread]: Running with dbt=1.1.0
14:39:06.313902 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
14:39:06.314115 [debug] [MainThread]: Tracking: tracking
14:39:06.327001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482eabf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482eabf760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482eabf790>]}
14:39:06.388022 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:39:06.388573 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.customer
14:39:06.388696 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.lineorder
14:39:06.388783 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.part
14:39:06.388864 [debug] [MainThread]: Partial parsing: deleted source source.dbt_starschema_2.homework_db.supplier
14:39:06.389006 [debug] [MainThread]: Partial parsing: update schema file: dbt_starschema_2://models/sources.yml
14:39:06.400497 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
14:39:06.455393 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
14:39:06.497424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd965eecf-742b-478e-be0a-65d7ca052199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482e86df40>]}
14:39:06.505237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd965eecf-742b-478e-be0a-65d7ca052199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482ea63bb0>]}
14:39:06.505565 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
14:39:06.505788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd965eecf-742b-478e-be0a-65d7ca052199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482ea63940>]}
14:39:06.507257 [info ] [MainThread]: 
14:39:06.507756 [debug] [MainThread]: Acquiring new clickhouse connection "master"
14:39:06.508473 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
14:39:06.513667 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:39:06.532957 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
14:39:06.536837 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:39:06.538260 [debug] [ThreadPool]: On list_None_homework_db: Close
14:39:06.538944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd965eecf-742b-478e-be0a-65d7ca052199', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482e8a5c40>]}
14:39:06.539392 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
14:39:06.539645 [info ] [MainThread]: 
14:39:06.542834 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
14:39:06.543210 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
14:39:06.543447 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
14:39:06.543602 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
14:39:06.550980 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:39:06.560318 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
14:39:06.562815 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:39:06.563956 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
14:39:06.566877 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:39:06.567902 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
14:39:06.570227 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:39:06.571245 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
14:39:06.573942 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:39:06.586904 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
14:39:06.590706 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:39:06.598821 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
14:39:06.602926 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:39:06.608370 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
14:39:06.612705 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:39:06.618693 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
14:39:06.622750 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
14:39:06.630442 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
14:39:06.630832 [debug] [Thread-1  ]: finished collecting timing info
14:39:06.631025 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
14:39:06.631180 [debug] [Thread-1  ]: finished collecting timing info
14:39:06.631307 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
14:39:06.631718 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
14:39:06.632439 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:39:06.632735 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:39:06.632928 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:39:06.633045 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:39:06.644305 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
14:39:06.644680 [debug] [Thread-1  ]: finished collecting timing info
14:39:06.644848 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:39:06.644984 [debug] [Thread-1  ]: finished collecting timing info
14:39:06.645352 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
14:39:06.645536 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:39:06.645913 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:39:06.646048 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:39:06.646158 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:39:06.649353 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
14:39:06.649677 [debug] [Thread-1  ]: finished collecting timing info
14:39:06.649834 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:39:06.649972 [debug] [Thread-1  ]: finished collecting timing info
14:39:06.650323 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
14:39:06.651097 [debug] [MainThread]: Connection 'master' was properly closed.
14:39:06.651237 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
14:39:06.658223 [info ] [MainThread]: Done.
14:39:06.660197 [debug] [MainThread]: Acquiring new clickhouse connection "generate_catalog"
14:39:06.660408 [info ] [MainThread]: Building catalog
14:39:06.661838 [debug] [ThreadPool]: Acquiring new clickhouse connection "homework_db"
14:39:06.667423 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:39:06.677032 [debug] [ThreadPool]: clickhouse adapter: On homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "homework_db"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'homework_db')
    order by columns.database, columns.table, columns.position...
14:39:06.682750 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.01 seconds
14:39:06.692176 [debug] [ThreadPool]: On homework_db: Close
14:39:06.703313 [info ] [MainThread]: Catalog written to /home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2/target/catalog.json
14:39:06.703783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482eabf700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482c6e4a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f482c6e4eb0>]}
14:39:07.194326 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
14:39:07.194947 [debug] [MainThread]: Connection 'homework_db' was properly closed.


============================== 2022-06-13 14:42:30.616935 | 8b37de89-2f2d-42d1-8a1c-59e0ac9708ad ==============================
14:42:30.616954 [info ] [MainThread]: Running with dbt=1.1.0
14:42:30.617377 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
14:42:30.617555 [debug] [MainThread]: Tracking: tracking
14:42:30.625363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd5b88790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd5b88910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7cd5b88940>]}
14:42:30.627434 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
14:42:30.627670 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
14:42:30.627904 [info ] [MainThread]: 
14:42:30.628126 [info ] [MainThread]: 
14:42:30.628336 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-13 15:03:04.599198 | ab6cb647-14c5-44b3-9a32-09fb69724ebd ==============================
15:03:04.599211 [info ] [MainThread]: Running with dbt=1.1.0
15:03:04.599519 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
15:03:04.599656 [debug] [MainThread]: Tracking: tracking
15:03:04.607505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83227d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83227d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83227d130>]}
15:03:04.609161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83227da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83227db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe83227d130>]}


============================== 2022-06-13 15:05:33.378835 | 9d9f553a-40d4-45ee-9709-cd24facf090e ==============================
15:05:33.378853 [info ] [MainThread]: Running with dbt=1.1.0
15:05:33.379343 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
15:05:33.379521 [debug] [MainThread]: Tracking: tracking
15:05:33.387378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e61a46850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e61a468b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e61a468e0>]}
15:05:33.408338 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
15:05:33.408611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9d9f553a-40d4-45ee-9709-cd24facf090e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e619f08b0>]}
15:05:33.423421 [debug] [MainThread]: Parsing macros/init_s3_source.sql
15:05:33.426659 [debug] [MainThread]: Parsing macros/catalog.sql
15:05:33.427932 [debug] [MainThread]: Parsing macros/adapters.sql
15:05:33.458156 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
15:05:33.459109 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
15:05:33.481051 [debug] [MainThread]: Parsing macros/materializations/seed.sql
15:05:33.484228 [debug] [MainThread]: Parsing macros/materializations/test.sql
15:05:33.485220 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
15:05:33.508493 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
15:05:33.510721 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
15:05:33.511957 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
15:05:33.513251 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
15:05:33.514372 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
15:05:33.514953 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
15:05:33.515634 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
15:05:33.516333 [debug] [MainThread]: Parsing macros/etc/datetime.sql
15:05:33.523263 [debug] [MainThread]: Parsing macros/etc/statement.sql
15:05:33.527020 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
15:05:33.530597 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
15:05:33.533055 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:05:33.539002 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:05:33.541179 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:05:33.549125 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:05:33.556955 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:05:33.558726 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
15:05:33.561889 [debug] [MainThread]: Parsing macros/materializations/configs.sql
15:05:33.563830 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:05:33.577596 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
15:05:33.582863 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
15:05:33.583998 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
15:05:33.589803 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
15:05:33.592068 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:05:33.593943 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:05:33.596300 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
15:05:33.602582 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
15:05:33.603853 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
15:05:33.612165 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
15:05:33.625510 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
15:05:33.638141 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
15:05:33.641947 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
15:05:33.652624 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
15:05:33.661935 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:05:33.663418 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
15:05:33.677369 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
15:05:33.678952 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:05:33.682668 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
15:05:33.684197 [debug] [MainThread]: Parsing tests/generic/builtin.sql
15:05:33.686630 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
15:05:33.689240 [debug] [MainThread]: Parsing macros/generate_source.sql
15:05:33.694954 [debug] [MainThread]: Parsing macros/generate_base_model.sql
15:05:33.697378 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
15:05:33.698450 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
15:05:33.699621 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
15:05:33.704524 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
15:05:33.707479 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
15:05:33.716517 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
15:05:33.721312 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
15:05:33.722474 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
15:05:33.723940 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
15:05:33.725238 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
15:05:33.726084 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
15:05:33.727373 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
15:05:33.729000 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
15:05:33.730746 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
15:05:33.732061 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
15:05:33.732892 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
15:05:33.733837 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
15:05:33.734723 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
15:05:33.737531 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
15:05:33.738834 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
15:05:33.741256 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
15:05:33.742050 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
15:05:33.744004 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
15:05:33.748894 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
15:05:33.750092 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
15:05:33.758029 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
15:05:33.759786 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
15:05:33.760947 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
15:05:33.762293 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
15:05:33.763439 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
15:05:33.765888 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
15:05:33.767817 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
15:05:33.769929 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
15:05:33.773310 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
15:05:33.775168 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
15:05:33.776735 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
15:05:33.778745 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
15:05:33.780337 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
15:05:33.788312 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
15:05:33.790360 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
15:05:33.791737 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
15:05:33.794207 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
15:05:33.796010 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
15:05:33.797833 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
15:05:33.799148 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
15:05:33.800367 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
15:05:33.801507 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
15:05:33.802727 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
15:05:33.805006 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
15:05:33.806591 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
15:05:33.813339 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
15:05:33.818063 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
15:05:33.823879 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
15:05:33.825374 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
15:05:33.828543 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
15:05:33.830103 [debug] [MainThread]: Parsing macros/sql/pivot.sql
15:05:33.834292 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
15:05:33.839623 [debug] [MainThread]: Parsing macros/sql/groupby.sql
15:05:33.840800 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
15:05:33.845947 [debug] [MainThread]: Parsing macros/sql/star.sql
15:05:33.848736 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
15:05:33.851549 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
15:05:33.853971 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
15:05:33.858101 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
15:05:33.859725 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
15:05:33.863598 [debug] [MainThread]: Parsing macros/sql/union.sql
15:05:33.872701 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
15:05:33.875587 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
15:05:33.876967 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
15:05:33.897048 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
15:05:33.898783 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
15:05:33.900162 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
15:05:34.214369 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
15:05:34.263076 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
15:05:34.359976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d9f553a-40d4-45ee-9709-cd24facf090e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e61a40f70>]}
15:05:34.366823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d9f553a-40d4-45ee-9709-cd24facf090e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e619fa0d0>]}
15:05:34.367127 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
15:05:34.367376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d9f553a-40d4-45ee-9709-cd24facf090e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e619fa130>]}
15:05:34.368475 [info ] [MainThread]: 
15:05:34.368895 [debug] [MainThread]: Acquiring new clickhouse connection "master"
15:05:34.369668 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
15:05:34.374093 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:05:34.391258 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
15:05:34.393655 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:05:34.394822 [debug] [ThreadPool]: On list_schemas: Close
15:05:34.395746 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
15:05:34.400218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:05:34.408814 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
15:05:34.411988 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:05:34.412931 [debug] [ThreadPool]: On list_None_homework_db: Close
15:05:34.413421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d9f553a-40d4-45ee-9709-cd24facf090e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e61938e20>]}
15:05:34.413861 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:05:34.414096 [info ] [MainThread]: 
15:05:34.416719 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
15:05:34.416987 [info ] [Thread-1  ]: 1 of 3 START incremental model homework_db.lineorder_flat ...................... [RUN]
15:05:34.417356 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
15:05:34.417602 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
15:05:34.417738 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
15:05:34.424671 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:05:34.432899 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
15:05:34.454248 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
15:05:34.455498 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
15:05:34.465507 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
15:05:34.466615 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
15:05:34.481091 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
15:05:34.482151 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
15:05:34.497419 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
15:05:34.509318 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
15:05:34.514451 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:05:34.521776 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
15:05:34.525490 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:05:34.530242 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
15:05:34.533670 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:05:34.538189 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
15:05:34.541455 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:05:34.545048 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
15:05:34.545402 [debug] [Thread-1  ]: finished collecting timing info
15:05:34.545550 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
15:05:34.596902 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
15:05:34.597450 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

      

  
    create table homework_db.lineorder_flat
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    



    
    
    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
    

  SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  
  )
  ...
15:10:34.637859 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
15:10:34.638137 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
15:10:34.638427 [debug] [Thread-1  ]: finished collecting timing info
15:10:34.638781 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
15:10:34.639036 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d9f553a-40d4-45ee-9709-cd24facf090e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e617f85e0>]}
15:10:34.639389 [error] [Thread-1  ]: 1 of 3 ERROR creating incremental model homework_db.lineorder_flat ............. [[31mERROR[0m in 300.22s]
15:10:34.639840 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
15:10:34.640677 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:10:34.640822 [info ] [Thread-1  ]: 2 of 3 SKIP test not_null_lineorder_flat_LO_CUSTKEY ............................ [[33mSKIP[0m]
15:10:34.641166 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:10:34.641341 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:10:34.641566 [info ] [Thread-1  ]: 3 of 3 SKIP test not_null_lineorder_flat_LO_REVENUE ............................ [[33mSKIP[0m]
15:10:34.641842 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:10:34.642737 [debug] [MainThread]: Acquiring new clickhouse connection "master"
15:10:34.643032 [info ] [MainThread]: 
15:10:34.643238 [info ] [MainThread]: Finished running 1 incremental model, 2 tests in 300.27s.
15:10:34.643434 [debug] [MainThread]: Connection 'master' was properly closed.
15:10:34.643531 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
15:10:34.650413 [info ] [MainThread]: 
15:10:34.650668 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:10:34.650892 [info ] [MainThread]: 
15:10:34.651100 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
15:10:34.651298 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
15:10:34.651499 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
15:10:34.651692 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
15:10:34.651897 [info ] [MainThread]: 
15:10:34.652132 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
15:10:34.652485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e61a6aaf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e61a7c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e61a7c610>]}


============================== 2022-06-13 15:16:08.540370 | 9ea5c217-1813-40f3-ac03-d2ca369a954a ==============================
15:16:08.540387 [info ] [MainThread]: Running with dbt=1.1.0
15:16:08.540856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
15:16:08.541043 [debug] [MainThread]: Tracking: tracking
15:16:08.548988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2be837c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2be83820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2be83850>]}
15:16:08.592419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
15:16:08.592854 [debug] [MainThread]: Partial parsing: update schema file: dbt_starschema_2://models/lineorder_flat.yml
15:16:08.606813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ea5c217-1813-40f3-ac03-d2ca369a954a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2bcd1c40>]}
15:16:08.613752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ea5c217-1813-40f3-ac03-d2ca369a954a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2bd88520>]}
15:16:08.614053 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
15:16:08.614276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ea5c217-1813-40f3-ac03-d2ca369a954a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2bd88730>]}
15:16:08.615600 [info ] [MainThread]: 
15:16:08.616054 [debug] [MainThread]: Acquiring new clickhouse connection "master"
15:16:08.616816 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
15:16:08.624646 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:16:08.645141 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
15:16:08.649022 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:16:08.650256 [debug] [ThreadPool]: On list_None_homework_db: Close
15:16:08.650861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ea5c217-1813-40f3-ac03-d2ca369a954a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2be25cd0>]}
15:16:08.651268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:16:08.651501 [info ] [MainThread]: 
15:16:08.654300 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
15:16:08.654607 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
15:16:08.654808 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
15:16:08.654940 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
15:16:08.665538 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:16:08.674616 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
15:16:08.677209 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:16:08.678176 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
15:16:08.680591 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:16:08.681514 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
15:16:08.683911 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:16:08.685047 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
15:16:08.687313 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:16:08.721033 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
15:16:08.725980 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:16:08.733308 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
15:16:08.753725 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
15:16:08.759671 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
15:16:08.767200 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
15:16:08.771781 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
15:16:08.777472 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
15:16:08.788018 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
15:16:08.788426 [debug] [Thread-1  ]: finished collecting timing info
15:16:08.788626 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
15:16:08.788776 [debug] [Thread-1  ]: finished collecting timing info
15:16:08.788904 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
15:16:08.789287 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
15:16:08.790126 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:16:08.790427 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
15:16:08.790688 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:16:08.790805 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:16:08.800847 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
15:16:08.801183 [debug] [Thread-1  ]: finished collecting timing info
15:16:08.801325 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:16:08.801446 [debug] [Thread-1  ]: finished collecting timing info
15:16:08.801769 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:16:08.801932 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:16:08.802214 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
15:16:08.802335 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:16:08.802435 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:16:08.805375 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
15:16:08.805621 [debug] [Thread-1  ]: finished collecting timing info
15:16:08.805747 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:16:08.805867 [debug] [Thread-1  ]: finished collecting timing info
15:16:08.806174 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:16:08.806899 [debug] [MainThread]: Connection 'master' was properly closed.
15:16:08.807046 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
15:16:08.813499 [info ] [MainThread]: Done.
15:16:08.815196 [debug] [MainThread]: Acquiring new clickhouse connection "generate_catalog"
15:16:08.815342 [info ] [MainThread]: Building catalog
15:16:08.816509 [debug] [ThreadPool]: Acquiring new clickhouse connection "homework_db"
15:16:08.821520 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:16:08.834694 [debug] [ThreadPool]: clickhouse adapter: On homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "homework_db"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'homework_db')
    order by columns.database, columns.table, columns.position...
15:16:08.844354 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.01 seconds
15:16:08.852060 [debug] [ThreadPool]: On homework_db: Close
15:16:08.861726 [info ] [MainThread]: Catalog written to /home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2/target/catalog.json
15:16:08.862109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2be837c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e2be25fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e29b26f10>]}
15:16:09.354512 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
15:16:09.355187 [debug] [MainThread]: Connection 'homework_db' was properly closed.


============================== 2022-06-13 15:19:06.376330 | 6322757f-8922-443d-9b1e-3e32288d6505 ==============================
15:19:06.376342 [info ] [MainThread]: Running with dbt=1.1.0
15:19:06.376647 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
15:19:06.376747 [debug] [MainThread]: Tracking: tracking
15:19:06.384386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fc3ba4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fc3ba1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fc3ba0d0>]}
15:19:06.385962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fc3baca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fc3bab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f95fc3ba0d0>]}


============================== 2022-06-13 15:20:34.976027 | 55830819-f463-49ae-a65c-2cb64e0e7000 ==============================
15:20:34.976044 [info ] [MainThread]: Running with dbt=1.1.0
15:20:34.976511 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
15:20:34.976685 [debug] [MainThread]: Tracking: tracking
15:20:34.984508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1778039880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f17780398e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1778039910>]}
15:20:35.005312 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
15:20:35.005594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '55830819-f463-49ae-a65c-2cb64e0e7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1777feafa0>]}
15:20:35.021735 [debug] [MainThread]: Parsing macros/init_s3_source.sql
15:20:35.024993 [debug] [MainThread]: Parsing macros/catalog.sql
15:20:35.026255 [debug] [MainThread]: Parsing macros/adapters.sql
15:20:35.055572 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
15:20:35.056417 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
15:20:35.077523 [debug] [MainThread]: Parsing macros/materializations/seed.sql
15:20:35.080680 [debug] [MainThread]: Parsing macros/materializations/test.sql
15:20:35.081670 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
15:20:35.103913 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
15:20:35.105995 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
15:20:35.107215 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
15:20:35.108645 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
15:20:35.109815 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
15:20:35.110408 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
15:20:35.111134 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
15:20:35.111860 [debug] [MainThread]: Parsing macros/etc/datetime.sql
15:20:35.118841 [debug] [MainThread]: Parsing macros/etc/statement.sql
15:20:35.122536 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
15:20:35.126120 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
15:20:35.128525 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
15:20:35.134442 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
15:20:35.136702 [debug] [MainThread]: Parsing macros/adapters/columns.sql
15:20:35.144576 [debug] [MainThread]: Parsing macros/adapters/relation.sql
15:20:35.152364 [debug] [MainThread]: Parsing macros/adapters/schema.sql
15:20:35.154133 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
15:20:35.157338 [debug] [MainThread]: Parsing macros/materializations/configs.sql
15:20:35.159313 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
15:20:35.173010 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
15:20:35.178107 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
15:20:35.179234 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
15:20:35.185018 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
15:20:35.187260 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
15:20:35.189142 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
15:20:35.191552 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
15:20:35.197834 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
15:20:35.199132 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
15:20:35.207746 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
15:20:35.221355 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
15:20:35.234099 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
15:20:35.237895 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
15:20:35.248389 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
15:20:35.257310 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
15:20:35.258742 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
15:20:35.272276 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
15:20:35.273802 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
15:20:35.277478 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
15:20:35.279029 [debug] [MainThread]: Parsing tests/generic/builtin.sql
15:20:35.281472 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
15:20:35.284100 [debug] [MainThread]: Parsing macros/generate_source.sql
15:20:35.289826 [debug] [MainThread]: Parsing macros/generate_base_model.sql
15:20:35.292279 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
15:20:35.293372 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
15:20:35.294537 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
15:20:35.299379 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
15:20:35.302242 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
15:20:35.310520 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
15:20:35.314780 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
15:20:35.315864 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
15:20:35.317209 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
15:20:35.318414 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
15:20:35.319307 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
15:20:35.320696 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
15:20:35.322340 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
15:20:35.324075 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
15:20:35.325356 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
15:20:35.326170 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
15:20:35.327106 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
15:20:35.327971 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
15:20:35.330702 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
15:20:35.331979 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
15:20:35.334275 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
15:20:35.335064 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
15:20:35.336871 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
15:20:35.341678 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
15:20:35.342792 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
15:20:35.350016 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
15:20:35.351555 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
15:20:35.352615 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
15:20:35.353798 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
15:20:35.354831 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
15:20:35.357208 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
15:20:35.359051 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
15:20:35.361070 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
15:20:35.364428 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
15:20:35.366095 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
15:20:35.367469 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
15:20:35.369216 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
15:20:35.370592 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
15:20:35.377791 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
15:20:35.379632 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
15:20:35.380818 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
15:20:35.383153 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
15:20:35.384625 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
15:20:35.386126 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
15:20:35.387190 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
15:20:35.388211 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
15:20:35.389119 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
15:20:35.390092 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
15:20:35.392031 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
15:20:35.393333 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
15:20:35.399969 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
15:20:35.404636 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
15:20:35.410384 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
15:20:35.411811 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
15:20:35.415000 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
15:20:35.416465 [debug] [MainThread]: Parsing macros/sql/pivot.sql
15:20:35.420005 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
15:20:35.424858 [debug] [MainThread]: Parsing macros/sql/groupby.sql
15:20:35.426014 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
15:20:35.431189 [debug] [MainThread]: Parsing macros/sql/star.sql
15:20:35.433942 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
15:20:35.436731 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
15:20:35.439040 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
15:20:35.442678 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
15:20:35.444070 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
15:20:35.447465 [debug] [MainThread]: Parsing macros/sql/union.sql
15:20:35.456435 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
15:20:35.459253 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
15:20:35.460611 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
15:20:35.480614 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
15:20:35.482292 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
15:20:35.483607 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
15:20:35.791596 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
15:20:35.838838 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
15:20:35.932334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55830819-f463-49ae-a65c-2cb64e0e7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1778082a30>]}
15:20:35.939137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55830819-f463-49ae-a65c-2cb64e0e7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1777fec100>]}
15:20:35.939405 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
15:20:35.939598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55830819-f463-49ae-a65c-2cb64e0e7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1777fec160>]}
15:20:35.940734 [info ] [MainThread]: 
15:20:35.941168 [debug] [MainThread]: Acquiring new clickhouse connection "master"
15:20:35.941992 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
15:20:35.946602 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:20:35.966980 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
15:20:35.970067 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:20:35.971205 [debug] [ThreadPool]: On list_schemas: Close
15:20:35.972101 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
15:20:35.976399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
15:20:35.985508 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
15:20:35.988741 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:20:35.989553 [debug] [ThreadPool]: On list_None_homework_db: Close
15:20:35.989930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55830819-f463-49ae-a65c-2cb64e0e7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1777f094f0>]}
15:20:35.990278 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:20:35.990492 [info ] [MainThread]: 
15:20:35.992965 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
15:20:35.993233 [info ] [Thread-1  ]: 1 of 3 START incremental model homework_db.lineorder_flat ...................... [RUN]
15:20:35.993627 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
15:20:35.993833 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
15:20:35.993963 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
15:20:36.000695 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:20:36.011556 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
15:20:39.617222 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 3.61 seconds
15:20:39.618416 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
15:20:39.650488 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.03 seconds
15:20:39.651618 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
15:20:39.659138 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
15:20:39.660142 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
15:20:39.675085 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
15:20:39.686525 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
15:20:39.691815 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
15:20:39.697706 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
15:20:39.701162 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:20:39.705310 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
15:20:39.708960 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:20:39.712869 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
15:20:39.715925 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:20:39.718750 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
15:20:39.719082 [debug] [Thread-1  ]: finished collecting timing info
15:20:39.719219 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
15:20:39.768708 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
15:20:39.769192 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

      

  
    create table homework_db.lineorder_flat
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

    
    
    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
    SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  
  )
  ...
15:25:39.891355 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
15:25:39.891583 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
15:25:39.891890 [debug] [Thread-1  ]: finished collecting timing info
15:25:39.892202 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
15:25:39.892462 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55830819-f463-49ae-a65c-2cb64e0e7000', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1777dad550>]}
15:25:39.892787 [error] [Thread-1  ]: 1 of 3 ERROR creating incremental model homework_db.lineorder_flat ............. [[31mERROR[0m in 303.90s]
15:25:39.893202 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
15:25:39.894002 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:25:39.894173 [info ] [Thread-1  ]: 2 of 3 SKIP test not_null_lineorder_flat_LO_CUSTKEY ............................ [[33mSKIP[0m]
15:25:39.894478 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:25:39.894647 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:25:39.894860 [info ] [Thread-1  ]: 3 of 3 SKIP test not_null_lineorder_flat_LO_REVENUE ............................ [[33mSKIP[0m]
15:25:39.895221 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:25:39.896176 [debug] [MainThread]: Acquiring new clickhouse connection "master"
15:25:39.896489 [info ] [MainThread]: 
15:25:39.896738 [info ] [MainThread]: Finished running 1 incremental model, 2 tests in 303.96s.
15:25:39.896997 [debug] [MainThread]: Connection 'master' was properly closed.
15:25:39.897106 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
15:25:39.903717 [info ] [MainThread]: 
15:25:39.903907 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
15:25:39.904132 [info ] [MainThread]: 
15:25:39.904349 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
15:25:39.904546 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
15:25:39.904732 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
15:25:39.904918 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
15:25:39.905155 [info ] [MainThread]: 
15:25:39.905375 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
15:25:39.905689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f177810e460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1778082f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1778082d60>]}


============================== 2022-06-13 15:28:04.654333 | a3966d8c-427f-4d17-821e-92231568e13e ==============================
15:28:04.654348 [info ] [MainThread]: Running with dbt=1.1.0
15:28:04.654832 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
15:28:04.654962 [debug] [MainThread]: Tracking: tracking
15:28:04.662852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20275d37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20275d3850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20275d3880>]}
15:28:04.706288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
15:28:04.706521 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
15:28:04.711767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3966d8c-427f-4d17-821e-92231568e13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f202741c7f0>]}
15:28:04.718944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3966d8c-427f-4d17-821e-92231568e13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2027400130>]}
15:28:04.719211 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
15:28:04.719439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3966d8c-427f-4d17-821e-92231568e13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20274003a0>]}
15:28:04.720762 [info ] [MainThread]: 
15:28:04.721240 [debug] [MainThread]: Acquiring new clickhouse connection "master"
15:28:04.721979 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
15:28:04.730077 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:28:04.748566 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
15:28:04.752015 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:28:04.753201 [debug] [ThreadPool]: On list_None_homework_db: Close
15:28:04.753740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3966d8c-427f-4d17-821e-92231568e13e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2027584be0>]}
15:28:04.754134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
15:28:04.754376 [info ] [MainThread]: 
15:28:04.757130 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
15:28:04.757413 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
15:28:04.757591 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
15:28:04.757716 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
15:28:04.768467 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
15:28:04.777184 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
15:28:04.779778 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:28:04.780726 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
15:28:04.784121 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:28:04.785004 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
15:28:04.787662 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:28:04.788757 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
15:28:04.791307 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:28:04.824122 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
15:28:04.828332 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:28:04.836125 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
15:28:04.840301 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:28:04.845125 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
15:28:04.849129 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:28:04.853645 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
15:28:04.856955 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
15:28:04.866879 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
15:28:04.867233 [debug] [Thread-1  ]: finished collecting timing info
15:28:04.867404 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
15:28:04.867541 [debug] [Thread-1  ]: finished collecting timing info
15:28:04.867665 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
15:28:04.868056 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
15:28:04.868756 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:28:04.869029 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
15:28:04.869215 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:28:04.869321 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:28:04.880332 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
15:28:04.880646 [debug] [Thread-1  ]: finished collecting timing info
15:28:04.880785 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:28:04.880904 [debug] [Thread-1  ]: finished collecting timing info
15:28:04.881215 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
15:28:04.881370 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:28:04.881663 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
15:28:04.881783 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:28:04.881881 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:28:04.884686 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
15:28:04.884933 [debug] [Thread-1  ]: finished collecting timing info
15:28:04.885062 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:28:04.885177 [debug] [Thread-1  ]: finished collecting timing info
15:28:04.885482 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
15:28:04.886163 [debug] [MainThread]: Connection 'master' was properly closed.
15:28:04.886310 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
15:28:04.893666 [info ] [MainThread]: Done.
15:28:04.895367 [debug] [MainThread]: Acquiring new clickhouse connection "generate_catalog"
15:28:04.895498 [info ] [MainThread]: Building catalog
15:28:04.896718 [debug] [ThreadPool]: Acquiring new clickhouse connection "homework_db"
15:28:04.901548 [debug] [ThreadPool]: Opening a new connection, currently in state init
15:28:04.911461 [debug] [ThreadPool]: clickhouse adapter: On homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "homework_db"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'homework_db')
    order by columns.database, columns.table, columns.position...
15:28:04.918119 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.01 seconds
15:28:04.925946 [debug] [ThreadPool]: On homework_db: Close
15:28:04.936191 [info ] [MainThread]: Catalog written to /home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2/target/catalog.json
15:28:04.936582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20275d37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f20253037c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2025303dc0>]}
15:28:05.415700 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
15:28:05.416177 [debug] [MainThread]: Connection 'homework_db' was properly closed.


============================== 2022-06-14 06:35:44.515311 | 924496bc-7a71-46bb-b109-a1295eeaa303 ==============================
06:35:44.515324 [info ] [MainThread]: Running with dbt=1.1.0
06:35:44.541483 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
06:35:44.541631 [debug] [MainThread]: Tracking: tracking
06:35:44.551978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe232cb6eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe232cb6df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe232cb6e20>]}
06:35:44.919931 [debug] [MainThread]: Executing "git --help"
06:35:44.923554 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
06:35:44.923947 [debug] [MainThread]: STDERR: "b''"
06:35:44.931461 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
06:35:44.931879 [debug] [MainThread]: Opening a new connection, currently in state init
06:35:44.976032 [debug] [MainThread]: clickhouse adapter: On debug: select 1 as id...
06:35:44.979945 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:35:44.981048 [debug] [MainThread]: On debug: Close
06:35:44.981407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe232bdbfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe232b97070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe232b97160>]}
06:35:45.568351 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-14 06:35:53.799725 | c1146b20-5c6c-4a81-8bc5-3154ed65e9ca ==============================
06:35:53.799744 [info ] [MainThread]: Running with dbt=1.1.0
06:35:53.800221 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
06:35:53.800425 [debug] [MainThread]: Tracking: tracking
06:35:53.809734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10d897c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10d89820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10d89850>]}
06:35:54.197209 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
06:35:54.197474 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
06:35:54.205795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c1146b20-5c6c-4a81-8bc5-3154ed65e9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10bd2790>]}
06:35:54.234251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c1146b20-5c6c-4a81-8bc5-3154ed65e9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10bb60d0>]}
06:35:54.234655 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
06:35:54.234943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1146b20-5c6c-4a81-8bc5-3154ed65e9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10bb6340>]}
06:35:54.236453 [info ] [MainThread]: 
06:35:54.237044 [debug] [MainThread]: Acquiring new clickhouse connection "master"
06:35:54.238065 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
06:35:54.248194 [debug] [ThreadPool]: Opening a new connection, currently in state init
06:35:54.292514 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
06:35:54.296412 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:35:54.297894 [debug] [ThreadPool]: On list_None_homework_db: Close
06:35:54.298583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c1146b20-5c6c-4a81-8bc5-3154ed65e9ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10d312b0>]}
06:35:54.299111 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
06:35:54.299402 [info ] [MainThread]: 
06:35:54.307813 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
06:35:54.308040 [info ] [Thread-1  ]: 1 of 2 START test not_null_lineorder_flat_LO_CUSTKEY ........................... [RUN]
06:35:54.308501 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
06:35:54.308795 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
06:35:54.308979 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
06:35:54.322045 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
06:35:54.322507 [debug] [Thread-1  ]: finished collecting timing info
06:35:54.322709 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
06:35:54.337264 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
06:35:54.337778 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:35:54.347564 [debug] [Thread-1  ]: clickhouse adapter: On test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select LO_CUSTKEY
from homework_db.lineorder_flat
where LO_CUSTKEY is null



      
    ) as dbt_internal_test...
06:35:54.353215 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:35:54.355201 [debug] [Thread-1  ]: finished collecting timing info
06:35:54.355400 [debug] [Thread-1  ]: On test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647: Close
06:35:54.355720 [info ] [Thread-1  ]: 1 of 2 PASS not_null_lineorder_flat_LO_CUSTKEY ................................. [[32mPASS[0m in 0.05s]
06:35:54.356121 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
06:35:54.356357 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
06:35:54.356669 [info ] [Thread-1  ]: 2 of 2 START test not_null_lineorder_flat_LO_REVENUE ........................... [RUN]
06:35:54.357088 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
06:35:54.357297 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
06:35:54.357490 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
06:35:54.361394 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
06:35:54.361802 [debug] [Thread-1  ]: finished collecting timing info
06:35:54.361992 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
06:35:54.364625 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
06:35:54.364998 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:35:54.374118 [debug] [Thread-1  ]: clickhouse adapter: On test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select LO_REVENUE
from homework_db.lineorder_flat
where LO_REVENUE is null



      
    ) as dbt_internal_test...
06:35:54.379509 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:35:54.380814 [debug] [Thread-1  ]: finished collecting timing info
06:35:54.381018 [debug] [Thread-1  ]: On test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854: Close
06:35:54.381350 [info ] [Thread-1  ]: 2 of 2 PASS not_null_lineorder_flat_LO_REVENUE ................................. [[32mPASS[0m in 0.02s]
06:35:54.381776 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
06:35:54.382858 [debug] [MainThread]: Acquiring new clickhouse connection "master"
06:35:54.383178 [info ] [MainThread]: 
06:35:54.383482 [info ] [MainThread]: Finished running 2 tests in 0.15s.
06:35:54.383821 [debug] [MainThread]: Connection 'master' was properly closed.
06:35:54.383989 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
06:35:54.392991 [info ] [MainThread]: 
06:35:54.393253 [info ] [MainThread]: [32mCompleted successfully[0m
06:35:54.393605 [info ] [MainThread]: 
06:35:54.393897 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
06:35:54.394295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10bb6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10bb6430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a10bb6190>]}


============================== 2022-06-14 06:50:01.817991 | 75502c2c-f7db-4edc-b7ab-ee70a78d2009 ==============================
06:50:01.818006 [info ] [MainThread]: Running with dbt=1.1.0
06:50:01.818412 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
06:50:01.818598 [debug] [MainThread]: Tracking: tracking
06:50:01.827697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a4dd070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a4dd130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a4dd160>]}
06:50:01.829574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a4dd370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a4dd280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f251a4dd160>]}


============================== 2022-06-14 06:52:13.090496 | 61723904-883d-451a-8037-7b397ed5daab ==============================
06:52:13.090516 [info ] [MainThread]: Running with dbt=1.1.0
06:52:13.091048 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
06:52:13.091282 [debug] [MainThread]: Tracking: tracking
06:52:13.100586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab9896d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab989730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab989760>]}
06:52:13.126474 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
06:52:13.126837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '61723904-883d-451a-8037-7b397ed5daab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab939df0>]}
06:52:13.164285 [debug] [MainThread]: Parsing macros/init_s3_source.sql
06:52:13.168307 [debug] [MainThread]: Parsing macros/catalog.sql
06:52:13.169934 [debug] [MainThread]: Parsing macros/adapters.sql
06:52:13.204862 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
06:52:13.205944 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
06:52:13.232671 [debug] [MainThread]: Parsing macros/materializations/seed.sql
06:52:13.236476 [debug] [MainThread]: Parsing macros/materializations/test.sql
06:52:13.237652 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
06:52:13.264499 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
06:52:13.267046 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
06:52:13.268544 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
06:52:13.270066 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
06:52:13.271429 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
06:52:13.272121 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
06:52:13.272917 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
06:52:13.273919 [debug] [MainThread]: Parsing macros/etc/datetime.sql
06:52:13.282454 [debug] [MainThread]: Parsing macros/etc/statement.sql
06:52:13.286887 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
06:52:13.291051 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
06:52:13.293840 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
06:52:13.300920 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
06:52:13.303565 [debug] [MainThread]: Parsing macros/adapters/columns.sql
06:52:13.312904 [debug] [MainThread]: Parsing macros/adapters/relation.sql
06:52:13.322058 [debug] [MainThread]: Parsing macros/adapters/schema.sql
06:52:13.324279 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
06:52:13.328166 [debug] [MainThread]: Parsing macros/materializations/configs.sql
06:52:13.330563 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
06:52:13.346836 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
06:52:13.352986 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
06:52:13.354390 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
06:52:13.361126 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
06:52:13.363735 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
06:52:13.365944 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
06:52:13.368776 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
06:52:13.376218 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
06:52:13.377752 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
06:52:13.387736 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
06:52:13.403651 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
06:52:13.418602 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
06:52:13.423081 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
06:52:13.435723 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
06:52:13.446508 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
06:52:13.448278 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
06:52:13.464641 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
06:52:13.466588 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
06:52:13.471033 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
06:52:13.472868 [debug] [MainThread]: Parsing tests/generic/builtin.sql
06:52:13.475875 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
06:52:13.479137 [debug] [MainThread]: Parsing macros/generate_source.sql
06:52:13.486362 [debug] [MainThread]: Parsing macros/generate_base_model.sql
06:52:13.489307 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
06:52:13.490638 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
06:52:13.492057 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
06:52:13.497835 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
06:52:13.501301 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
06:52:13.511072 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
06:52:13.516030 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
06:52:13.517328 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
06:52:13.518948 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
06:52:13.520392 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
06:52:13.521395 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
06:52:13.522929 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
06:52:13.524928 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
06:52:13.526954 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
06:52:13.528485 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
06:52:13.529444 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
06:52:13.530611 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
06:52:13.531658 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
06:52:13.534955 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
06:52:13.536516 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
06:52:13.539351 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
06:52:13.540315 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
06:52:13.542487 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
06:52:13.548234 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
06:52:13.549545 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
06:52:13.558179 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
06:52:13.559954 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
06:52:13.561142 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
06:52:13.562503 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
06:52:13.563711 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
06:52:13.566452 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
06:52:13.568622 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
06:52:13.571064 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
06:52:13.575067 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
06:52:13.577033 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
06:52:13.578660 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
06:52:13.580716 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
06:52:13.582354 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
06:52:13.590749 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
06:52:13.592914 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
06:52:13.594332 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
06:52:13.597120 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
06:52:13.598853 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
06:52:13.600647 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
06:52:13.601930 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
06:52:13.603185 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
06:52:13.604306 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
06:52:13.605466 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
06:52:13.607790 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
06:52:13.609357 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
06:52:13.617284 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
06:52:13.622970 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
06:52:13.629918 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
06:52:13.631611 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
06:52:13.634908 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
06:52:13.636478 [debug] [MainThread]: Parsing macros/sql/pivot.sql
06:52:13.640753 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
06:52:13.646592 [debug] [MainThread]: Parsing macros/sql/groupby.sql
06:52:13.647948 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
06:52:13.654194 [debug] [MainThread]: Parsing macros/sql/star.sql
06:52:13.657528 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
06:52:13.660880 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
06:52:13.663623 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
06:52:13.668036 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
06:52:13.669716 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
06:52:13.673850 [debug] [MainThread]: Parsing macros/sql/union.sql
06:52:13.684887 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
06:52:13.688520 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
06:52:13.690284 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
06:52:13.714922 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
06:52:13.717136 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
06:52:13.718818 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
06:52:14.087149 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
06:52:14.145491 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
06:52:14.264359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61723904-883d-451a-8037-7b397ed5daab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab9d8100>]}
06:52:14.273681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61723904-883d-451a-8037-7b397ed5daab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab9adb80>]}
06:52:14.274063 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
06:52:14.274319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61723904-883d-451a-8037-7b397ed5daab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab965eb0>]}
06:52:14.275718 [info ] [MainThread]: 
06:52:14.276279 [debug] [MainThread]: Acquiring new clickhouse connection "master"
06:52:14.277234 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
06:52:14.282704 [debug] [ThreadPool]: Opening a new connection, currently in state init
06:52:14.304599 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
06:52:14.311332 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:52:14.312746 [debug] [ThreadPool]: On list_schemas: Close
06:52:14.313807 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
06:52:14.319178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
06:52:14.329137 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
06:52:14.332989 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
06:52:14.334081 [debug] [ThreadPool]: On list_None_homework_db: Close
06:52:14.334594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61723904-883d-451a-8037-7b397ed5daab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab95cf70>]}
06:52:14.335113 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
06:52:14.335396 [info ] [MainThread]: 
06:52:14.338587 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
06:52:14.338899 [info ] [Thread-1  ]: 1 of 3 START incremental model homework_db.lineorder_flat ...................... [RUN]
06:52:14.339344 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
06:52:14.339650 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
06:52:14.339808 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
06:52:14.348274 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
06:52:14.360034 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
06:52:14.373661 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:52:14.375013 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
06:52:14.384093 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:52:14.385288 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
06:52:14.395474 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:52:14.396704 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
06:52:14.406346 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:52:14.420513 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
06:52:14.426619 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:52:14.434220 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
06:52:14.439957 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:52:14.445422 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
06:52:14.451010 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:52:14.456420 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
06:52:14.462164 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
06:52:14.465996 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
06:52:14.466428 [debug] [Thread-1  ]: finished collecting timing info
06:52:14.466599 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
06:52:14.528502 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
06:52:14.529036 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

      

  
    create table homework_db.lineorder_flat
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

    
    
    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
    SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  
  )
  ...
06:57:14.670979 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
06:57:14.671237 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
06:57:14.671637 [debug] [Thread-1  ]: finished collecting timing info
06:57:14.672006 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
06:57:14.672278 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61723904-883d-451a-8037-7b397ed5daab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab989d30>]}
06:57:14.672634 [error] [Thread-1  ]: 1 of 3 ERROR creating incremental model homework_db.lineorder_flat ............. [[31mERROR[0m in 300.33s]
06:57:14.673223 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
06:57:14.674132 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
06:57:14.674299 [info ] [Thread-1  ]: 2 of 3 SKIP test not_null_lineorder_flat_LO_CUSTKEY ............................ [[33mSKIP[0m]
06:57:14.674760 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
06:57:14.674991 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
06:57:14.675235 [info ] [Thread-1  ]: 3 of 3 SKIP test not_null_lineorder_flat_LO_REVENUE ............................ [[33mSKIP[0m]
06:57:14.675594 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
06:57:14.676671 [debug] [MainThread]: Acquiring new clickhouse connection "master"
06:57:14.677029 [info ] [MainThread]: 
06:57:14.677271 [info ] [MainThread]: Finished running 1 incremental model, 2 tests in 300.40s.
06:57:14.677480 [debug] [MainThread]: Connection 'master' was properly closed.
06:57:14.677634 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
06:57:14.685709 [info ] [MainThread]: 
06:57:14.686014 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
06:57:14.686353 [info ] [MainThread]: 
06:57:14.686639 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
06:57:14.686906 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
06:57:14.687135 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
06:57:14.687387 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
06:57:14.687740 [info ] [MainThread]: 
06:57:14.688000 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
06:57:14.688305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab9adf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab9c1310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe8ab9c1220>]}


============================== 2022-06-14 07:52:47.927675 | 32cbdea7-2a35-4df8-95e6-8fba85b44fd3 ==============================
07:52:47.927690 [info ] [MainThread]: Running with dbt=1.1.0
07:52:47.928039 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
07:52:47.928154 [debug] [MainThread]: Tracking: tracking
07:52:47.936996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50c21d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50c219d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50c2c580>]}
07:52:47.938433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50c2c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50c2c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efe50c2cb80>]}


============================== 2022-06-14 07:54:22.832260 | 92bcad00-d852-4b88-8dc4-69e98dda779a ==============================
07:54:22.832279 [info ] [MainThread]: Running with dbt=1.1.0
07:54:22.832780 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
07:54:22.833027 [debug] [MainThread]: Tracking: tracking
07:54:22.842124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a691eb820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a691eb880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a691eb8b0>]}
07:54:22.865884 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
07:54:22.866213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '92bcad00-d852-4b88-8dc4-69e98dda779a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6919cf40>]}
07:54:22.883605 [debug] [MainThread]: Parsing macros/init_s3_source.sql
07:54:22.887409 [debug] [MainThread]: Parsing macros/catalog.sql
07:54:22.888874 [debug] [MainThread]: Parsing macros/adapters.sql
07:54:22.922856 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
07:54:22.923837 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
07:54:22.949214 [debug] [MainThread]: Parsing macros/materializations/seed.sql
07:54:22.952998 [debug] [MainThread]: Parsing macros/materializations/test.sql
07:54:22.954187 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
07:54:22.980791 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
07:54:22.983318 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
07:54:22.984781 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
07:54:22.986358 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
07:54:22.987711 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
07:54:22.988389 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
07:54:22.989172 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
07:54:22.989990 [debug] [MainThread]: Parsing macros/etc/datetime.sql
07:54:22.998276 [debug] [MainThread]: Parsing macros/etc/statement.sql
07:54:23.002633 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
07:54:23.006877 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
07:54:23.009693 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
07:54:23.016729 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
07:54:23.019259 [debug] [MainThread]: Parsing macros/adapters/columns.sql
07:54:23.028171 [debug] [MainThread]: Parsing macros/adapters/relation.sql
07:54:23.037537 [debug] [MainThread]: Parsing macros/adapters/schema.sql
07:54:23.039728 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
07:54:23.043407 [debug] [MainThread]: Parsing macros/materializations/configs.sql
07:54:23.045611 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
07:54:23.061886 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
07:54:23.067883 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
07:54:23.069181 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
07:54:23.075825 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
07:54:23.078482 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
07:54:23.080715 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
07:54:23.083464 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
07:54:23.090831 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
07:54:23.092307 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
07:54:23.101836 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
07:54:23.116682 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
07:54:23.131335 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
07:54:23.135640 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
07:54:23.147410 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
07:54:23.157549 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
07:54:23.159160 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
07:54:23.174950 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
07:54:23.176706 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
07:54:23.180883 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
07:54:23.182741 [debug] [MainThread]: Parsing tests/generic/builtin.sql
07:54:23.185640 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
07:54:23.188786 [debug] [MainThread]: Parsing macros/generate_source.sql
07:54:23.195598 [debug] [MainThread]: Parsing macros/generate_base_model.sql
07:54:23.198345 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
07:54:23.199534 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
07:54:23.200828 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
07:54:23.206206 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
07:54:23.209552 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
07:54:23.219043 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
07:54:23.223688 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
07:54:23.224884 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
07:54:23.226438 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
07:54:23.227821 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
07:54:23.228783 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
07:54:23.230238 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
07:54:23.232072 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
07:54:23.234028 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
07:54:23.235489 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
07:54:23.236458 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
07:54:23.237557 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
07:54:23.238598 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
07:54:23.241828 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
07:54:23.243345 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
07:54:23.246042 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
07:54:23.246976 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
07:54:23.249055 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
07:54:23.254574 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
07:54:23.255844 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
07:54:23.264146 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
07:54:23.265947 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
07:54:23.267175 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
07:54:23.268586 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
07:54:23.269905 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
07:54:23.272679 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
07:54:23.274806 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
07:54:23.277222 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
07:54:23.281274 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
07:54:23.283276 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
07:54:23.284955 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
07:54:23.287041 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
07:54:23.288731 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
07:54:23.297313 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
07:54:23.299521 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
07:54:23.300966 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
07:54:23.303778 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
07:54:23.305496 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
07:54:23.307338 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
07:54:23.308602 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
07:54:23.309861 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
07:54:23.311032 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
07:54:23.312221 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
07:54:23.314547 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
07:54:23.316133 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
07:54:23.323907 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
07:54:23.329276 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
07:54:23.336006 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
07:54:23.337671 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
07:54:23.341088 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
07:54:23.342753 [debug] [MainThread]: Parsing macros/sql/pivot.sql
07:54:23.346868 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
07:54:23.352602 [debug] [MainThread]: Parsing macros/sql/groupby.sql
07:54:23.353981 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
07:54:23.359922 [debug] [MainThread]: Parsing macros/sql/star.sql
07:54:23.363179 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
07:54:23.366511 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
07:54:23.369266 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
07:54:23.373590 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
07:54:23.375344 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
07:54:23.379475 [debug] [MainThread]: Parsing macros/sql/union.sql
07:54:23.390002 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
07:54:23.393425 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
07:54:23.395087 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
07:54:23.418898 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
07:54:23.420899 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
07:54:23.422542 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
07:54:23.782617 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
07:54:23.839007 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
07:54:23.951564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92bcad00-d852-4b88-8dc4-69e98dda779a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a691e87f0>]}
07:54:23.960174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92bcad00-d852-4b88-8dc4-69e98dda779a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6919f0a0>]}
07:54:23.960524 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
07:54:23.960797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92bcad00-d852-4b88-8dc4-69e98dda779a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a6919f100>]}
07:54:23.962220 [info ] [MainThread]: 
07:54:23.962763 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:54:23.963616 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
07:54:23.969228 [debug] [ThreadPool]: Opening a new connection, currently in state init
07:54:23.994735 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
07:54:23.997877 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:54:23.999233 [debug] [ThreadPool]: On list_schemas: Close
07:54:24.000312 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
07:54:24.005653 [debug] [ThreadPool]: Opening a new connection, currently in state closed
07:54:24.016078 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
07:54:24.019795 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
07:54:24.020802 [debug] [ThreadPool]: On list_None_homework_db: Close
07:54:24.021301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92bcad00-d852-4b88-8dc4-69e98dda779a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a690b3fa0>]}
07:54:24.021768 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
07:54:24.022032 [info ] [MainThread]: 
07:54:24.024941 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
07:54:24.025245 [info ] [Thread-1  ]: 1 of 3 START incremental model homework_db.lineorder_flat ...................... [RUN]
07:54:24.025649 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
07:54:24.025932 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
07:54:24.026082 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
07:54:24.034130 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
07:54:24.043100 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
07:54:24.065208 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
07:54:24.066556 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
07:54:24.082787 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
07:54:24.084018 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
07:54:24.099081 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
07:54:24.100317 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
07:54:24.117184 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
07:54:24.131017 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
07:54:24.137136 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
07:54:24.146057 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
07:54:24.151582 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
07:54:24.157355 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
07:54:24.162769 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
07:54:24.168214 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
07:54:24.173496 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
07:54:24.177831 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
07:54:24.178241 [debug] [Thread-1  ]: finished collecting timing info
07:54:24.178415 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
07:54:24.236182 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
07:54:24.236717 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

      

  
    create table homework_db.lineorder_flat
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

    
    
    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
    SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  
  )
  ...
07:59:24.281411 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
07:59:24.281617 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
07:59:24.281955 [debug] [Thread-1  ]: finished collecting timing info
07:59:24.282359 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
07:59:24.282644 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '92bcad00-d852-4b88-8dc4-69e98dda779a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a68fa3e20>]}
07:59:24.282998 [error] [Thread-1  ]: 1 of 3 ERROR creating incremental model homework_db.lineorder_flat ............. [[31mERROR[0m in 300.26s]
07:59:24.283526 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
07:59:24.284403 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
07:59:24.284631 [info ] [Thread-1  ]: 2 of 3 SKIP test not_null_lineorder_flat_LO_CUSTKEY ............................ [[33mSKIP[0m]
07:59:24.285019 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
07:59:24.285180 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
07:59:24.285409 [info ] [Thread-1  ]: 3 of 3 SKIP test not_null_lineorder_flat_LO_REVENUE ............................ [[33mSKIP[0m]
07:59:24.285729 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
07:59:24.286634 [debug] [MainThread]: Acquiring new clickhouse connection "master"
07:59:24.286978 [info ] [MainThread]: 
07:59:24.287205 [info ] [MainThread]: Finished running 1 incremental model, 2 tests in 300.32s.
07:59:24.287408 [debug] [MainThread]: Connection 'master' was properly closed.
07:59:24.287557 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
07:59:24.295612 [info ] [MainThread]: 
07:59:24.295844 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
07:59:24.296146 [info ] [MainThread]: 
07:59:24.296413 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
07:59:24.296684 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
07:59:24.296933 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
07:59:24.297200 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
07:59:24.297473 [info ] [MainThread]: 
07:59:24.297756 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
07:59:24.298183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a68f50f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a691e87f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a686b1d90>]}


============================== 2022-06-14 08:17:53.167536 | 0467eda7-ec17-4ccd-9006-cbff98376485 ==============================
08:17:53.167549 [info ] [MainThread]: Running with dbt=1.1.0
08:17:53.167917 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'clean', 'indirect_selection': 'eager'}
08:17:53.168048 [debug] [MainThread]: Tracking: tracking
08:17:53.176806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed496e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed496ea00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed497a4c0>]}
08:17:53.178336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed497a490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed497a370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efed497a4c0>]}


============================== 2022-06-14 08:18:18.882652 | e72ad62e-9d19-4596-be20-c7c26b858daf ==============================
08:18:18.882668 [info ] [MainThread]: Running with dbt=1.1.0
08:18:18.883263 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'resource_types': [], 'which': 'build', 'rpc_method': 'build'}
08:18:18.883500 [debug] [MainThread]: Tracking: tracking
08:18:18.892394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b2234760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b22347c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b22347f0>]}
08:18:18.916846 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
08:18:18.917173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'e72ad62e-9d19-4596-be20-c7c26b858daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b21ede80>]}
08:18:18.934592 [debug] [MainThread]: Parsing macros/init_s3_source.sql
08:18:18.938433 [debug] [MainThread]: Parsing macros/catalog.sql
08:18:18.939906 [debug] [MainThread]: Parsing macros/adapters.sql
08:18:18.973722 [debug] [MainThread]: Parsing macros/schema_tests/relationships.sql
08:18:18.974701 [debug] [MainThread]: Parsing macros/materializations/snapshot.sql
08:18:18.998895 [debug] [MainThread]: Parsing macros/materializations/seed.sql
08:18:19.002534 [debug] [MainThread]: Parsing macros/materializations/test.sql
08:18:19.003684 [debug] [MainThread]: Parsing macros/materializations/incremental.sql
08:18:19.030389 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
08:18:19.032920 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
08:18:19.034377 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
08:18:19.035881 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
08:18:19.037166 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
08:18:19.037848 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
08:18:19.038616 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
08:18:19.039407 [debug] [MainThread]: Parsing macros/etc/datetime.sql
08:18:19.047596 [debug] [MainThread]: Parsing macros/etc/statement.sql
08:18:19.051918 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
08:18:19.056116 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
08:18:19.058890 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
08:18:19.065909 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
08:18:19.068526 [debug] [MainThread]: Parsing macros/adapters/columns.sql
08:18:19.077847 [debug] [MainThread]: Parsing macros/adapters/relation.sql
08:18:19.087084 [debug] [MainThread]: Parsing macros/adapters/schema.sql
08:18:19.089202 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
08:18:19.092950 [debug] [MainThread]: Parsing macros/materializations/configs.sql
08:18:19.095271 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
08:18:19.111608 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
08:18:19.117629 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
08:18:19.118949 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
08:18:19.125802 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
08:18:19.128538 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
08:18:19.130842 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
08:18:19.133656 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
08:18:19.141099 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
08:18:19.142705 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
08:18:19.152598 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
08:18:19.168389 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
08:18:19.183290 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
08:18:19.187717 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
08:18:19.199885 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
08:18:19.210534 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
08:18:19.212185 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
08:18:19.228486 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
08:18:19.230315 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
08:18:19.234692 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
08:18:19.236463 [debug] [MainThread]: Parsing tests/generic/builtin.sql
08:18:19.239257 [debug] [MainThread]: Parsing macros/generate_model_yaml.sql
08:18:19.242301 [debug] [MainThread]: Parsing macros/generate_source.sql
08:18:19.249069 [debug] [MainThread]: Parsing macros/generate_base_model.sql
08:18:19.251964 [debug] [MainThread]: Parsing macros/cross_db_utils/any_value.sql
08:18:19.253247 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_bool_to_text.sql
08:18:19.254628 [debug] [MainThread]: Parsing macros/cross_db_utils/split_part.sql
08:18:19.260340 [debug] [MainThread]: Parsing macros/cross_db_utils/last_day.sql
08:18:19.263854 [debug] [MainThread]: Parsing macros/cross_db_utils/datediff.sql
08:18:19.275837 [debug] [MainThread]: Parsing macros/cross_db_utils/width_bucket.sql
08:18:19.282614 [debug] [MainThread]: Parsing macros/cross_db_utils/replace.sql
08:18:19.283918 [debug] [MainThread]: Parsing macros/cross_db_utils/identifier.sql
08:18:19.285562 [debug] [MainThread]: Parsing macros/cross_db_utils/date_trunc.sql
08:18:19.287035 [debug] [MainThread]: Parsing macros/cross_db_utils/intersect.sql
08:18:19.288061 [debug] [MainThread]: Parsing macros/cross_db_utils/position.sql
08:18:19.289586 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_ephemeral.sql
08:18:19.291505 [debug] [MainThread]: Parsing macros/cross_db_utils/safe_cast.sql
08:18:19.293472 [debug] [MainThread]: Parsing macros/cross_db_utils/bool_or.sql
08:18:19.295033 [debug] [MainThread]: Parsing macros/cross_db_utils/concat.sql
08:18:19.296009 [debug] [MainThread]: Parsing macros/cross_db_utils/_is_relation.sql
08:18:19.297155 [debug] [MainThread]: Parsing macros/cross_db_utils/except.sql
08:18:19.298219 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
08:18:19.301520 [debug] [MainThread]: Parsing macros/cross_db_utils/hash.sql
08:18:19.303128 [debug] [MainThread]: Parsing macros/cross_db_utils/dateadd.sql
08:18:19.305942 [debug] [MainThread]: Parsing macros/cross_db_utils/literal.sql
08:18:19.306891 [debug] [MainThread]: Parsing macros/cross_db_utils/right.sql
08:18:19.309042 [debug] [MainThread]: Parsing macros/cross_db_utils/datatypes.sql
08:18:19.314803 [debug] [MainThread]: Parsing macros/cross_db_utils/length.sql
08:18:19.316113 [debug] [MainThread]: Parsing macros/cross_db_utils/listagg.sql
08:18:19.324822 [debug] [MainThread]: Parsing macros/cross_db_utils/escape_single_quotes.sql
08:18:19.326708 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
08:18:19.327991 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
08:18:19.329515 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
08:18:19.330826 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
08:18:19.333638 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
08:18:19.335841 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
08:18:19.338311 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
08:18:19.342670 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
08:18:19.344663 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
08:18:19.346292 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
08:18:19.348359 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
08:18:19.349992 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
08:18:19.358499 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
08:18:19.360636 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
08:18:19.361999 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
08:18:19.364737 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
08:18:19.366435 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
08:18:19.368197 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
08:18:19.369462 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
08:18:19.370719 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
08:18:19.371833 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
08:18:19.372995 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
08:18:19.375258 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
08:18:19.376853 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
08:18:19.384860 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
08:18:19.390387 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
08:18:19.397089 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
08:18:19.398718 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
08:18:19.402088 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
08:18:19.403669 [debug] [MainThread]: Parsing macros/sql/pivot.sql
08:18:19.407894 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
08:18:19.413526 [debug] [MainThread]: Parsing macros/sql/groupby.sql
08:18:19.414885 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
08:18:19.420992 [debug] [MainThread]: Parsing macros/sql/star.sql
08:18:19.424147 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
08:18:19.427365 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
08:18:19.429969 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
08:18:19.434324 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
08:18:19.435935 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
08:18:19.439955 [debug] [MainThread]: Parsing macros/sql/union.sql
08:18:19.450565 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
08:18:19.453862 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
08:18:19.455469 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
08:18:19.479408 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
08:18:19.481438 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
08:18:19.483014 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
08:18:19.848918 [debug] [MainThread]: 1603: static parser failed on lineorder_flat.sql
08:18:19.907067 [debug] [MainThread]: 1602: parser fallback to jinja rendering on lineorder_flat.sql
08:18:20.017198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e72ad62e-9d19-4596-be20-c7c26b858daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b21da490>]}
08:18:20.026556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e72ad62e-9d19-4596-be20-c7c26b858daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b21f2070>]}
08:18:20.026899 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:18:20.027145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e72ad62e-9d19-4596-be20-c7c26b858daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b2276220>]}
08:18:20.028549 [info ] [MainThread]: 
08:18:20.029089 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:18:20.029965 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_schemas"
08:18:20.035460 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:18:20.063566 [debug] [ThreadPool]: clickhouse adapter: On list_schemas: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_schemas"} */

    select name from system.databases
  ...
08:18:20.066952 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:18:20.068303 [debug] [ThreadPool]: On list_schemas: Close
08:18:20.069384 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
08:18:20.074717 [debug] [ThreadPool]: Opening a new connection, currently in state closed
08:18:20.084317 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
08:18:20.090269 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:18:20.091362 [debug] [ThreadPool]: On list_None_homework_db: Close
08:18:20.091905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e72ad62e-9d19-4596-be20-c7c26b858daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b21068b0>]}
08:18:20.092378 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:18:20.092650 [info ] [MainThread]: 
08:18:20.095786 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
08:18:20.096089 [info ] [Thread-1  ]: 1 of 3 START incremental model homework_db.lineorder_flat ...................... [RUN]
08:18:20.096524 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
08:18:20.096776 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
08:18:20.096930 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
08:18:20.105069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:18:20.114277 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:18:20.137858 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
08:18:20.139213 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:18:20.157090 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
08:18:20.158360 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:18:20.177283 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.02 seconds
08:18:20.178529 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:18:20.191619 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:18:20.205443 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
08:18:20.210428 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:18:20.219408 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
08:18:20.223873 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:18:20.229923 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
08:18:20.234162 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:18:20.239983 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
08:18:20.244304 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:18:20.248874 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
08:18:20.249298 [debug] [Thread-1  ]: finished collecting timing info
08:18:20.249480 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
08:18:20.311472 [debug] [Thread-1  ]: Writing runtime SQL for node "model.dbt_starschema_2.lineorder_flat"
08:18:20.312043 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

      

  
    create table homework_db.lineorder_flat
    
  
    
    engine = MergeTree()
    order by (LO_ORDERDATE,LO_ORDERKEY)
    
    partition by (toYear(LO_ORDERDATE))
  as (
    

    
    
    
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
            
        
    
        
        
    SELECT
      MD5(cast(coalesce(cast(LO_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(C_CUSTKEY as 
    String
), '') || '-' || coalesce(cast(S_SUPPKEY as 
    String
), '') as 
    String
)) As Surrogate_key
      ,"LO_ORDERKEY",
  "LO_LINENUMBER",
  "LO_CUSTKEY",
  "LO_PARTKEY",
  "LO_SUPPKEY",
  "LO_ORDERDATE",
  "LO_ORDERPRIORITY",
  "LO_SHIPPRIORITY",
  "LO_QUANTITY",
  "LO_EXTENDEDPRICE",
  "LO_ORDTOTALPRICE",
  "LO_DISCOUNT",
  "LO_REVENUE",
  "LO_SUPPLYCOST",
  "LO_TAX",
  "LO_COMMITDATE",
  "LO_SHIPMODE"
      ,"C_CUSTKEY",
  "C_NAME",
  "C_ADDRESS",
  "C_CITY",
  "C_NATION",
  "C_REGION",
  "C_PHONE",
  "C_MKTSEGMENT"
      ,"S_SUPPKEY",
  "S_NAME",
  "S_ADDRESS",
  "S_CITY",
  "S_NATION",
  "S_REGION",
  "S_PHONE"
      ,"P_PARTKEY",
  "P_NAME",
  "P_MFGR",
  "P_CATEGORY",
  "P_BRAND",
  "P_COLOR",
  "P_TYPE",
  "P_SIZE",
  "P_CONTAINER"
  FROM homework_db.src_lineorder AS l
  INNER JOIN homework_db.src_customer AS c ON c.C_CUSTKEY = l.LO_CUSTKEY
  INNER JOIN homework_db.src_supplier AS s ON s.S_SUPPKEY = l.LO_SUPPKEY
  INNER JOIN homework_db.src_part AS p ON p.P_PARTKEY = l.LO_PARTKEY
  
  )
  ...
08:23:20.457314 [debug] [Thread-1  ]: clickhouse adapter: Clickhouse error: :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
 b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
08:23:20.457532 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
08:23:20.457881 [debug] [Thread-1  ]: finished collecting timing info
08:23:20.458300 [debug] [Thread-1  ]: Database Error in model lineorder_flat (models/lineorder_flat.sql)
  :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
   b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
  compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
08:23:20.458574 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e72ad62e-9d19-4596-be20-c7c26b858daf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b214d820>]}
08:23:20.458928 [error] [Thread-1  ]: 1 of 3 ERROR creating incremental model homework_db.lineorder_flat ............. [[31mERROR[0m in 300.36s]
08:23:20.459475 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
08:23:20.460310 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:23:20.460523 [info ] [Thread-1  ]: 2 of 3 SKIP test not_null_lineorder_flat_LO_CUSTKEY ............................ [[33mSKIP[0m]
08:23:20.460914 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:23:20.461114 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:23:20.461337 [info ] [Thread-1  ]: 3 of 3 SKIP test not_null_lineorder_flat_LO_REVENUE ............................ [[33mSKIP[0m]
08:23:20.461643 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:23:20.462674 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:23:20.463085 [info ] [MainThread]: 
08:23:20.463321 [info ] [MainThread]: Finished running 1 incremental model, 2 tests in 300.43s.
08:23:20.463590 [debug] [MainThread]: Connection 'master' was properly closed.
08:23:20.463746 [debug] [MainThread]: Connection 'model.dbt_starschema_2.lineorder_flat' was properly closed.
08:23:20.471393 [info ] [MainThread]: 
08:23:20.471631 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
08:23:20.471950 [info ] [MainThread]: 
08:23:20.472220 [error] [MainThread]: [33mDatabase Error in model lineorder_flat (models/lineorder_flat.sql)[0m
08:23:20.472475 [error] [MainThread]:   :HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:8443 returned response code 500)
08:23:20.472726 [error] [MainThread]:    b'Code: 57. DB::Exception: Table homework_db.lineorder_flat already exists. (TABLE_ALREADY_EXISTS) (version 22.3.6.5 (official build))\n'
08:23:20.472960 [error] [MainThread]:   compiled SQL at target/run/dbt_starschema_2/models/lineorder_flat.sql
08:23:20.473211 [info ] [MainThread]: 
08:23:20.473459 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
08:23:20.473833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b2261fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b22761c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15b2276370>]}


============================== 2022-06-14 08:24:38.903178 | 162fef45-4fb7-48c6-90f6-9f96af4a14f5 ==============================
08:24:38.903199 [info ] [MainThread]: Running with dbt=1.1.0
08:24:38.903704 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
08:24:38.903924 [debug] [MainThread]: Tracking: tracking
08:24:38.913117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff00242e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff00242e8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff00242e8e0>]}
08:24:38.963779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:24:38.964101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:24:38.970320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '162fef45-4fb7-48c6-90f6-9f96af4a14f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff002270850>]}
08:24:38.978607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '162fef45-4fb7-48c6-90f6-9f96af4a14f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff002255190>]}
08:24:38.978927 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:24:38.979159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162fef45-4fb7-48c6-90f6-9f96af4a14f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff002255400>]}
08:24:38.980731 [info ] [MainThread]: 
08:24:38.981340 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:24:38.982132 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
08:24:38.991903 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:24:39.025538 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
08:24:39.030033 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:24:39.031473 [debug] [ThreadPool]: On list_None_homework_db: Close
08:24:39.032137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '162fef45-4fb7-48c6-90f6-9f96af4a14f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0023e1190>]}
08:24:39.032622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:24:39.032902 [info ] [MainThread]: 
08:24:39.036065 [debug] [Thread-1  ]: Began running node model.dbt_starschema_2.lineorder_flat
08:24:39.036400 [debug] [Thread-1  ]: Acquiring new clickhouse connection "model.dbt_starschema_2.lineorder_flat"
08:24:39.036632 [debug] [Thread-1  ]: Began compiling node model.dbt_starschema_2.lineorder_flat
08:24:39.036775 [debug] [Thread-1  ]: Compiling model.dbt_starschema_2.lineorder_flat
08:24:39.049117 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:24:39.059753 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_customer
        (
                C_CUSTKEY       UInt32,
                C_NAME          String,
                C_ADDRESS       String,
                C_CITY          LowCardinality(String),
                C_NATION        LowCardinality(String),
                C_REGION        LowCardinality(String),
                C_PHONE         String,
                C_MKTSEGMENT    LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/customer.tbl', 'CSV')
        
  ...
08:24:39.063518 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:24:39.064691 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_lineorder
        (
            LO_ORDERKEY             UInt32,
            LO_LINENUMBER           UInt8,
            LO_CUSTKEY              UInt32,
            LO_PARTKEY              UInt32,
            LO_SUPPKEY              UInt32,
            LO_ORDERDATE            Date,
            LO_ORDERPRIORITY        LowCardinality(String),
            LO_SHIPPRIORITY         UInt8,
            LO_QUANTITY             UInt8,
            LO_EXTENDEDPRICE        UInt32,
            LO_ORDTOTALPRICE        UInt32,
            LO_DISCOUNT             UInt8,
            LO_REVENUE              UInt32,
            LO_SUPPLYCOST           UInt32,
            LO_TAX                  UInt8,
            LO_COMMITDATE           Date,
            LO_SHIPMODE             LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/lineorder.tbl', 'CSV')
        
  ...
08:24:39.067710 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:24:39.068785 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_part
        (
                P_PARTKEY       UInt32,
                P_NAME          String,
                P_MFGR          LowCardinality(String),
                P_CATEGORY      LowCardinality(String),
                P_BRAND         LowCardinality(String),
                P_COLOR         LowCardinality(String),
                P_TYPE          LowCardinality(String),
                P_SIZE          UInt8,
                P_CONTAINER     LowCardinality(String)
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/part.tbl', 'CSV')
        
  ...
08:24:39.071882 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:24:39.073096 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    

        CREATE TABLE IF NOT EXISTS homework_db.src_supplier
        (
                S_SUPPKEY       UInt32,
                S_NAME          String,
                S_ADDRESS       String,
                S_CITY          LowCardinality(String),
                S_NATION        LowCardinality(String),
                S_REGION        LowCardinality(String),
                S_PHONE         String
        )
        ENGINE = S3('https://storage.yandexcloud.net/otus-dwh/dbgen/supplier.tbl', 'CSV')
        
  ...
08:24:39.076542 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:24:39.114393 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_lineorder'
    
      and database = 'homework_db'
    
    order by position
  ...
08:24:39.120071 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:24:39.129384 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_customer'
    
      and database = 'homework_db'
    
    order by position
  ...
08:24:39.133782 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:24:39.139474 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_supplier'
    
      and database = 'homework_db'
    
    order by position
  ...
08:24:39.144263 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:24:39.149869 [debug] [Thread-1  ]: clickhouse adapter: On model.dbt_starschema_2.lineorder_flat: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "model.dbt_starschema_2.lineorder_flat"} */

    select
      name,
      type,
      position
    from system.columns
    where
      table = 'src_part'
    
      and database = 'homework_db'
    
    order by position
  ...
08:24:39.153891 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:24:39.165420 [debug] [Thread-1  ]: Writing injected SQL for node "model.dbt_starschema_2.lineorder_flat"
08:24:39.165847 [debug] [Thread-1  ]: finished collecting timing info
08:24:39.166071 [debug] [Thread-1  ]: Began executing node model.dbt_starschema_2.lineorder_flat
08:24:39.166237 [debug] [Thread-1  ]: finished collecting timing info
08:24:39.166387 [debug] [Thread-1  ]: On model.dbt_starschema_2.lineorder_flat: Close
08:24:39.166817 [debug] [Thread-1  ]: Finished running node model.dbt_starschema_2.lineorder_flat
08:24:39.167546 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:24:39.167866 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
08:24:39.168082 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:24:39.168211 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:24:39.179432 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
08:24:39.179820 [debug] [Thread-1  ]: finished collecting timing info
08:24:39.179986 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:24:39.180128 [debug] [Thread-1  ]: finished collecting timing info
08:24:39.180520 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:24:39.180714 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:24:39.181263 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
08:24:39.181429 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:24:39.181567 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:24:39.184744 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
08:24:39.185016 [debug] [Thread-1  ]: finished collecting timing info
08:24:39.185161 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:24:39.185303 [debug] [Thread-1  ]: finished collecting timing info
08:24:39.185643 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:24:39.186391 [debug] [MainThread]: Connection 'master' was properly closed.
08:24:39.186522 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
08:24:39.194511 [info ] [MainThread]: Done.
08:24:39.253349 [debug] [MainThread]: Acquiring new clickhouse connection "generate_catalog"
08:24:39.253585 [info ] [MainThread]: Building catalog
08:24:39.255144 [debug] [ThreadPool]: Acquiring new clickhouse connection "homework_db"
08:24:39.261200 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:24:39.279996 [debug] [ThreadPool]: clickhouse adapter: On homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "homework_db"} */
select
      null as table_database,
      columns.database as table_schema,
      columns.table as table_name,
      if(tables.engine not in ('MaterializedView', 'View'), 'table', 'view') as table_type,
      null as table_comment,
      columns.name as column_name,
      columns.position as column_index,
      columns.type as column_type,
      null as column_comment,
      null as table_owner
    from system.columns as columns
    join system.tables as tables on tables.database = columns.database and tables.name = columns.table
    where database != 'system' and
    (columns.database = 'homework_db')
    order by columns.database, columns.table, columns.position...
08:24:39.288105 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:24:39.296814 [debug] [ThreadPool]: On homework_db: Close
08:24:39.308511 [info ] [MainThread]: Catalog written to /home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2/target/catalog.json
08:24:39.308961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff00242e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff00199bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff00199baf0>]}
08:24:39.792996 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
08:24:39.793529 [debug] [MainThread]: Connection 'homework_db' was properly closed.


============================== 2022-06-14 08:28:45.239628 | 8e5639f5-8073-4b47-82e4-dc93d3e372ac ==============================
08:28:45.239646 [info ] [MainThread]: Running with dbt=1.1.0
08:28:45.240140 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
08:28:45.240341 [debug] [MainThread]: Tracking: tracking
08:28:45.249261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad8ac7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad8ac850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad8ac880>]}
08:28:45.298959 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
08:28:45.299198 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
08:28:45.305121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e5639f5-8073-4b47-82e4-dc93d3e372ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad6f97c0>]}
08:28:45.313533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e5639f5-8073-4b47-82e4-dc93d3e372ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad6de100>]}
08:28:45.313849 [info ] [MainThread]: Found 1 model, 2 tests, 0 snapshots, 0 analyses, 410 macros, 0 operations, 0 seed files, 4 sources, 0 exposures, 0 metrics
08:28:45.314119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e5639f5-8073-4b47-82e4-dc93d3e372ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad6de370>]}
08:28:45.315588 [info ] [MainThread]: 
08:28:45.316174 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:28:45.317112 [debug] [ThreadPool]: Acquiring new clickhouse connection "list_None_homework_db"
08:28:45.326662 [debug] [ThreadPool]: Opening a new connection, currently in state init
08:28:45.347341 [debug] [ThreadPool]: clickhouse adapter: On list_None_homework_db: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "connection_name": "list_None_homework_db"} */
select
      null as db,
      name as name,
      database as schema,
      if(engine not in ('MaterializedView', 'View'), 'table', 'view') as type
    from system.tables as t
    where schema = 'homework_db'
  ...
08:28:45.352153 [debug] [ThreadPool]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:28:45.353533 [debug] [ThreadPool]: On list_None_homework_db: Close
08:28:45.354182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e5639f5-8073-4b47-82e4-dc93d3e372ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad86a2e0>]}
08:28:45.354648 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
08:28:45.354908 [info ] [MainThread]: 
08:28:45.358045 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:28:45.358237 [info ] [Thread-1  ]: 1 of 2 START test not_null_lineorder_flat_LO_CUSTKEY ........................... [RUN]
08:28:45.358671 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
08:28:45.358964 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:28:45.359123 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:28:45.372073 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
08:28:45.372542 [debug] [Thread-1  ]: finished collecting timing info
08:28:45.372768 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:28:45.386517 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"
08:28:45.386984 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:28:45.396850 [debug] [Thread-1  ]: clickhouse adapter: On test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select LO_CUSTKEY
from homework_db.lineorder_flat
where LO_CUSTKEY is null



      
    ) as dbt_internal_test...
08:28:45.402943 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:28:45.404729 [debug] [Thread-1  ]: finished collecting timing info
08:28:45.404909 [debug] [Thread-1  ]: On test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647: Close
08:28:45.405222 [info ] [Thread-1  ]: 1 of 2 PASS not_null_lineorder_flat_LO_CUSTKEY ................................. [[32mPASS[0m in 0.05s]
08:28:45.405618 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_CUSTKEY.d7523fb647
08:28:45.405855 [debug] [Thread-1  ]: Began running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:28:45.406142 [info ] [Thread-1  ]: 2 of 2 START test not_null_lineorder_flat_LO_REVENUE ........................... [RUN]
08:28:45.406527 [debug] [Thread-1  ]: Acquiring new clickhouse connection "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
08:28:45.406704 [debug] [Thread-1  ]: Began compiling node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:28:45.406840 [debug] [Thread-1  ]: Compiling test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:28:45.410626 [debug] [Thread-1  ]: Writing injected SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
08:28:45.410959 [debug] [Thread-1  ]: finished collecting timing info
08:28:45.411107 [debug] [Thread-1  ]: Began executing node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:28:45.413543 [debug] [Thread-1  ]: Writing runtime SQL for node "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"
08:28:45.413848 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
08:28:45.422665 [debug] [Thread-1  ]: clickhouse adapter: On test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "clickhouse_starschema", "target_name": "dev", "node_id": "test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854"} */
select
      count(*) as failures,
      case when count(*) != 0
        then 'true' else 'false' end as should_warn,
      case when count(*) != 0
        then 'true' else 'false' end as should_error
    from (
      
    
    



select LO_REVENUE
from homework_db.lineorder_flat
where LO_REVENUE is null



      
    ) as dbt_internal_test...
08:28:45.428763 [debug] [Thread-1  ]: clickhouse adapter: SQL status: OK in 0.01 seconds
08:28:45.430000 [debug] [Thread-1  ]: finished collecting timing info
08:28:45.430181 [debug] [Thread-1  ]: On test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854: Close
08:28:45.430498 [info ] [Thread-1  ]: 2 of 2 PASS not_null_lineorder_flat_LO_REVENUE ................................. [[32mPASS[0m in 0.02s]
08:28:45.430871 [debug] [Thread-1  ]: Finished running node test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854
08:28:45.431901 [debug] [MainThread]: Acquiring new clickhouse connection "master"
08:28:45.432235 [info ] [MainThread]: 
08:28:45.432540 [info ] [MainThread]: Finished running 2 tests in 0.12s.
08:28:45.432831 [debug] [MainThread]: Connection 'master' was properly closed.
08:28:45.432992 [debug] [MainThread]: Connection 'test.dbt_starschema_2.not_null_lineorder_flat_LO_REVENUE.95f13c3854' was properly closed.
08:28:45.441182 [info ] [MainThread]: 
08:28:45.441436 [info ] [MainThread]: [32mCompleted successfully[0m
08:28:45.441787 [info ] [MainThread]: 
08:28:45.442056 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
08:28:45.442442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad6d7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad6de430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ad6de460>]}


============================== 2022-06-14 08:38:14.488126 | 5daaa0d8-95a5-4767-be25-592b0bb43919 ==============================
08:38:14.488139 [info ] [MainThread]: Running with dbt=1.1.0
08:38:14.488555 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
08:38:14.488732 [debug] [MainThread]: Tracking: tracking
08:38:14.497830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0bc95ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0bc95cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0bc95ce20>]}
08:38:14.557014 [debug] [MainThread]: Executing "git --help"
08:38:14.560739 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
08:38:14.561100 [debug] [MainThread]: STDERR: "b''"
08:38:14.563922 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
08:38:14.564322 [debug] [MainThread]: Opening a new connection, currently in state init
08:38:14.598793 [debug] [MainThread]: clickhouse adapter: Got an error when attempting to open a clickhouse connection: ':HTTPDriver url https://c-c9q06q78m45per350pr9.rw.mdb.yandexcloud.net:9440 returned response code 400)
 b'Port 9000 is for clickhouse-client program\r\nYou must use port 8123 for HTTP.\r\n''
08:38:14.599177 [debug] [MainThread]: On debug: No close available on handle
08:38:14.599591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0bc881f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0bc895f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0bc840040>]}
08:38:15.138595 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-14 08:38:40.210482 | abbc6e60-e618-4d4b-846c-e58c9f3c569a ==============================
08:38:40.210494 [info ] [MainThread]: Running with dbt=1.1.0
08:38:40.210872 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ivan-ds/otus_homework_2/dbt_starschema_2/dbt_starschema_2', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
08:38:40.211049 [debug] [MainThread]: Tracking: tracking
08:38:40.220144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7a6b55fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7a6b55ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7a6b55dc0>]}
08:38:40.277801 [debug] [MainThread]: Executing "git --help"
08:38:40.281325 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
08:38:40.281672 [debug] [MainThread]: STDERR: "b''"
08:38:40.284536 [debug] [MainThread]: Acquiring new clickhouse connection "debug"
08:38:40.284898 [debug] [MainThread]: Opening a new connection, currently in state init
08:38:40.305840 [debug] [MainThread]: clickhouse adapter: On debug: select 1 as id...
08:38:40.308960 [debug] [MainThread]: clickhouse adapter: SQL status: OK in 0.00 seconds
08:38:40.309997 [debug] [MainThread]: On debug: Close
08:38:40.310323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7a6a84e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7a6a361f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7a6a36100>]}
08:38:40.798918 [debug] [MainThread]: Connection 'debug' was properly closed.
